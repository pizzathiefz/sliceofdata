<!DOCTYPE html>
<html lang="ko" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>수학을 까먹은 사람을 위한 특이값분해(SVD) | sliceofdata</title>
<meta name="keywords" content="특이값분해, singular value decomposition, svd">
<meta name="description" content="고유값분해만 뭔지 알고 오세요">
<meta name="author" content="pizzathief">
<link rel="canonical" href="https://sliceofdata.app/posts/svd/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.27cad2a1c5348b9448235a32de472a54bfb4b517f58e15427dc5a1a01bf486da.css" integrity="sha256-J8rSocU0i5RII1oy3kcqVL&#43;0tRf1jhVCfcWhoBv0hto=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sliceofdata.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sliceofdata.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sliceofdata.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="ko" href="https://sliceofdata.app/posts/svd/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {
  delimiters: [
    {left: '$$', right: '$$', display: true},
    {left: '$', right: '$', display: false},
    {left: '\\(', right: '\\)', display: false},
    {left: '\\[', right: '\\]', display: true}
  ],
  throwOnError: false
});"></script>
<meta property="og:url" content="https://sliceofdata.app/posts/svd/">
  <meta property="og:site_name" content="sliceofdata">
  <meta property="og:title" content="수학을 까먹은 사람을 위한 특이값분해(SVD)">
  <meta property="og:description" content="고유값분해만 뭔지 알고 오세요">
  <meta property="og:locale" content="ko-KR">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-12-23T16:56:52+09:00">
    <meta property="article:modified_time" content="2023-12-23T16:56:52+09:00">
    <meta property="article:tag" content="Linear-Algebra">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="수학을 까먹은 사람을 위한 특이값분해(SVD)">
<meta name="twitter:description" content="고유값분해만 뭔지 알고 오세요">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sliceofdata.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "수학을 까먹은 사람을 위한 특이값분해(SVD)",
      "item": "https://sliceofdata.app/posts/svd/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "수학을 까먹은 사람을 위한 특이값분해(SVD)",
  "name": "수학을 까먹은 사람을 위한 특이값분해(SVD)",
  "description": "고유값분해만 뭔지 알고 오세요",
  "keywords": [
    "특이값분해", "singular value decomposition", "svd"
  ],
  "articleBody": "SVD 식 만들어보기 일단 정의부터 써봅시다. 실수값으로 이루어진 모든 $m \\times n$ 행렬 $A$ 는 다음과 같이 특이값분해될 수 있습니다.\n잠깐 이 문장으로 알 수 있는 사실은, 그 정의상 정방행렬($m = n$ )에서만 가능하고 또 특정 조건(서로 독립인 $n$개의 고유벡터가 존재)을 만족해야만 가능했던 고유값분해와 달리 특이값분해는 꼭 필요한 조건이 없다는 것입니다.\n$$ A = U\\Sigma V^T $$\n그림 출처\n$U$는 $m \\times m$ 직교행렬이며 $AA^T$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다. $V$는 $n \\times n$ 직교행렬이며 $A^TA$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다. $\\Sigma$는 $m \\times n$ 대각행렬이며 $AA^T$, $A^TA$를 고유값분해해서 얻은 고유값들의 제곱근을 취한 값을 좌상단부터 대각 원소로 가지고, 나머지 부분들은 다 0으로 만들어졌다. 정의부터 던지면 이게 다 뭔 소리지 라는 생각이 듭니다. 이 세 가지 행렬이 왜 나오는지 천천히 뜯어보고 증명도 해볼 것입니다.\n일단 모든 행렬에 대해 그 행렬과 전치행렬을 곱한 행렬인 $AA^T$, $A^TA$ 이 두 가지 행렬은 좀 특별한 구석이 있는데요, 이 행렬의 특징들에 대해 알 필요가 있습니다. 그게 왜 그런데? 라는 생각이 드시는 분들을 위해 ‘왜’도 다 적어놨지만, 사실 그냥 그렇구나 하고 넘어가셔도 무방합니다.\n정방행렬이다. $AA^T$: $m \\times n$ 행렬과 $n \\times m$ 행렬을 곱했으니까 $m \\times m$ 행렬임 $A^TA$: $n \\times m$ 행렬과 $m \\times n$ 행렬을 곱했으니까 $n \\times n$ 행렬임 대칭행렬이다. 💡 대칭행렬이 뭐더라? 시각적으로는 대각 기준으로 반 접으면 접히는 값들이 같다는 것이며 정확한 정의로는 전치해도 원래 행렬과 동일하다는 것이다. 즉 $X = X^T$ 전치해보면 아주 쉽다. $(AA^T)^T = AA^T$, $(A^TA)^T = A^TA$ 고유값분해될 수 있다(=실수 고유값을 가짐). 왜냐면 모든 대칭행렬은 고유값분해될 수 있기 때문에. 💡 다시 강조하면 모든 실수 행렬이 고유값분해 될 수 있는 것은 아니며 어떤 행렬은 고유값으로 허수값을 가질 수도 있다! 하지만 대칭행렬은 고유값의 실수임이 보장된다는 건데, 실수 대칭행렬 $S$의 고유값 $\\lambda$ 이 있을 때 (즉 $S \\mathbf{v} = \\lambda \\mathbf{v}$) … 1️⃣ 켤레값을 취하면 $\\bar{S} \\bar{\\mathbf{v}} = \\bar{\\lambda} \\bar{\\mathbf{v}}$ 이며 $S$는 실수행렬이므로 ($\\bar{S} = S$) $S \\bar{\\mathbf{v}} = \\bar{\\lambda} \\bar{\\mathbf{v}}$ 전치하면 $\\bar{\\mathbf{v}}^TS^T = \\bar{\\lambda} \\bar{\\mathbf{v}}^T$ 이며 $S$는 대칭이므로 ($S=S^T$) $\\bar{\\mathbf{v}}^TS = \\bar{\\lambda} \\bar{\\mathbf{v}}^T$ … 2️⃣ 1️⃣ $S \\mathbf{v} = \\lambda \\mathbf{v}$ 에 $\\bar{\\mathbf{v}}^T$를 곱하면, $\\bar{\\mathbf{v}}^T S \\mathbf{v} = \\lambda \\bar{\\mathbf{v}}^T \\mathbf{v}$ 2️⃣ $\\bar{\\mathbf{v}}^TS = \\bar{\\lambda} \\bar{\\mathbf{v}}^T$ 에 $\\mathbf{v}$를 곱하면, $\\bar{\\mathbf{v}}^TS \\mathbf{v} = \\bar{\\lambda} \\bar{\\mathbf{v}}^T \\mathbf{v}$ 위 두 식의 좌변이 같으므로 우변도 같아야 함. $\\lambda = \\bar{\\lambda}$ 가 되어 $\\lambda$ 는 실수임. 고유벡터들이 직교한다. 왜냐면 대칭행렬의 고유벡터들은 항상 직교하기 때문에. 대칭행렬 $S$의 서로 다른 고유벡터 $\\mathbf{v}_1, \\mathbf{v}_2$와 그에 대응하는 고유값 $\\lambda_1$, $\\lambda_2$가 있을 때 (즉 $S\\mathbf{v}_1 = \\lambda_1 \\mathbf{v}_1$, $S\\mathbf{v}_2 = \\lambda_2 \\mathbf{v}_2$) $\\lambda_1 \\mathbf{v}^T_1 \\mathbf{v}_2 = (S\\mathbf{v}_1)^T \\mathbf{v}_2 = \\mathbf{v}_1^TS^T\\mathbf{v}_2 = \\mathbf{v}_1^TS\\mathbf{v}_2 = \\mathbf{v}^T_1\\lambda_2\\mathbf{v}_2 = \\lambda_2\\mathbf{v}^T_1 \\mathbf{v}_2$ $\\lambda_1\\mathbf{v}^T_1\\mathbf{v}_2 - \\lambda_2 \\mathbf{v}^T_1 \\mathbf{v}_2 = (\\lambda_1 - \\lambda_2) \\mathbf{v}^T_1 \\mathbf{v}_2 = 0$ 💡 직교가 뭐더라? 두 벡터의 내적이 0인 것이다. 즉 $\\mathbf{v}_1^T\\mathbf{v}_2=0$ 이면 두 벡터는 직교한다. 여기서 서로 다른 두 고유값은 같은 값일 수 없으므로 ($\\lambda_1 - \\lambda_2 \\neq 0$ ) $\\mathbf{v}_1^T\\mathbf{v}_2=0$ 고유값들이 모두 0 이상의 값을 가진다. 왜냐면 semi-positive definite한 행렬이기 때문에. 💡 positive definite가 뭐더라? 영벡터가 아닌 모든 벡터 $\\mathbf{v}$에 대해 항상 $\\mathbf{v}^TA\\mathbf{v} \u003e0$ 일 때 $A$를 positive definite하다고 하고, $\\ge 0$일 때 semi-positive definite 하다고 함. 행렬에도 부호가 있다고 이해하면 편하다! 어떤 semi-positive definite 행렬과 그 고유값에 대해, $A\\mathbf{v} = \\lambda \\mathbf{v}$ 의 양변에 $\\mathbf{v}^T$를 곱하면, $\\mathbf{v}^TA\\mathbf{v} = \\lambda \\mathbf{v}\\mathbf{v}^T \\ge 0$ 결국 고유값과 벡터의 내적값을 곱한 게 0 이상이어야 하므로 고유값도 0 이상이어야 한다는 결론. $A^TA$ 에 대해 $\\mathbf{v}^TA^TA\\mathbf{v}$ 이렇게 곱해보면 결국 $(A\\mathbf{v})^T(A\\mathbf{v}) = \\Vert A\\mathbf{v} \\Vert ^2 \\ge 0$ 이므로 semi-positive definite이고, 그래서 고유값들이 0 이상임. 위 사실들을 생각하면서 특이값분해를 증명해봅시다.\n우선 $A^TA$ 부터 보겠습니다. 이 행렬은 고유값분해될 수 있기 때문에, 여러 개의 고유값과 그에 상응하는 고유벡터가 존재할 것입니다. 다음과 같은 고유값 $\\lambda_i$와 고유벡터 $\\mathbf{v}_i$ 가 있다는 것이죠.\n$$A^TA\\mathbf{v}_i = \\lambda_i\\mathbf{v}_i = \\sigma_i^2\\mathbf{v}_i$$ 이때 $A^TA$ 의 모든 고유값은 0 이상의 값을 가진다는 것을 기억하면, $\\lambda_i$는 제곱근을 가질 것이고 그걸 $\\sigma_i$라고 써줬습니다.\n이제 $\\mathbf{v}_i$ 의 특징을 생각해봅시다. 고유값분해에 대해 떠올려보면, 고유값에 대응하는 고유벡터는 굉장히 많은 수로 존재할 수 있습니다. 제가 이전 글에 썼던 예시를 그대로 가져와보면,\n$$ \\begin{bmatrix} 1 \u0026 2 \\\\ 2 \u0026 1 \\end{bmatrix} \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} = 3 \\begin{bmatrix} 1 \\\\ 1 \\end{bmatrix} $$\n이 행렬의 고유값 3에 대해 고유벡터는 (1,1)이 될 수도 있고 (50000, 50000)이 될 수도 있고 (-1234, -1234)가 될 수도 있다고 했었죠. 방향만 같으면 크기는 마음대로 할 수 있다는 겁니다. 따라서 우리는 보통 노름(어떤 벡터를 자기자신과 내적한 값, 즉 $\\mathbf{v}^T\\mathbf{v}$ 의 양의 제곱근)이 1이 되는 벡터로 고유벡터를 고릅니다. 이런 벡터를 단위벡터라고 합니다. 어떤 벡터든 노름값으로 나눠서 크기를 조정해주면 단위벡터로 만들어줄 수 있습니다. 따라서 $\\mathbf{v}_i ^T \\mathbf{v}_i =1$ 입니다.\n또 앞서 언급했듯 $A^TA$는 대칭행렬이라서 모든 고유벡터가 서로 직교합니다. 따라서 서로다른 $i$,$j$ 에 대해 $\\mathbf{v}_i ^T \\mathbf{v}_j =0$이라는 사실도 기억합시다. 따라서 모든 $\\mathbf{v}$를 열로 이어붙여 행렬을 만든다면 이 행렬은 직교행렬이겠죠.\n여기까지 보면, 다음 문장은 더 이상 설명할 게 없을 겁니다.\n$V$는 $n \\times n$ 직교행렬이며 $A^TA$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다.\n추가로, $A^TA\\mathbf{v}_i = \\sigma_i^2\\mathbf{v}_i$ 이 식의 양변에 $\\mathbf{v}_i^T$ 를 곱해 봅시다.\n$$ \\mathbf{v}_i^TA^TA\\mathbf{v}_i = \\sigma_i^2\\mathbf{v}_i^T\\mathbf{v}_i$$\n단위벡터라서 $\\mathbf{v}_i ^T \\mathbf{v}_i =1$ 이므로, $$ (A\\mathbf{v}_i)^TA\\mathbf{v}_i = \\sigma_i^2$$\n$A\\mathbf{v}_i$ 의 노름이 $\\sigma_i$란 사실을 알 수 있습니다. 이 말은 다름 아니라, $\\frac{A\\mathbf{v}_i}{\\sigma_i}$ 는 또다른 단위벡터라는 뜻이죠.\n즉 모든 $A^TA$의 고유벡터 $\\mathbf{v}_i$ 에 대해 다음과 같은 단위벡터 $\\mathbf{u}_i$가 존재합니다.\n$$\\mathbf{u}_i = \\frac{A\\mathbf{v}_i}{\\sigma_i}$$\n이번엔 $A^TA\\mathbf{v}_i = \\sigma_i^2\\mathbf{v}_i$ 이 식의 양변에 $A$ 를 곱해 봅시다.\n$$AA^TA\\mathbf{v}_i = \\sigma_i^2A\\mathbf{v}_i$$\n양변을 $\\sigma_i$로 나눠준다면, 최종적으로 다음과 같은 식이 도출되어 $\\mathbf{u}_i$가 $AA^T$의 고유벡터이며, 그 고유값은 $\\sigma_i^2$ 로, $A^TA$의 고유값과 동일하다는 사실을 알 수 있습니다.\n$$AA^T (\\frac{A\\mathbf{v}_i}{\\sigma_i}) = AA^T\\mathbf{u}_i = \\sigma_i^2\\mathbf{u}_i$$ 그 외의 다른 성질, 예를 들면 서로다른 $i$, $j$ 에 대해 $\\mathbf{u}_i$, $\\mathbf{u}_j$ 가 직교라는 점은 $AA^T$의 고유벡터나 $A^TA$의 고유벡터나 동일하기 때문에 다시 쓸 필요는 없겠습니다.\n이제 다음 문장까지 정리가 되었습니다.\n$U$는 $m \\times m$ 직교행렬이며 $AA^T$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다.\n다시 $A$와 $\\mathbf{u}_i$ 와 $\\mathbf{v}_i$의 관계식으로 돌아가면 다음과 같습니다.\n$$\\sigma_i\\mathbf{u}_i = A\\mathbf{v}_i$$\n이를 개별 벡터가 아닌 행렬의 모양으로 다시 쓰면 이렇습니다.\n$$ U \\Sigma = AV$$\n여기서 이게 행렬로 쓰면 왜 이렇게 되지? $\\Sigma$ 는 어떻게 생긴 행렬이지? 라는 생각이 들 수 있습니다. 그 이야기를 잠깐 해보겠습니다.\n$AA^T$ 와 $A^TA$는 각각 $m$개, $n$개의 선형독립인 고유벡터를 가지고 그에 대응하는 고유값을 가질 것입니다. 그 중 일부는 0이고 일부는 0이 아닐 수 있는데요. 0이 아닌 고유값에 대해서 $AA^T$ 와 $A^TA$의 고유값이 일치한다는 사실은 위에서 보았습니다. 0이 아닌 고유값이 $r$ 개 있다고 합시다.\n$$ \\lambda_1, \\cdots, \\lambda_r = \\sigma^2_1,\\cdots, \\sigma^2_r$$\n이때 $r$ 은 사실 각 행렬의 rank 값과 동일하며, 원 행렬 $A$의 rank 값과도 동일합니다. 왜인지를 생각해보면, 행렬 $S$가 고유값분해로 대각화될 수 있을 때 ($S=V \\Lambda V^{-1}$) 역행렬이 있는 행렬의 곱은 rank를 변화시키지 않으므로 결국 이 행렬 $S$ 는 고유값으로 이루어진 대각행렬 $\\Lambda$과 rank가 동일한 건데, 대각행렬에서 서로 독립인 열의 개수는 단순히 0이 아닌 대각원소의 개수를 센 값이기 때문입니다.\n어쨌든 이 0이 아닌 고유값들의 제곱근($\\sigma$)을 큰 순서대로 대각 원소로 하고, 나머지 부분은 0으로 채운 행렬을 생각해봅시다.\n$$ \\sigma_1 \\ge \\sigma_2 \\ge \\cdots \\ge \\sigma_r \u003e 0 $$\n이 행렬은 $r \\times r$이므로 $m \\times n$ 으로 만들어주기 위해 ($m-r$) 행만큼, ($n-r$) 열만큼 또 0으로 채워줍니다. $m = 4$, $n = 5$, $r=3$ 인 $\\Sigma$의 예시는 다음과 같습니다.\n$$\\begin{bmatrix} 3 \u0026 0 \u0026 0 \u00260 \u00260 \\\\ 0 \u0026 \\sqrt{5} \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 2 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}$$\n즉 원래 행렬 $A$는 rank-3 행렬이며, $AA^T$, $A^TA$의 0이 아닌 고유값의 제곱근은 큰 순서대로 3, $\\sqrt{5}$, 2입니다. 이 값들을 행렬 $A$의 특이값(singular value) 이라고 부릅니다.\n다시 $AA^T$의 고유벡터 $m$개를 열로 이어붙인 행렬을 다음과 같이 만들 수 있습니다. 다시 $m=4$의 예시입니다.\n$$U = \\begin{bmatrix} \\mid \u0026 \\mid \u0026 \\mid \u0026 \\mid \\\\ \\mathbf{u_1} \u0026 \\mathbf{u_2} \u0026 \\mathbf{u_3} \u0026 \\mathbf{u_4} \\\\ \\mid \u0026 \\mid \u0026 \\mid \u0026 \\mid \\end{bmatrix} = \\begin{bmatrix} 0 \u0026 -1 \u0026 0 \u0026 0 \\\\ -1 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 -1 \\\\ 0 \u0026 0 \u0026 -1 \u0026 0 \\end{bmatrix} $$\n이제 행렬곱 $U\\Sigma$ 를 해보면, $i=1, \\cdots, m (m=4)$ 에 대해 우리가 증명했던 벡터 기준의 식의 좌변인 $\\sigma_i\\mathbf{u}_i$ 가 나온다는 것을 알 수 있죠. 특이한 점은 $\\Sigma$에서 $r+1$부터는 다 0으로 채워줬기 때문에 $\\mathbf{u}_4$ 는 곱하면 0이 되어 사실 결과에 전혀 영향을 주지 못합니다.\n마찬가지로 $A^TA$의 고유벡터 $n$개를 열로 이어붙인 행렬도 만들 수 있습니다.\n$$V = \\begin{bmatrix} \\mid \u0026 \\mid \u0026 \\mid \u0026 \\mid\u0026 \\mid \\\\ \\mathbf{v_1} \u0026 \\mathbf{v_2} \u0026 \\mathbf{v_3} \u0026 \\mathbf{v_4} \u0026 \\mathbf{v_5} \\\\ \\mid\u0026 \\mid \u0026 \\mid \u0026 \\mid \u0026 \\mid \\end{bmatrix} = \\begin{bmatrix} 0 \u0026 0 \u0026 -1 \u0026 0 \u0026 0 \\\\ -\\sqrt{0.2} \u0026 0 \u0026 0 \u0026 0 \u0026 -\\sqrt{0.8} \\\\ 0 \u0026 -1 \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 1 \u0026 0 \\\\ -\\sqrt{0.8} \u0026 0 \u0026 0 \u0026 0 \u0026 \\sqrt{0.2} \\end{bmatrix} $$\n행렬곱 $AV$는 우변이었던 $A\\mathbf{v}_i$를 그대로 행렬로 쓴 것과 동일합니다.\n이때 $V$는 서로 직교하는 단위벡터로 이루어진 직교행렬이기 때문에 $VV^T = I$, $V^{-1} = V^T$ 이구요. 양변에 이 행렬을 곱해주면, 이렇게 해서 드디어 출발점이었던 다음 식에 도달했습니다!\n$$ A = U\\Sigma V^T $$ SVD의 기하학적 의미 고유값분해의 기하학적 의미는 어떤 벡터에 어떤 행렬을 곱했을 때, 벡터의 크기만 변하고 방향은 변하지 않는다는 것이었습니다. 이번에는 서로 직교하는 벡터에 어떤 행렬을 곱하는 것을 상상해봅시다.\n그림 출처\nA의 경우, 직교하는 두 벡터에 $M$ 이라는 행렬을 곱했을 때 사이각이 변함 B의 경우, 직교하는 두 벡터에 $M$ 이라는 행렬을 곱했더니 여전히 직교 상태를 유지하고 있음 (다만 둘이 같이 회전했고, 각 크기는 변했음) 특이값 분해의 의미는 위의 B 케이스처럼 직교하는 어떤 벡터에 어떤 행렬을 곱했을 때, 크기가 변하고 회전되더라도 직교하는 상태는 변하지 않는다는 것입니다. 위에서 보인 식으로 돌아가면, $U \\Sigma = AV$ 이 식에서 $A$ 는 곱해지는 행렬(선형변환)이고, $\\Sigma$는 크기가 변하는(스케일링되는) 값을 의미합니다. $V$와 $U$는 반복해서 언급했듯 직교행렬이고요.\n그림 출처\n이를 염두에 두고 다시 $A = U\\Sigma V^T$ (그림 속 $M$ )를 보면, 모든 $A$라는 행렬을 곱하는 행위는 결국 $m$차원에서 $n$차원으로 선형 변환을 하는 것을 의미하는데, 직교행렬 $U, V$는 은 곱해질 때 회전만 시킬 뿐 각도나 크기를 변화시키지 않고 $\\Sigma$는 크기만 바꾸므로, 순서대로 1) $V^T$를 곱해서 회전 2) $\\Sigma$를 곱해서 크기 변화 3) $U$를 곱해서 회전을 하는 것과 동일합니다. 따라서 원래 벡터의 모양을 바꾸는 것은 오로지 특이값의 크기($\\Sigma$의 값)에만 달려 있습니다.\nSVD의 응용 특이값분해는 데이터를 효과적으로 압축하는 데 사용될 수 있습니다. 우리가 지금까지 알아낸 SVD, 즉 다음과 같이 행렬을 분해하는 것을 Full SVD라고 합니다.\n$$ A = U\\Sigma V^T $$\n아까 $\\Sigma$ 가 어떻게 생겼는지 되살려보면,\n$$\\begin{bmatrix} 3 \u0026 0 \u0026 0 \u00260 \u00260 \\\\ 0 \u0026 \\sqrt{5} \u0026 0 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 2 \u0026 0 \u0026 0 \\\\ 0 \u0026 0 \u0026 0 \u0026 0 \u0026 0 \\end{bmatrix}$$\n이런 식으로 내림차순으로 정렬된 $A$의 rank 만큼의 0이 아닌 특이값이 존재($r$개)하고, 나머지는 다 0입니다. 0인 부분은 다 날려 버리고, 이에 대응하는 $U$와 $V$의 벡터들도 $r$개만 선택하면 어떨까요? 아까 잠깐 설명했듯 $r+1$ 이후 부분부터는 결과물에 아무 영향도 주지 않기 때문에 $U_r\\Sigma_r V_r^T$ 로도 원래 행렬 $A$를 얻을 수 있습니다.\n이번에는 조금 더 과감하게, 0이 아닌 특이값 중 가장 큰 $k$개만 ($k \u003c r$) 남기고 $U$와 $V^T$도 $k$개의 열, 행만 남겨 봅시다.\n그림 출처\n이렇게 얻은 $A_k = U_k\\Sigma_k V_k^T$ 는 원래의 $A$ 와 완전히 같지는 않은 근사행렬입니다. 전체 특이값을 다 쓰지 않았기 때문이죠. 다만 특이값 중 큰 순서대로 골랐기 때문에 노이즈를 줄이고 데이터에서 의미 있는 부분을 남기는 효과가 있습니다. $k$를 적게 잡을수록 더 많이 압축되고, 처리 비용을 줄일 수 있지만 원래 행렬인 $A$와 멀어지는 것을 감수해야겠죠. 이것을 Truncated SVD 라고 부릅니다.\n이미지 압축 예시 이러한 SVD는 이미지를 압축할 때 사용될 수 있습니다. 예시로 다음과 같은 그림을 압축해보겠습니다. 출처는 개발자를 위한 실전 선형대수학의 14장의 연습 문제입니다.\n피카소가 그린 작곡가 스트라빈스키의 초상화\n1 2 3 4 5 6 7 8 9 import numpy as np import matplotlib.pyplot as plt from skimage import io #위 그림 불러오기 url = 'https://berggasse19.org/wp-content/uploads/2015/05/stravinsky_picasso_wikipedia.png' strav = io.imread(url) / 255 np.shape(strauv) # (640, 430) 우리가 압축하려는 행렬은 640 $\\times$ 430 짜리입니다. SVD를 해보고, 그 다음 얻은 특이값들을 scree plot으로 시각화해 봅시다.\n1 2 3 4 5 6 7 8 9 10 11 U,s,Vt = np.linalg.svd(strav) #python으로 SVD 수행은 이렇게나 간단하다 S = np.zeros_like(strav) np.fill_diagonal(S,s) #특이값 행렬 만들어주기 plt.figure(figsize=(12,4)) plt.plot(s[:30],'ks-',markersize=10) #가장 큰 특이값 30개 가져오기 plt.xlabel('Component index') plt.ylabel('Singular value') plt.title('Scree plot of Stravinsky picture') plt.grid() plt.show() 총 430개의 특이값 중 30개만 표현해봤습니다. x축이 특이값 1번부터 30번을 나타내는 인덱스이며 y축은 그 값입니다. 가장 큰 특이값은 약 483이며, 그 다음 값부터는 차이가 상당히 많이 나네요.\n이제 여러 개의 $k$ 값을 골라서 이미지를 압축해봅시다. $k$를 고르고, 그에 맞춰서 $U$, $S$, $V$를 자르고, 다시 곱해주면 됩니다.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #테스트해볼 k값 k_1 = 10 k_2 = 30 k_3 = 80 #reconstruction stravRec_1 = U[:,:k_1] @ S[:k_1,:k_1] @ Vt[:k_1,:] stravRec_2 = U[:,:k_2] @ S[:k_2,:k_2] @ Vt[:k_2,:] stravRec_3 = U[:,:k_3] @ S[:k_3,:k_3] @ Vt[:k_3,:] #압축된 이미지 그리기 _,axs = plt.subplots(1,4,figsize=(15,6)) axs[0].imshow(strav,cmap='gray',vmin=.1,vmax=.9) axs[0].set_title('Original') axs[1].imshow(stravRec_3,cmap='gray',vmin=.1,vmax=.9) axs[1].set_title(f'Reconstructed (k={k_3}/{len(s)})') axs[2].imshow(stravRec_2,cmap='gray',vmin=.1,vmax=.9) axs[2].set_title(f'Reconstructed (k={k_2}/{len(s)})') axs[3].imshow(stravRec_1,cmap='gray',vmin=.1,vmax=.9) axs[3].set_title(f'Reconstructed (k={k_1}/{len(s)})') plt.tight_layout() plt.show() 좌측에서 순서대로 원본 이미지, $k=80$, $k=30$, $k=10$입니다. 오른쪽으로 갈수록 더 적은 수의 데이터를 사용하면서 이미지로 표현한 결과물이 (원본과 대조했을 때) 알아보기 어려워진 것을 확인할 수 있죠. 첫번째 압축 이미지를 보면 430개 중 80개만 사용해도 그럭저럭 원본 이미지와 유사한 결과를 내고 있습니다.\n1 2 3 4 5 6 7 8 9 stravSize = strav.nbytes / 1024**2 stravRSize = stravRec_3.nbytes / 1024**2 uSize = U[:,:k].nbytes / 1024**2 sSize = s[:k].nbytes / 1024**2 vSize = Vt[:k,:].nbytes / 1024**2 print(f' Original is {stravSize:.2f} mb') print(f'Reconstruction is {stravRSize:.2f} mb') print(f'Recon vectors are {uSize+sSize+vSize:.2f} mb (using k={k} comps.)') print(f'\\nCompression of {100*(uSize+sSize+vSize)/stravSize:.2f}%') 위와 같이 바이트 수의 백분율을 통해 압축률을 계산해보면 약 31%가 나옵니다.\n참고한 글들 Singular value decomposition [선형대수학 #4] 특이값 분해(Singular Value Decomposition, SVD)의 활용 특이값 분해(SVD)의 증명 Singular Value Decomposition (SVD), Demystified ",
  "wordCount" : "2207",
  "inLanguage": "ko",
  "datePublished": "2023-12-23T16:56:52+09:00",
  "dateModified": "2023-12-23T16:56:52+09:00",
  "author":{
    "@type": "Person",
    "name": "pizzathief"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sliceofdata.app/posts/svd/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sliceofdata",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sliceofdata.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sliceofdata.app/" accesskey="h" title="slice.of.data (Alt + H)">
                <img src="https://sliceofdata.app/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">slice.of.data</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://sliceofdata.app/en/" title="English"
                            aria-label="English">En</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sliceofdata.app/archives/" title="posts">
                    <span>posts</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/subscribe" title="subscribe">
                    <span>subscribe</span>
                </a>
            </li>
            <li>
                <a href="https://pizzathief.pages.dev/" title="notes">
                    <span>notes</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      수학을 까먹은 사람을 위한 특이값분해(SVD)
    </h1>
    <div class="post-meta"><span title='2023-12-23 16:56:52 +0900 KST'>2023-12-23</span>&nbsp;·&nbsp;11 min&nbsp;·&nbsp;pizzathief&nbsp;|&nbsp;<a href="https://github.com/pizzathiefz/sliceofdata/blob/main/content/posts/svd/index.ko.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#svd-식-만들어보기">SVD 식 만들어보기</a></li>
    <li><a href="#svd의-기하학적-의미">SVD의 기하학적 의미</a></li>
    <li><a href="#svd의-응용">SVD의 응용</a>
      <ul>
        <li><a href="#이미지-압축-예시">이미지 압축 예시</a></li>
      </ul>
    </li>
    <li><a href="#참고한-글들">참고한 글들</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="svd-식-만들어보기">SVD 식 만들어보기<a hidden class="anchor" aria-hidden="true" href="#svd-식-만들어보기">#</a></h2>
<p>일단 정의부터 써봅시다.
실수값으로 이루어진 모든 $m \times n$ 행렬 $A$ 는 다음과 같이 특이값분해될 수 있습니다.</p>
<blockquote>
<p>잠깐 이 문장으로 알 수 있는 사실은, 그 정의상 정방행렬($m = n$ )에서만 가능하고 또 특정 조건(서로 독립인 $n$개의 고유벡터가 존재)을 만족해야만 가능했던 고유값분해와 달리 특이값분해는 꼭 필요한 조건이 없다는 것입니다.</p></blockquote>
<p>$$ A = U\Sigma V^T $$</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/svd/svd.jpg#center"
         alt="그림 출처" width="480"/> <figcaption>
            <p><a href="https://www.askpython.com/python/examples/singular-value-decompositionhttps://www.askpython.com/python/examples/singular-value-decomposition">그림 출처</a></p>
        </figcaption>
</figure>

<ul>
<li>$U$는 $m \times m$ 직교행렬이며 $AA^T$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다.</li>
<li>$V$는 $n \times n$ 직교행렬이며 $A^TA$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다.</li>
<li>$\Sigma$는 $m \times n$ 대각행렬이며 $AA^T$, $A^TA$를 고유값분해해서 얻은 고유값들의 제곱근을 취한 값을 좌상단부터 대각 원소로 가지고, 나머지 부분들은 다 0으로 만들어졌다.</li>
</ul>
<p>정의부터 던지면 이게 다 뭔 소리지 라는 생각이 듭니다. 이 세 가지 행렬이 왜 나오는지 천천히 뜯어보고 증명도 해볼 것입니다.</p>
<p>일단 모든 행렬에 대해 그 행렬과 전치행렬을 곱한 행렬인  $AA^T$, $A^TA$ 이 두 가지 행렬은 좀 특별한 구석이 있는데요, 이 행렬의 특징들에 대해 알 필요가 있습니다. 그게 왜 그런데? 라는 생각이 드시는 분들을 위해 &lsquo;왜&rsquo;도 다 적어놨지만, 사실 그냥 그렇구나 하고 넘어가셔도 무방합니다.</p>
<br>
<ul>
<li><strong>정방행렬</strong>이다.
<ul>
<li>$AA^T$: $m \times n$ 행렬과 $n \times m$ 행렬을 곱했으니까 $m \times m$ 행렬임</li>
<li>$A^TA$: $n \times m$ 행렬과 $m \times n$ 행렬을 곱했으니까 $n \times n$ 행렬임</li>
</ul>
</li>
<li><strong>대칭행렬</strong>이다.
<ul>
<li>💡 대칭행렬이 뭐더라? 시각적으로는 대각 기준으로 반 접으면 접히는 값들이 같다는 것이며 정확한 정의로는 전치해도 원래 행렬과 동일하다는 것이다. 즉 $X = X^T$</li>
<li>전치해보면 아주 쉽다. $(AA^T)^T = AA^T$, $(A^TA)^T = A^TA$</li>
</ul>
</li>
<li><strong>고유값분해될 수 있다(=실수 고유값을 가짐).</strong> 왜냐면 모든 대칭행렬은 고유값분해될 수 있기 때문에.
<ul>
<li>💡 다시 강조하면 모든 실수 행렬이 고유값분해 될 수 있는 것은 아니며 어떤 행렬은 고유값으로 허수값을 가질 수도 있다! 하지만 대칭행렬은 고유값의 실수임이 보장된다는 건데,</li>
<li>실수 대칭행렬 $S$의 고유값 $\lambda$ 이 있을 때 (즉 $S \mathbf{v} = \lambda \mathbf{v}$)  <strong>&hellip;</strong> 1️⃣</li>
<li>켤레값을 취하면 $\bar{S} \bar{\mathbf{v}} = \bar{\lambda} \bar{\mathbf{v}}$ 이며 $S$는 실수행렬이므로 ($\bar{S} = S$)  $S \bar{\mathbf{v}} = \bar{\lambda} \bar{\mathbf{v}}$</li>
<li>전치하면 $\bar{\mathbf{v}}^TS^T = \bar{\lambda} \bar{\mathbf{v}}^T$ 이며 $S$는 대칭이므로 ($S=S^T$)  $\bar{\mathbf{v}}^TS = \bar{\lambda} \bar{\mathbf{v}}^T$   <strong>&hellip;</strong> 2️⃣</li>
<li>1️⃣ $S \mathbf{v} = \lambda \mathbf{v}$ 에 $\bar{\mathbf{v}}^T$를 곱하면, $\bar{\mathbf{v}}^T S \mathbf{v} = \lambda \bar{\mathbf{v}}^T \mathbf{v}$</li>
<li>2️⃣ $\bar{\mathbf{v}}^TS = \bar{\lambda} \bar{\mathbf{v}}^T$ 에 $\mathbf{v}$를 곱하면, $\bar{\mathbf{v}}^TS \mathbf{v} = \bar{\lambda} \bar{\mathbf{v}}^T \mathbf{v}$</li>
<li>위 두 식의 좌변이 같으므로 우변도 같아야 함. $\lambda = \bar{\lambda}$ 가 되어 $\lambda$ 는 실수임.</li>
</ul>
</li>
<li><strong>고유벡터들이 직교한다</strong>. 왜냐면 대칭행렬의 고유벡터들은 항상 직교하기 때문에.
<ul>
<li>대칭행렬 $S$의 서로 다른 고유벡터 $\mathbf{v}_1, \mathbf{v}_2$와 그에 대응하는 고유값 $\lambda_1$, $\lambda_2$가 있을 때 (즉 $S\mathbf{v}_1 = \lambda_1 \mathbf{v}_1$, $S\mathbf{v}_2 = \lambda_2 \mathbf{v}_2$)</li>
<li>$\lambda_1 \mathbf{v}^T_1 \mathbf{v}_2 = (S\mathbf{v}_1)^T \mathbf{v}_2 = \mathbf{v}_1^TS^T\mathbf{v}_2 = \mathbf{v}_1^TS\mathbf{v}_2 = \mathbf{v}^T_1\lambda_2\mathbf{v}_2 = \lambda_2\mathbf{v}^T_1 \mathbf{v}_2$</li>
<li>$\lambda_1\mathbf{v}^T_1\mathbf{v}_2 - \lambda_2 \mathbf{v}^T_1 \mathbf{v}_2 = (\lambda_1 - \lambda_2) \mathbf{v}^T_1 \mathbf{v}_2 = 0$</li>
<li>💡 직교가 뭐더라? 두 벡터의 내적이 0인 것이다. 즉 $\mathbf{v}_1^T\mathbf{v}_2=0$ 이면 두 벡터는 직교한다.</li>
<li>여기서 서로 다른 두 고유값은 같은 값일 수 없으므로 ($\lambda_1 - \lambda_2 \neq 0$ ) $\mathbf{v}_1^T\mathbf{v}_2=0$</li>
</ul>
</li>
<li><strong>고유값들이 모두 0 이상의 값을 가진다</strong>. 왜냐면 semi-positive definite한 행렬이기 때문에.
<ul>
<li>💡 positive definite가 뭐더라? 영벡터가 아닌 모든 벡터 $\mathbf{v}$에 대해 항상 $\mathbf{v}^TA\mathbf{v} &gt;0$ 일 때 $A$를 positive definite하다고 하고, $\ge 0$일 때 semi-positive definite 하다고 함. 행렬에도 부호가 있다고 이해하면 편하다!
<ul>
<li>어떤 semi-positive definite 행렬과 그 고유값에 대해, $A\mathbf{v} = \lambda \mathbf{v}$ 의 양변에 $\mathbf{v}^T$를 곱하면, $\mathbf{v}^TA\mathbf{v} = \lambda \mathbf{v}\mathbf{v}^T \ge 0$ 결국 고유값과 벡터의 내적값을 곱한 게 0 이상이어야 하므로 고유값도 0 이상이어야 한다는 결론.</li>
</ul>
</li>
<li>$A^TA$ 에 대해 $\mathbf{v}^TA^TA\mathbf{v}$ 이렇게 곱해보면 결국 $(A\mathbf{v})^T(A\mathbf{v}) = \Vert A\mathbf{v} \Vert ^2 \ge 0$ 이므로 semi-positive definite이고, 그래서 고유값들이 0 이상임.</li>
</ul>
</li>
</ul>
<br>
<p>위 사실들을 생각하면서 특이값분해를 증명해봅시다.</p>
<p>우선 $A^TA$ 부터 보겠습니다. 이 행렬은 고유값분해될 수 있기 때문에, 여러 개의 고유값과 그에 상응하는 고유벡터가 존재할 것입니다. 다음과 같은 고유값 $\lambda_i$와 고유벡터 $\mathbf{v}_i$ 가 있다는 것이죠.</p>
<p>$$A^TA\mathbf{v}_i = \lambda_i\mathbf{v}_i = \sigma_i^2\mathbf{v}_i$$
이때  $A^TA$ 의 모든 고유값은 0 이상의 값을 가진다는 것을 기억하면, $\lambda_i$는 제곱근을 가질 것이고 그걸 $\sigma_i$라고 써줬습니다.</p>
<p>이제 $\mathbf{v}_i$ 의 특징을 생각해봅시다. 고유값분해에 대해 떠올려보면, 고유값에 대응하는 고유벡터는 굉장히 많은 수로 존재할 수 있습니다. 제가 이전 글에 썼던 예시를 그대로 가져와보면,</p>
<p>$$ \begin{bmatrix} 1 &amp; 2 \\ 2 &amp; 1 \end{bmatrix} \begin{bmatrix} 1 \\ 1 \end{bmatrix} = 3 \begin{bmatrix} 1 \\ 1 \end{bmatrix}  $$</p>
<p>이 행렬의 고유값 3에 대해 고유벡터는 (1,1)이 될 수도 있고 (50000, 50000)이 될 수도 있고 (-1234, -1234)가 될 수도 있다고 했었죠. 방향만 같으면 크기는 마음대로 할 수 있다는 겁니다. 따라서 우리는 보통 노름(어떤 벡터를 자기자신과 내적한 값, 즉 $\mathbf{v}^T\mathbf{v}$ 의 양의 제곱근)이 1이 되는 벡터로 고유벡터를 고릅니다. 이런 벡터를 단위벡터라고 합니다. 어떤 벡터든 노름값으로 나눠서 크기를 조정해주면 단위벡터로 만들어줄 수 있습니다. 따라서 $\mathbf{v}_i ^T \mathbf{v}_i =1$ 입니다.</p>
<p>또 앞서 언급했듯 $A^TA$는 대칭행렬이라서 모든 고유벡터가 서로 직교합니다. 따라서 서로다른 $i$,$j$ 에 대해 $\mathbf{v}_i ^T \mathbf{v}_j =0$이라는 사실도 기억합시다. 따라서 모든 $\mathbf{v}$를 열로 이어붙여 행렬을 만든다면 이 행렬은 직교행렬이겠죠.</p>
<p>여기까지 보면, 다음 문장은 더 이상 설명할 게 없을 겁니다.</p>
<blockquote>
<p><strong>$V$는 $n \times n$ 직교행렬이며 $A^TA$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다.</strong></p></blockquote>
<br>
<p>추가로, $A^TA\mathbf{v}_i = \sigma_i^2\mathbf{v}_i$ 이 식의 양변에 $\mathbf{v}_i^T$ 를 곱해 봅시다.</p>
<p>$$ \mathbf{v}_i^TA^TA\mathbf{v}_i = \sigma_i^2\mathbf{v}_i^T\mathbf{v}_i$$</p>
<p>단위벡터라서 $\mathbf{v}_i ^T \mathbf{v}_i =1$ 이므로,
$$ (A\mathbf{v}_i)^TA\mathbf{v}_i = \sigma_i^2$$</p>
<p>$A\mathbf{v}_i$ 의 노름이 $\sigma_i$란 사실을 알 수 있습니다. 이 말은 다름 아니라, $\frac{A\mathbf{v}_i}{\sigma_i}$ 는 또다른 단위벡터라는 뜻이죠.</p>
<p>즉 모든 $A^TA$의 고유벡터 $\mathbf{v}_i$ 에 대해 다음과 같은 단위벡터 $\mathbf{u}_i$가 존재합니다.</p>
<p>$$\mathbf{u}_i = \frac{A\mathbf{v}_i}{\sigma_i}$$</p>
<p>이번엔 $A^TA\mathbf{v}_i = \sigma_i^2\mathbf{v}_i$ 이 식의 양변에 $A$ 를 곱해 봅시다.</p>
<p>$$AA^TA\mathbf{v}_i = \sigma_i^2A\mathbf{v}_i$$</p>
<p>양변을 $\sigma_i$로 나눠준다면, 최종적으로 다음과 같은 식이 도출되어 $\mathbf{u}_i$가 $AA^T$의 고유벡터이며, 그 고유값은 $\sigma_i^2$ 로, $A^TA$의 고유값과 동일하다는 사실을 알 수 있습니다.</p>
<p>$$AA^T (\frac{A\mathbf{v}_i}{\sigma_i}) = AA^T\mathbf{u}_i = \sigma_i^2\mathbf{u}_i$$
그 외의 다른 성질, 예를 들면 서로다른 $i$, $j$ 에 대해 $\mathbf{u}_i$, $\mathbf{u}_j$ 가 직교라는 점은 $AA^T$의 고유벡터나 $A^TA$의 고유벡터나 동일하기 때문에 다시 쓸 필요는 없겠습니다.</p>
<p>이제 다음 문장까지 정리가 되었습니다.</p>
<blockquote>
<p><strong>$U$는 $m \times m$ 직교행렬이며 $AA^T$를 고유값분해해서 얻은 고유벡터를 열로 하여 만들어졌다</strong>.</p></blockquote>
<br>
<p>다시 $A$와 $\mathbf{u}_i$ 와 $\mathbf{v}_i$의 관계식으로 돌아가면 다음과 같습니다.</p>
<p>$$\sigma_i\mathbf{u}_i = A\mathbf{v}_i$$</p>
<p>이를 개별 벡터가 아닌 행렬의 모양으로 다시 쓰면 이렇습니다.</p>
<p>$$ U \Sigma = AV$$</p>
<p>여기서 이게 행렬로 쓰면 왜 이렇게 되지? $\Sigma$ 는 어떻게 생긴 행렬이지? 라는 생각이 들 수 있습니다. 그 이야기를 잠깐 해보겠습니다.</p>
<p>$AA^T$ 와 $A^TA$는 각각 $m$개, $n$개의 선형독립인 고유벡터를 가지고 그에 대응하는 고유값을 가질 것입니다. 그 중 일부는 0이고 일부는 0이 아닐 수 있는데요. 0이 아닌 고유값에 대해서 $AA^T$ 와 $A^TA$의 고유값이 일치한다는 사실은 위에서 보았습니다. 0이 아닌 고유값이 $r$ 개 있다고 합시다.</p>
<p>$$ \lambda_1, \cdots, \lambda_r  =  \sigma^2_1,\cdots, \sigma^2_r$$</p>
<p>이때 $r$ 은 사실 각 행렬의 rank 값과 동일하며, 원 행렬 $A$의 rank 값과도 동일합니다. 왜인지를 생각해보면, 행렬 $S$가 고유값분해로 대각화될 수 있을 때  ($S=V \Lambda V^{-1}$) 역행렬이 있는 행렬의 곱은 rank를 변화시키지 않으므로 결국 이 행렬 $S$ 는 고유값으로 이루어진 대각행렬 $\Lambda$과 rank가 동일한 건데, 대각행렬에서 서로 독립인 열의 개수는 단순히 0이 아닌 대각원소의 개수를 센 값이기 때문입니다.</p>
<p>어쨌든 이 0이 아닌 고유값들의 제곱근($\sigma$)을 큰 순서대로 대각 원소로 하고, 나머지 부분은 0으로 채운 행렬을 생각해봅시다.</p>
<p>$$ \sigma_1 \ge \sigma_2 \ge \cdots \ge \sigma_r &gt; 0 $$</p>
<p>이 행렬은 $r \times r$이므로 $m \times n$ 으로 만들어주기 위해 ($m-r$) 행만큼, ($n-r$) 열만큼 또 0으로 채워줍니다.
$m = 4$, $n = 5$, $r=3$ 인 $\Sigma$의 예시는 다음과 같습니다.</p>
<p>$$\begin{bmatrix} 3 &amp; 0 &amp; 0 &amp;0 &amp;0 \\ 0 &amp; \sqrt{5} &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 2 &amp; 0 &amp; 0  \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \end{bmatrix}$$</p>
<p>즉 원래 행렬 $A$는  rank-3 행렬이며, $AA^T$, $A^TA$의  0이 아닌 고유값의 제곱근은 큰 순서대로 3, $\sqrt{5}$, 2입니다. 이 값들을  행렬 $A$의 <strong>특이값(singular value)</strong> 이라고 부릅니다.</p>
<p>다시 $AA^T$의 고유벡터 $m$개를 열로 이어붙인 행렬을 다음과 같이 만들 수 있습니다. 다시 $m=4$의 예시입니다.</p>
<p>$$U = \begin{bmatrix} \mid &amp; \mid &amp; \mid &amp; \mid \\ \mathbf{u_1} &amp; \mathbf{u_2} &amp; \mathbf{u_3} &amp; \mathbf{u_4}  \\ \mid &amp; \mid &amp; \mid &amp; \mid   \end{bmatrix} = \begin{bmatrix} 0 &amp; -1 &amp; 0 &amp; 0 \\ -1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; -1 \\ 0 &amp; 0 &amp; -1 &amp; 0  \end{bmatrix} $$</p>
<p>이제 행렬곱 $U\Sigma$ 를 해보면, $i=1, \cdots, m (m=4)$ 에 대해 우리가 증명했던 벡터 기준의 식의 좌변인 $\sigma_i\mathbf{u}_i$ 가 나온다는 것을 알 수 있죠. 특이한 점은 $\Sigma$에서 $r+1$부터는 다 0으로 채워줬기 때문에 $\mathbf{u}_4$ 는 곱하면 0이 되어 사실 결과에 전혀 영향을 주지 못합니다.</p>
<p>마찬가지로 $A^TA$의 고유벡터 $n$개를 열로 이어붙인 행렬도 만들 수 있습니다.</p>
<p>$$V = \begin{bmatrix} \mid &amp; \mid &amp; \mid &amp; \mid&amp; \mid \\ \mathbf{v_1} &amp; \mathbf{v_2} &amp; \mathbf{v_3} &amp; \mathbf{v_4} &amp; \mathbf{v_5}  \\ \mid&amp; \mid &amp; \mid &amp; \mid &amp; \mid   \end{bmatrix} = \begin{bmatrix} 0 &amp;  0 &amp;  -1 &amp; 0 &amp; 0 \\ -\sqrt{0.2} &amp; 0 &amp; 0 &amp; 0 &amp; -\sqrt{0.8} \\ 0 &amp; -1 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\ -\sqrt{0.8} &amp; 0 &amp; 0 &amp; 0 &amp; \sqrt{0.2}  \end{bmatrix} $$</p>
<p>행렬곱 $AV$는 우변이었던 $A\mathbf{v}_i$를 그대로 행렬로 쓴 것과 동일합니다.</p>
<p>이때 $V$는 서로 직교하는 단위벡터로 이루어진 직교행렬이기 때문에 $VV^T = I$, $V^{-1} = V^T$ 이구요. 양변에 이 행렬을 곱해주면, 이렇게 해서 <strong>드디어</strong> 출발점이었던 다음 식에 도달했습니다!</p>
<p>$$ A = U\Sigma V^T $$
<br>
<br></p>
<h2 id="svd의-기하학적-의미">SVD의 기하학적 의미<a hidden class="anchor" aria-hidden="true" href="#svd의-기하학적-의미">#</a></h2>
<p>고유값분해의 기하학적 의미는 어떤 벡터에 어떤 행렬을 곱했을 때, 벡터의 크기만 변하고 방향은 변하지 않는다는 것이었습니다. 이번에는 서로 직교하는 벡터에 어떤 행렬을 곱하는 것을 상상해봅시다.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/svd/svd-ab.png#center"
         alt="그림 출처" width="450"/> <figcaption>
            <p><a href="https://gregorygundersen.com/blog/2018/12/10/svd/">그림 출처</a></p>
        </figcaption>
</figure>

<ul>
<li>A의 경우, 직교하는 두 벡터에 $M$ 이라는 행렬을 곱했을 때 사이각이 변함</li>
<li>B의 경우, 직교하는 두 벡터에 $M$ 이라는 행렬을 곱했더니 여전히 직교 상태를 유지하고 있음 (다만 둘이 같이 회전했고, 각 크기는 변했음)</li>
</ul>
<p>특이값 분해의 의미는 위의 B 케이스처럼 <strong>직교하는 어떤 벡터에 어떤 행렬을 곱했을 때, 크기가 변하고 회전되더라도 직교하는 상태는 변하지 않는다</strong>는 것입니다. 위에서 보인 식으로 돌아가면, $U \Sigma = AV$ 이 식에서 $A$ 는 곱해지는 행렬(선형변환)이고, $\Sigma$는 크기가 변하는(스케일링되는) 값을 의미합니다. $V$와 $U$는 반복해서 언급했듯 직교행렬이고요.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/svd/svd-2.png#center"
         alt="그림 출처" width="330"/> <figcaption>
            <p><a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">그림 출처</a></p>
        </figcaption>
</figure>

<p>이를 염두에 두고 다시 $A = U\Sigma V^T$ (그림 속 $M$ )를 보면, 모든 $A$라는 행렬을 곱하는 행위는 결국 $m$차원에서 $n$차원으로 선형 변환을 하는 것을 의미하는데, 직교행렬 $U, V$는 은 곱해질 때 회전만 시킬 뿐 각도나 크기를 변화시키지 않고 $\Sigma$는 크기만 바꾸므로, 순서대로 1) $V^T$를 곱해서 회전 2) $\Sigma$를 곱해서 크기 변화 3) $U$를 곱해서 회전을 하는 것과 동일합니다. 따라서 원래 벡터의 모양을 바꾸는 것은 오로지 특이값의 크기($\Sigma$의 값)에만 달려 있습니다.</p>
<br>
<h2 id="svd의-응용">SVD의 응용<a hidden class="anchor" aria-hidden="true" href="#svd의-응용">#</a></h2>
<p>특이값분해는 <strong>데이터를 효과적으로 압축</strong>하는 데 사용될 수 있습니다.
우리가 지금까지 알아낸 SVD, 즉 다음과 같이 행렬을 분해하는 것을 <strong>Full SVD</strong>라고 합니다.</p>
<p>$$ A = U\Sigma V^T $$</p>
<p>아까 $\Sigma$ 가 어떻게 생겼는지 되살려보면,</p>
<p>$$\begin{bmatrix} 3 &amp; 0 &amp; 0 &amp;0 &amp;0 \\ 0 &amp; \sqrt{5} &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 2 &amp; 0 &amp; 0  \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 \end{bmatrix}$$</p>
<p>이런 식으로 내림차순으로 정렬된 $A$의 rank 만큼의 0이 아닌 특이값이 존재($r$개)하고, 나머지는 다 0입니다. 0인 부분은 다 날려 버리고, 이에 대응하는 $U$와 $V$의 벡터들도 $r$개만 선택하면 어떨까요? 아까 잠깐 설명했듯 $r+1$ 이후 부분부터는 결과물에 아무 영향도 주지 않기 때문에 $U_r\Sigma_r V_r^T$ 로도 원래 행렬 $A$를 얻을 수 있습니다.</p>
<p>이번에는 조금 더 과감하게, 0이 아닌 특이값 중 가장 큰 $k$개만 ($k &lt; r$) 남기고 $U$와 $V^T$도 $k$개의 열, 행만 남겨 봅시다.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/svd/truncated-svd.jpg#center"
         alt="그림 출처" width="630"/> <figcaption>
            <p><a href="https://towardsdatascience.com/singular-value-decomposition-svd-demystified-57fc44b802a0">그림 출처</a></p>
        </figcaption>
</figure>

<p>이렇게 얻은 $A_k = U_k\Sigma_k V_k^T$ 는 원래의 $A$ 와 완전히 같지는 않은 근사행렬입니다. 전체 특이값을 다 쓰지 않았기 때문이죠. 다만 특이값 중 큰 순서대로 골랐기 때문에 노이즈를 줄이고 데이터에서 의미 있는 부분을 남기는 효과가 있습니다. $k$를 적게 잡을수록 더 많이 압축되고, 처리 비용을 줄일 수 있지만 원래 행렬인 $A$와 멀어지는 것을 감수해야겠죠. 이것을 <strong>Truncated SVD</strong> 라고 부릅니다.</p>
<br>
<h3 id="이미지-압축-예시">이미지 압축 예시<a hidden class="anchor" aria-hidden="true" href="#이미지-압축-예시">#</a></h3>
<p>이러한 SVD는 이미지를 압축할 때 사용될 수 있습니다. 예시로 다음과 같은 그림을 압축해보겠습니다. 출처는 <a href="https://m.hanbit.co.kr/store/books/book_view.html?p_code=B4279863215">개발자를 위한 실전 선형대수학</a>의 14장의 연습 문제입니다.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/svd/stravinsky-by-picasso.png#center"
         alt="피카소가 그린 작곡가 스트라빈스키의 초상화" width="260"/> <figcaption>
            <p>피카소가 그린 작곡가 스트라빈스키의 초상화</p>
        </figcaption>
</figure>

<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">numpy</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">np</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">matplotlib.pyplot</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">plt</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">skimage</span> <span style="color:#81a1c1;font-weight:bold">import</span> io
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic">#위 그림 불러오기</span>
</span></span><span style="display:flex;"><span>url <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;https://berggasse19.org/wp-content/uploads/2015/05/stravinsky_picasso_wikipedia.png&#39;</span>
</span></span><span style="display:flex;"><span>strav <span style="color:#81a1c1">=</span> io<span style="color:#81a1c1">.</span>imread<span style="color:#eceff4">(</span>url<span style="color:#eceff4">)</span> <span style="color:#81a1c1">/</span> <span style="color:#b48ead">255</span>
</span></span><span style="display:flex;"><span>np<span style="color:#81a1c1">.</span>shape<span style="color:#eceff4">(</span>strauv<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># (640, 430)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>우리가 압축하려는 행렬은 640 $\times$ 430 짜리입니다. SVD를 해보고, 그 다음 얻은 특이값들을 scree plot으로 시각화해 봅시다.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>U<span style="color:#eceff4">,</span>s<span style="color:#eceff4">,</span>Vt <span style="color:#81a1c1">=</span> np<span style="color:#81a1c1">.</span>linalg<span style="color:#81a1c1">.</span>svd<span style="color:#eceff4">(</span>strav<span style="color:#eceff4">)</span> <span style="color:#616e87;font-style:italic">#python으로 SVD 수행은 이렇게나 간단하다</span>
</span></span><span style="display:flex;"><span>S <span style="color:#81a1c1">=</span> np<span style="color:#81a1c1">.</span>zeros_like<span style="color:#eceff4">(</span>strav<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>np<span style="color:#81a1c1">.</span>fill_diagonal<span style="color:#eceff4">(</span>S<span style="color:#eceff4">,</span>s<span style="color:#eceff4">)</span> <span style="color:#616e87;font-style:italic">#특이값 행렬 만들어주기</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>figure<span style="color:#eceff4">(</span>figsize<span style="color:#81a1c1">=</span><span style="color:#eceff4">(</span><span style="color:#b48ead">12</span><span style="color:#eceff4">,</span><span style="color:#b48ead">4</span><span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>plot<span style="color:#eceff4">(</span>s<span style="color:#eceff4">[:</span><span style="color:#b48ead">30</span><span style="color:#eceff4">],</span><span style="color:#a3be8c">&#39;ks-&#39;</span><span style="color:#eceff4">,</span>markersize<span style="color:#81a1c1">=</span><span style="color:#b48ead">10</span><span style="color:#eceff4">)</span> <span style="color:#616e87;font-style:italic">#가장 큰 특이값 30개 가져오기</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>xlabel<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;Component index&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>ylabel<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;Singular value&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>title<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;Scree plot of Stravinsky picture&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>grid<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>show<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/svd/scree-plot.png#center" width="480"/> 
</figure>

<p>총 430개의 특이값 중 30개만 표현해봤습니다. x축이 특이값 1번부터 30번을 나타내는 인덱스이며 y축은 그 값입니다. 가장 큰 특이값은 약 483이며, 그 다음 값부터는 차이가 상당히 많이 나네요.</p>
<p>이제 여러 개의 $k$ 값을 골라서 이미지를 압축해봅시다. $k$를 고르고, 그에 맞춰서 $U$, $S$, $V$를 자르고, 다시 곱해주면 됩니다.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#616e87;font-style:italic">#테스트해볼 k값</span>
</span></span><span style="display:flex;"><span>k_1 <span style="color:#81a1c1">=</span> <span style="color:#b48ead">10</span>
</span></span><span style="display:flex;"><span>k_2 <span style="color:#81a1c1">=</span> <span style="color:#b48ead">30</span>
</span></span><span style="display:flex;"><span>k_3 <span style="color:#81a1c1">=</span> <span style="color:#b48ead">80</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic">#reconstruction</span>
</span></span><span style="display:flex;"><span>stravRec_1 <span style="color:#81a1c1">=</span> U<span style="color:#eceff4">[:,:</span>k_1<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> S<span style="color:#eceff4">[:</span>k_1<span style="color:#eceff4">,:</span>k_1<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> Vt<span style="color:#eceff4">[:</span>k_1<span style="color:#eceff4">,:]</span>
</span></span><span style="display:flex;"><span>stravRec_2 <span style="color:#81a1c1">=</span> U<span style="color:#eceff4">[:,:</span>k_2<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> S<span style="color:#eceff4">[:</span>k_2<span style="color:#eceff4">,:</span>k_2<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> Vt<span style="color:#eceff4">[:</span>k_2<span style="color:#eceff4">,:]</span>
</span></span><span style="display:flex;"><span>stravRec_3 <span style="color:#81a1c1">=</span> U<span style="color:#eceff4">[:,:</span>k_3<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> S<span style="color:#eceff4">[:</span>k_3<span style="color:#eceff4">,:</span>k_3<span style="color:#eceff4">]</span> <span style="color:#81a1c1">@</span> Vt<span style="color:#eceff4">[:</span>k_3<span style="color:#eceff4">,:]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic">#압축된 이미지 그리기</span>
</span></span><span style="display:flex;"><span>_<span style="color:#eceff4">,</span>axs <span style="color:#81a1c1">=</span> plt<span style="color:#81a1c1">.</span>subplots<span style="color:#eceff4">(</span><span style="color:#b48ead">1</span><span style="color:#eceff4">,</span><span style="color:#b48ead">4</span><span style="color:#eceff4">,</span>figsize<span style="color:#81a1c1">=</span><span style="color:#eceff4">(</span><span style="color:#b48ead">15</span><span style="color:#eceff4">,</span><span style="color:#b48ead">6</span><span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>imshow<span style="color:#eceff4">(</span>strav<span style="color:#eceff4">,</span>cmap<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;gray&#39;</span><span style="color:#eceff4">,</span>vmin<span style="color:#81a1c1">=</span><span style="color:#b48ead">.1</span><span style="color:#eceff4">,</span>vmax<span style="color:#81a1c1">=</span><span style="color:#b48ead">.9</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>set_title<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;Original&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">1</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>imshow<span style="color:#eceff4">(</span>stravRec_3<span style="color:#eceff4">,</span>cmap<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;gray&#39;</span><span style="color:#eceff4">,</span>vmin<span style="color:#81a1c1">=</span><span style="color:#b48ead">.1</span><span style="color:#eceff4">,</span>vmax<span style="color:#81a1c1">=</span><span style="color:#b48ead">.9</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">1</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>set_title<span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Reconstructed (k=</span><span style="color:#a3be8c">{</span>k_3<span style="color:#a3be8c">}</span><span style="color:#a3be8c">/</span><span style="color:#a3be8c">{</span><span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span>s<span style="color:#eceff4">)</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">)&#39;</span><span style="color:#eceff4">)</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">2</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>imshow<span style="color:#eceff4">(</span>stravRec_2<span style="color:#eceff4">,</span>cmap<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;gray&#39;</span><span style="color:#eceff4">,</span>vmin<span style="color:#81a1c1">=</span><span style="color:#b48ead">.1</span><span style="color:#eceff4">,</span>vmax<span style="color:#81a1c1">=</span><span style="color:#b48ead">.9</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">2</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>set_title<span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Reconstructed (k=</span><span style="color:#a3be8c">{</span>k_2<span style="color:#a3be8c">}</span><span style="color:#a3be8c">/</span><span style="color:#a3be8c">{</span><span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span>s<span style="color:#eceff4">)</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">)&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">3</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>imshow<span style="color:#eceff4">(</span>stravRec_1<span style="color:#eceff4">,</span>cmap<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;gray&#39;</span><span style="color:#eceff4">,</span>vmin<span style="color:#81a1c1">=</span><span style="color:#b48ead">.1</span><span style="color:#eceff4">,</span>vmax<span style="color:#81a1c1">=</span><span style="color:#b48ead">.9</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>axs<span style="color:#eceff4">[</span><span style="color:#b48ead">3</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>set_title<span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Reconstructed (k=</span><span style="color:#a3be8c">{</span>k_1<span style="color:#a3be8c">}</span><span style="color:#a3be8c">/</span><span style="color:#a3be8c">{</span><span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span>s<span style="color:#eceff4">)</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">)&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>tight_layout<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>show<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/svd/svd-images.png#center" width="650"/> 
</figure>

<p>좌측에서 순서대로 원본 이미지, $k=80$, $k=30$, $k=10$입니다. 오른쪽으로 갈수록 더 적은 수의 데이터를 사용하면서 이미지로 표현한 결과물이 (원본과 대조했을 때) 알아보기 어려워진 것을 확인할 수 있죠. 첫번째 압축 이미지를 보면 430개 중 80개만 사용해도 그럭저럭 원본 이미지와 유사한 결과를 내고 있습니다.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>stravSize <span style="color:#81a1c1">=</span> strav<span style="color:#81a1c1">.</span>nbytes <span style="color:#81a1c1">/</span> <span style="color:#b48ead">1024</span><span style="color:#81a1c1">**</span><span style="color:#b48ead">2</span> 
</span></span><span style="display:flex;"><span>stravRSize <span style="color:#81a1c1">=</span> stravRec_3<span style="color:#81a1c1">.</span>nbytes <span style="color:#81a1c1">/</span> <span style="color:#b48ead">1024</span><span style="color:#81a1c1">**</span><span style="color:#b48ead">2</span> 
</span></span><span style="display:flex;"><span>uSize <span style="color:#81a1c1">=</span> U<span style="color:#eceff4">[:,:</span>k<span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>nbytes <span style="color:#81a1c1">/</span> <span style="color:#b48ead">1024</span><span style="color:#81a1c1">**</span><span style="color:#b48ead">2</span> 
</span></span><span style="display:flex;"><span>sSize <span style="color:#81a1c1">=</span> s<span style="color:#eceff4">[:</span>k<span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>nbytes <span style="color:#81a1c1">/</span> <span style="color:#b48ead">1024</span><span style="color:#81a1c1">**</span><span style="color:#b48ead">2</span> 
</span></span><span style="display:flex;"><span>vSize <span style="color:#81a1c1">=</span> Vt<span style="color:#eceff4">[:</span>k<span style="color:#eceff4">,:]</span><span style="color:#81a1c1">.</span>nbytes <span style="color:#81a1c1">/</span> <span style="color:#b48ead">1024</span><span style="color:#81a1c1">**</span><span style="color:#b48ead">2</span> 
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39; Original is </span><span style="color:#a3be8c">{</span>stravSize<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c"> mb&#39;</span><span style="color:#eceff4">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Reconstruction is </span><span style="color:#a3be8c">{</span>stravRSize<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c"> mb&#39;</span><span style="color:#eceff4">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Recon vectors are </span><span style="color:#a3be8c">{</span>uSize<span style="color:#81a1c1">+</span>sSize<span style="color:#81a1c1">+</span>vSize<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c"> mb (using k=</span><span style="color:#a3be8c">{</span>k<span style="color:#a3be8c">}</span><span style="color:#a3be8c"> comps.)&#39;</span><span style="color:#eceff4">)</span> 
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;</span><span style="color:#ebcb8b">\n</span><span style="color:#a3be8c">Compression of </span><span style="color:#a3be8c">{</span><span style="color:#b48ead">100</span><span style="color:#81a1c1">*</span><span style="color:#eceff4">(</span>uSize<span style="color:#81a1c1">+</span>sSize<span style="color:#81a1c1">+</span>vSize<span style="color:#eceff4">)</span><span style="color:#81a1c1">/</span>stravSize<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">%&#39;</span><span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>위와 같이 바이트 수의 백분율을 통해 압축률을 계산해보면 약 31%가 나옵니다.</p>
<br>
<h2 id="참고한-글들">참고한 글들<a hidden class="anchor" aria-hidden="true" href="#참고한-글들">#</a></h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Singular_value_decomposition">Singular value decomposition</a></li>
<li><a href="https://darkpgmr.tistory.com/106">[선형대수학 #4] 특이값 분해(Singular Value Decomposition, SVD)의 활용</a></li>
<li><a href="https://pasus.tistory.com/16">특이값 분해(SVD)의 증명</a></li>
<li><a href="https://towardsdatascience.com/singular-value-decomposition-svd-demystified-57fc44b802a0">Singular Value Decomposition (SVD), Demystified</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sliceofdata.app/tags/linear-algebra/">Linear-Algebra</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 수학을 까먹은 사람을 위한 특이값분해(SVD) on x"
            href="https://x.com/intent/tweet/?text=%ec%88%98%ed%95%99%ec%9d%84%20%ea%b9%8c%eb%a8%b9%ec%9d%80%20%ec%82%ac%eb%9e%8c%ec%9d%84%20%ec%9c%84%ed%95%9c%20%ed%8a%b9%ec%9d%b4%ea%b0%92%eb%b6%84%ed%95%b4%28SVD%29&amp;url=https%3a%2f%2fsliceofdata.app%2fposts%2fsvd%2f&amp;hashtags=linear-algebra">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share 수학을 까먹은 사람을 위한 특이값분해(SVD) on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsliceofdata.app%2fposts%2fsvd%2f&amp;title=%ec%88%98%ed%95%99%ec%9d%84%20%ea%b9%8c%eb%a8%b9%ec%9d%80%20%ec%82%ac%eb%9e%8c%ec%9d%84%20%ec%9c%84%ed%95%9c%20%ed%8a%b9%ec%9d%b4%ea%b0%92%eb%b6%84%ed%95%b4%28SVD%29&amp;summary=%ec%88%98%ed%95%99%ec%9d%84%20%ea%b9%8c%eb%a8%b9%ec%9d%80%20%ec%82%ac%eb%9e%8c%ec%9d%84%20%ec%9c%84%ed%95%9c%20%ed%8a%b9%ec%9d%b4%ea%b0%92%eb%b6%84%ed%95%b4%28SVD%29&amp;source=https%3a%2f%2fsliceofdata.app%2fposts%2fsvd%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
<div class="container_disqus">
    <script src="https://giscus.app/client.js"
        data-repo="pizzathiefz/sliceofdata"
        data-repo-id="R_kgDOPsr6oQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOPsr6oc4CvOfW"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme=""
        data-lang="en"
        crossorigin="anonymous"
        async>
    </script>
</div>
<script>
    
    function getCurrentTheme() {
        
        let storedTheme = localStorage.getItem('pref-theme');
        if (storedTheme) {
            return storedTheme;
        }
        
        
        if (document.body.classList.contains('dark')) {
            return 'dark';
        }
        
        
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
        }
        
        return 'light';
    }
    
    
    function setGiscusTheme() {
        let currentTheme = getCurrentTheme();
        let giscusTheme = currentTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
        
        
        let giscusScript = document.querySelector("div.container_disqus > script");
        if (giscusScript) {
            giscusScript.setAttribute('data-theme', giscusTheme);
        }
        
        return giscusTheme;
    }
    
    
    setGiscusTheme();
    
    
    document.addEventListener('DOMContentLoaded', function() {
        let themeToggle = document.querySelector('#theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                setTimeout(() => {
                    let newTheme = getCurrentTheme();
                    let newGiscusTheme = newTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
                    
                    let giscusFrame = document.querySelector('iframe.giscus-frame');
                    if (giscusFrame) {
                        giscusFrame.contentWindow.postMessage({
                            giscus: {
                                setConfig: {
                                    theme: newGiscusTheme
                                }
                            }
                        }, 'https://giscus.app');
                    }
                }, 100);
            });
        }
    });
</script>

</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://sliceofdata.app/">sliceofdata</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
