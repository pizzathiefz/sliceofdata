<!DOCTYPE html>
<html lang="ko" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹ | sliceofdata</title>
<meta name="keywords" content="mlflow">
<meta name="description" content="ì§„ì§œ ë§‰ í•´ë³´ë©´ì„œ ì“´ ë”°ëˆë”°ëˆí•œ íŠœí† ë¦¬ì–¼">
<meta name="author" content="pizzathief">
<link rel="canonical" href="https://sliceofdata.app/posts/mlflow-tracking-tutorial/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.27cad2a1c5348b9448235a32de472a54bfb4b517f58e15427dc5a1a01bf486da.css" integrity="sha256-J8rSocU0i5RII1oy3kcqVL&#43;0tRf1jhVCfcWhoBv0hto=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sliceofdata.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sliceofdata.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sliceofdata.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="ko" href="https://sliceofdata.app/posts/mlflow-tracking-tutorial/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {
  delimiters: [
    {left: '$$', right: '$$', display: true},
    {left: '$', right: '$', display: false},
    {left: '\\(', right: '\\)', display: false},
    {left: '\\[', right: '\\]', display: true}
  ],
  throwOnError: false
});"></script>
<meta property="og:url" content="https://sliceofdata.app/posts/mlflow-tracking-tutorial/">
  <meta property="og:site_name" content="sliceofdata">
  <meta property="og:title" content="MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹">
  <meta property="og:description" content="ì§„ì§œ ë§‰ í•´ë³´ë©´ì„œ ì“´ ë”°ëˆë”°ëˆí•œ íŠœí† ë¦¬ì–¼">
  <meta property="og:locale" content="ko-KR">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2022-07-10T17:04:47+09:00">
    <meta property="article:modified_time" content="2022-07-10T17:04:47+09:00">
    <meta property="article:tag" content="Mlflow">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹">
<meta name="twitter:description" content="ì§„ì§œ ë§‰ í•´ë³´ë©´ì„œ ì“´ ë”°ëˆë”°ëˆí•œ íŠœí† ë¦¬ì–¼">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sliceofdata.app/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹",
      "item": "https://sliceofdata.app/posts/mlflow-tracking-tutorial/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹",
  "name": "MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹",
  "description": "ì§„ì§œ ë§‰ í•´ë³´ë©´ì„œ ì“´ ë”°ëˆë”°ëˆí•œ íŠœí† ë¦¬ì–¼",
  "keywords": [
    "mlflow"
  ],
  "articleBody": "ë“¤ì–´ê°€ê¸° ì „ì— ì´ ê¸€ì„ ë³´ê³  ì–»ì„ ìˆ˜ ìˆëŠ” ì •ë³´ëŠ”:\nMLflow ë¡œ ML ì‹¤í—˜ì„ ê¸°ë¡í•˜ê³  ì‹¶ì€ë° ì–´ë–»ê²Œ í•˜ëŠ”ì§€ ê°„ë‹¨í•˜ê²Œ ì•Œê³  ì‹¶ë‹¤/ë”°ë¼í•˜ê³  ì‹¶ë‹¤ Pysparkë¡œë„ ì“°ê³  ì‹¶ë‹¤ (+ Pandas UDF) ê°™ì€ ì‹¤í—˜ì„ ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ ì„œ ì§„í–‰í•˜ê³  ì‹¶ë‹¤ ì´ ê¸€ì—ì„œ ì‚¬ìš©í•œ ê²ƒì€:\nDatabricks ì»¤ë®¤ë‹ˆí‹° ë²„ì „ ë¬´ë£Œì´ê³  ì‰½ê²Œ ì¨ë³¼ ìˆ˜ ìˆì–´ì„œì´ê³ , ë¹ ë¥´ê²Œ ë”°ë¼í•  ìˆ˜ ìˆëŠ” Tracking íŠœí† ë¦¬ì–¼ì´ ì´ ê¸€ì˜ ëª©í‘œì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì»¤ë®¤ë‹ˆí‹° ë²„ì „ì˜ ê²½ìš° ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë‚˜ ë°°í¬ëŠ” ì•ˆ ë©ë‹ˆë‹¤(ëˆ ë‚´ì•¼ í•©ë‹ˆë‹¤). seabornì— ë‚´ì¥ëœ í­ê·„ ë°ì´í„°ì…‹ ìš”ì¦˜ì€ Penguin is the new iris ë¼ê³  í•˜ë”êµ°ìš”. ì €ëŠ” í­ê·„ì„ ì¢‹ì•„í•˜ê¸° ë•Œë¬¸ì— ì•„ì£¼ ë°˜ê°‘ìŠµë‹ˆë‹¤. ì•„ë¬´ë˜ë„ ê½ƒë³´ë‹¨ í­ê·„ì´ì£  ğŸ§ 1 2 3 import seaborn as sns penguins = sns.load_dataset('penguins') penguins.head(3) í­ê·„ì˜ ì„œì‹ì§€/ì¢…/ë¶€ë¦¬/ë‚ ê°œ/ëª¸ë¬´ê²Œ/ì„±ë³„ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŒ ë¶ˆëŸ¬ì˜¬ ê±° ë¶ˆëŸ¬ì˜¤ê³  ëŒ€ì• ì¶© ì²˜ë¦¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 import matplotlib.pyplot as plt import pandas as pd import mlflow from sklearn.linear_model import LogisticRegression from sklearn.model_selection import train_test_split from sklearn.preprocessing import StandardScaler from sklearn.preprocessing import LabelEncoder from sklearn.metrics import roc_auc_score, plot_roc_curve, confusion_matrix penguins = penguins.dropna(axis=0, how = 'any') le = LabelEncoder() penguins['species_encoded']= le.fit_transform(penguins['species']) penguins['island_encoded']= le.fit_transform(penguins['island']) penguins['sex_encoded']= le.fit_transform(penguins['sex']) MLflow Tracking ê¸°ë³¸ â›³ ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ìˆ˜ì»·ì¸ì§€ ì•”ì»·ì¸ì§€ ì˜ˆì¸¡\ní•™ìŠµ/í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ìƒì„± 1 2 3 4 5 6 7 features=['bill_length_mm', 'bill_depth_mm','flipper_length_mm', 'body_mass_g','island_encoded', 'species_encoded'] X = penguins[features] y = penguins['sex_encoded'] x_train, x_test, y_train, y_test = train_test_split(X, y, test_size = 0.2) sc = StandardScaler() scaled_x_train = sc.fit_transform(x_train) scaled_x_test = sc.transform(x_test) ì²«ë²ˆì§¸ë¡œ 3ê°€ì§€ë¥¼ ë¡œê¹…í•´ë³¼ ê²ë‹ˆë‹¤. ëª¨ë¸ì˜ í‰ê°€ ì§€í‘œ â†’ mlflow.log_metric í•™ìŠµ ì •í™•ë„, í‰ê°€ ì •í™•ë„, AUC í…ŒìŠ¤íŠ¸ ê²°ê³¼ì™€ ê´€ë ¨ëœ í”Œë(ì´ë¯¸ì§€) â†’ mlflow.log_artifact ROC í”Œëê³¼ ì»¨í“¨ì „ ë§¤íŠ¸ë¦­ìŠ¤ íˆíŠ¸ë§µ ëª¨ë¸ ìì²´ â†’ mlflow.log_artifact ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ í•™ìŠµ ë° í‰ê°€ í•¨ìˆ˜ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 def train(model, x_train, y_train): model = model.fit(x_train, y_train) train_acc = model.score(x_train, y_train) mlflow.log_metric(\"train_acc\", train_acc) print(f\"Train Accuracy: {train_acc:.3%}\") def evaluate(model, x_test, y_test): eval_acc = model.score(x_test, y_test) preds = model.predict(x_test) auc_score = roc_auc_score(y_test, preds, multi_class='ovr') mlflow.log_metric(\"eval_acc\", eval_acc) mlflow.log_metric(\"auc_score\", auc_score) print(f\"Auc Score: {auc_score:.3%}\") print(f\"Eval Accuracy: {eval_acc:.3%}\") roc_plot = plot_roc_curve(model, x_test, y_test, name = 'ROC Curve') plt.savefig(\"roc_plot.png\") plt.show() plt.clf() conf_matrix = confusion_matrix(y_test, preds) ax = sns.heatmap(conf_matrix, annot=True, fmt='g') plt.title('Confusion Matrix') plt.savefig('conf_matrix.png') mlflow.log_artifact(\"roc_plot.png\") mlflow.log_artifact(\"conf_matrix.png\") ì´ì œ ì‹¤ì œ ëª¨ë¸ì„ í›ˆë ¨/í‰ê°€í•´ë³´ëŠ”ë°, ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ Experiment ì•ˆì—ì„œ ì—¬ëŸ¬ ë²ˆ runì„ ëŒë¦´ ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ mlflow.set_experiment ë¡œ í•˜ë‚˜ì˜ ì‹¤í—˜ì´ë‹¤ ë¼ê³  ì„¸íŒ…í•´ì¤€ ë‹¤ìŒ mlflow.start_run ìœ¼ë¡œ ì´ë²ˆ ì‹¤í–‰ì„ ì‹œì‘í•©ë‹ˆë‹¤. with ë¬¸ ì•ˆì—ì„œ í•™ìŠµê³¼ í‰ê°€ê°€ ì´ë£¨ì–´ì§€ë©´ ë©ë‹ˆë‹¤! 1 2 3 4 5 6 7 8 model = LogisticRegression() mlflow.set_experiment(\"/Users/your_id/penguin_logistic_regression\") with mlflow.start_run(): train(model, scaled_x_train, y_train) evaluate(model, scaled_x_test, y_test) mlflow.sklearn.log_model(model, \"logistic_regression\") print(\"Model run: \", mlflow.active_run().info.run_uuid) mlflow.end_run() ì €ì¥ëœ ê±¸ í™•ì¸í•˜ê³  ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸° ì ì €ì¥í•œ ê±´ ì–´ë””ì„œ ë³´ë‚˜ìš”? Databricksë¥¼ ì‚¬ìš©í•œë‹¤ë©´ 3ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì €ì¥ëœ ì‹¤í—˜ ê²°ê³¼ uiì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\në§¨ ì¢Œì¸¡ì— Experiments íƒ­\në‚´ê°€ ì‹¤í—˜ ì„¸íŒ… ë•Œ ì§€ì •í•œ ê²½ë¡œì˜ (ì½”ë“œìƒ Users/your_id/ ~ ) ë””ë ‰í† ë¦¬ì—\nrunì„ ì‹¤í–‰í•œ ë…¸íŠ¸ë¶ ì…€ í•˜ë‹¨ì— ë§í¬ë„ ìƒê²¨ ìˆìŒ (ì‚¬ì‹¤ ì´ê²Œ ì œì¼ ì‰¬ì›Œìš”.)\nê·¸ëŸ¬ë©´ ìš°ë¦¬ëŠ” ì´ëŸ° í™”ë©´ë“¤ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.\nì‹¤í—˜ì˜ ì „ì²´ ì‹¤í–‰ë“¤ì„ ë³¼ ìˆ˜ ìˆê³ \níŠ¹ì • ì‹¤í–‰ì˜ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆê³ \nìš°ë¦¬ê°€ ì €ì¥í•œ Metrics 3ê°œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nArtifactsì—ëŠ” ëª¨ë¸ê³¼ í”Œëë„ ì˜ ì €ì¥ëœ ê²ƒ ê°™ìŠµë‹ˆë‹¤.\nì €ì¥í•œ ëª¨ë¸ì€ ì–´ë–»ê²Œ ë¶ˆëŸ¬ì˜¬ê¹Œìš”?\nmlflow.sklearn.load_model()ì„ ì“°ë©´ ê°„ë‹¨í•˜ê²Œ ì €ì¥ëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ì„œ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°ìš”. ëª¨ë¸ ê²½ë¡œë¥¼ ë”°ë¡œ ì €ì¥í•´ë‘ì§€ ì•Šì•˜ë‹¤ë©´ ì € ìœ„ì˜ í™”ë©´ì—ì„œ ëª¨ë¸ì„ ëˆ„ë¥¸ ë‹¤ìŒ Full Pathë¥¼ ë² ê»´ì˜¤ë©´ ë©ë‹ˆë‹¤. í”Œëì„ ë¶ˆëŸ¬ì˜¬ ë•Œë„ ë§ˆì°¬ê°€ì§€ê³ ìš”. 1 2 loaded_model = mlflow.sklearn.load_model(\"dbfs:/databricks/mlflow-tracking/3683903273715082/18e2bcc166cf4e259fb45944295208a3/artifacts/logistic_regression\") loaded_model.score(scaled_x_test, y_test) ì ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ë©´, ì•„ê¹Œ ì‹¤í–‰í•  ë•Œì™€ ë™ì¼í•œ ì ìˆ˜ë¥¼ í™•ì¸í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. íŒŒë¼ë¯¸í„° ì„œì¹˜ â›³ ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ëª¸ë¬´ê²Œ ì˜ˆì¸¡, ê·¼ë° íŒŒë¼ë¯¸í„°ë¥¼ ê·¸ë¦¬ë“œ ì„œì¹˜ í•´ì„œ ìµœì ì˜ ëª¨ë¸ì„ ì°¾ê³  ì‹¶ë‹¤.\në‹¤ì‹œ XY ë§Œë“¤ê¸°, í•„ìš”í•œ ê±° ë¶ˆëŸ¬ì˜¤ê¸° 1 2 3 4 5 6 7 8 from sklearn.linear_model import LinearRegression, Ridge, Lasso from sklearn.metrics import mean_squared_error from sklearn.model_selection import GridSearchCV features=['bill_length_mm', 'bill_depth_mm','flipper_length_mm','sex_encoded','species_encoded','island_encoded'] X = penguins[features].values y = penguins['body_mass_g'].values MLflowë¡œ metricsì™€ artifacts ë¿ ì•„ë‹ˆë¼ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë„ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œì„œì¹˜ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤. ëŒ€ìƒì€ ë¦¿ì§€ íšŒê·€ì˜ alpha ê°’ì…ë‹ˆë‹¤. ì‚¬ì‹¤ ì•„ê¹Œì²˜ëŸ¼ ëª…ì‹œì ìœ¼ë¡œ mlflow.log_parameter() í•´ì¤„ ìˆ˜ë„ ìˆëŠ”ë°ìš”. ì´ë²ˆì—” í•˜ë‚˜í•˜ë‚˜ ëª…ì‹œí•´ì£¼ì§€ ì•Šì•„ë„ ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ ë§ì€ ì •ë³´ë¥¼ ê¸°ë¡í•´ì£¼ëŠ” sklearn.autolog() ë¥¼ ì¨ë³´ê² ìŠµë‹ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 mlflow.sklearn.autolog() parameters = {'alpha':[0.05, 0.1, 0.5, 1, 2, 5]} model = Ridge() ridge_reg = GridSearchCV(model, parameters, scoring='neg_mean_squared_error',cv=5) mlflow.set_experiment(\"/Users/your_id/penguin_ridge_regression\") with mlflow.start_run() as run: ridge_reg.fit(X, y) mlflow.end_run() ì´ë ‡ê²Œ í•œë²ˆì˜ ì‹¤í–‰ì— ì œê°€ ì§€ì •í•œ íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œë§Œí¼ì˜ í•™ìŠµì´ ì´ë£¨ì–´ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. autolog ê¸°ëŠ¥ìœ¼ë¡œ ì €ì¥í•  ë©”íŠ¸ë¦­, íŒŒë¼ë¯¸í„°ë¥¼ ë”°ë¡œ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ ì´ë ‡ê²Œ ê¸°ë¡í•´ì¤ë‹ˆë‹¤.\nìµœì¢…ì ìœ¼ë¡œëŠ” best estimator ëª¨ë¸ì´ ì €ì¥ë©ë‹ˆë‹¤. cv resultsë„ ë”°ë¡œ í™•ì¸í•  ìˆ˜ ìˆê³ ìš”.\nPyspark ver. â›³ ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ì•„ë¸ë¦¬ì¸ì§€ ì  íˆ¬ì¸ì§€ í„±ëˆì¸ì§€ ì˜ˆì¸¡, ê·¼ë° pyspark ë¡œ í•˜ê³  ì‹¶ë‹¤.\nìš°ì„  ìŠ¤íŒŒí¬ DFë¡œ ë³€ê²½í•˜ê³  í•„ìš”í•œ ê²ƒë“¤ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤. 1 2 3 4 from pyspark.ml.feature import VectorAssembler from pyspark.ml.classification import LogisticRegression penguins_sdf = spark.createDataFrame(penguins) VectorAssemblerë¡œ í”¼ì³ë“¤ì„ ëª¨ì•„ì£¼ëŠ” ë¶€ë¶„ ë¹¼ê³  ë‚˜ë¨¸ì§€ëŠ” ì‚¬ì‹¤ ì´ì „ê³¼ ê±°ì˜ ë˜‘ê°™ìŠµë‹ˆë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 features = ['bill_length_mm', 'bill_depth_mm','flipper_length_mm', 'body_mass_g','island_encoded', 'sex_encoded'] va = VectorAssembler(inputCols = features, outputCol = 'features') data = penguins_sdf.select(F.col('species_encoded').alias('label'), *feature_list) trainData, testData = data.randomSplit([0.8, 0.2]) trainData = va.transform(trainData) testData = va.transform(testData) def train(model, train_data): model = model.fit(train_data) trainingSummary = model.summary mlflow.log_metric(\"train_acc\", trainingSummary.accuracy) print(\"Training Accuracy: \", trainingSummary.accuracy) return model def evaluate(model, test_data): evaluationSummary = model.evaluate(test_data) mlflow.log_metric(\"eval_acc\", evaluationSummary.accuracy) print(\"Evaluation Accuracy: \", evaluationSummary.accuracy) lr = LogisticRegression(featuresCol = 'features', labelCol = 'label', maxIter = 10) mlflow.set_experiment('/Users/your_id/penguin_logistic_regression_pyspark') with mlflow.start_run(): lr = train(lr, trainData) evaluate(lr, testData) mlflow.spark.log_model(lr, \"logistic_regression_pyspark\") mlflow.end_run() ì˜¬?\nëª¨ë¸ ë¡œê¹… ê²°ê³¼ sparkml ëª¨ë¸ì´ ì˜ ì €ì¥ëœ ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°™ì€ ì‹¤í—˜ì¸ë° ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ ì„œ í• ë˜ â›³ ë¼ë²¨ì„ ì“°ì§€ ì•Šê³  í´ëŸ¬ìŠ¤í„°ë§ì„ í•  ê±´ë° íŒŒë¼ë¯¸í„°ë¥¼ ì‹¤í—˜í•´ë³´ê³  ì‹¶ë‹¤. ê·¼ë° ë°ì´í„°ì— ë‚˜ì˜¤ëŠ” ì„¬ì´ 3ê°œì¸ë° ì„¬ë§ˆë‹¤ ë”± ë§ëŠ” íŒŒë¼ë¯¸í„°ê°€ ë‹¤ë¥¼ ê²ƒ ê°™ì•„ì„œ ì„¬ ë³„ë¡œ ë‚˜ëˆ ì„œ í•˜ê³  ì‹¶ë‹¤.\n(TMI) ì‚¬ì‹¤ ì´ê²Œ ì œê°€ MLflowë¥¼ ì¨ì„œ í•´ë³´ê³  ì‹¶ì—ˆë˜ íƒœìŠ¤í¬ì™€ ì§ì ‘ì ìœ¼ë¡œ ì—°ê´€ì´ ìˆëŠ” ì° ì° ëª©ì ì…ë‹ˆë‹¤. ì¼ë‹¨ ì–´ë–»ê²Œ í•  ê±´ì§€ ì„¤ëª…ì€ ì´ë ‡ìŠµë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ë§ë„ í•´ë„ ë¼? : ì‚¬ì‹¤ ì²˜ìŒì— ë‚¨ì˜ ì½”ë“œë¥¼ ë³µë¶™í•˜ê³  ì‹¶ì€ ê°•ë ¬í•œ í¬ë§ì‚¬í•­ì´ ìˆì—ˆëŠ”ë° ì•ˆíƒ€ê¹ê²Œë„ í´ëŸ¬ìŠ¤í„°ë§ mlflow ì¹˜ë©´ ì•„ë¬´ê²ƒë„ ì•ˆ ë‚˜ì˜µë‹ˆë‹¤. í•˜ì§€ë§Œ ì•ˆ ë  ê±´ ë”±íˆ ì—†ëŠ” ê²Œ ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ë„ ì–¼ë§ˆë“ ì§€ ë¡œê¹…í•  ìˆ˜ ìˆê³  í´ëŸ¬ìŠ¤í„°ë§ë„ í‰ê°€ì§€í‘œë“¤ì´ ë§ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë‚´ê°€ ì“°ê³  ì‹¶ì€ ì•Œê³ ë¦¬ì¦˜ì´ sparkmlì— ì—†ëŠ”ë° ì–´ë–¡í•´? : ê·¸ëŸ¼ ê·¸ëƒ¥ UDF ì“°ê³  ê·¸ ì•ˆì—ì„œ mlflow run í•˜ë©´ ë©ë‹ˆë‹¤. ê·¸ë£¹ë³„ë¡œ íŒŒë¼ë¯¸í„° ì‹¤í—˜ì€? : groupBy ë¡œ pandas UDFì„ ì“°ë©´ì„œ mlflow runì„ í•˜ëŠ”ë°, nested run ì„ í•˜ë©´ ë©ë‹ˆë‹¤. ì¦‰ í•˜ë‚˜ì˜ ì„¬ (ì˜ˆë¥¼ ë“¤ë©´ Biscoe ì„¬)ì—ì„œì˜ ì‹¤í–‰ì´ parent runì´ ë˜ê³ , íŒŒë¼ë¯¸í„°ê°’ì´ 0.1ì¼ë•Œì˜ runì´ child runì´ ë˜ë„ë¡ í•©ë‹ˆë‹¤. ë§ì´ ê¸¸ì—ˆìœ¼ë¯€ë¡œ ì½”ë“œë¡œ ë³´ì—¬ë“œë¦¬ë©´ (í•˜ì§€ë§Œ ì½”ë“œê°€ ë” ê¹€) Pandas UDFë¥¼ ì‘ì„±í•œë‹¤. ì´ ì•ˆì—ì„œëŠ” í­ê·„ì´ ì„œì‹í•˜ëŠ” ì„¬ ë³„ë¡œ í´ëŸ¬ìŠ¤í„°ë§(DBSCAN)ì„ ìˆ˜í–‰í•˜ëŠ”ë° ì´ë•Œ MLflow run ì•ˆì—ì„œ ì£¼ì–´ì§„ íŒŒë¼ë¯¸í„° (eps ê°’) ìˆœì„œëŒ€ë¡œ ìˆ˜í–‰í•˜ë©´ì„œ ë¡œê¹…í•œë‹¤. ì—¬ëŸ¬ê°€ì§€ ì»¤ìŠ¤í…€ ì§€í‘œë¥¼ ë¡œê¹…í•œë‹¤. sklearnì´ ì œê³µí•˜ëŠ” í´ëŸ¬ìŠ¤í„°ë§ í‰ê°€ ì§€í‘œë“¤ê³¼ S-Dbw í‰ê°€ì§€í‘œëŠ” ì•„ë‹ˆì§€ë§Œ ë§Œë“¤ì–´ì§„ í´ëŸ¬ìŠ¤í„°ì˜ ê°œìˆ˜ì™€ ë…¸ì´ì¦ˆê°€ ì•„ë‹Œ í´ëŸ¬ìŠ¤í„°ë¡œ ë¶„ë¥˜ëœ ë°ì´í„°ì˜ ê°œìˆ˜ë„ ê¶ê¸ˆí•˜ë‹ˆê¹Œ ë¡œê¹…í•œë‹¤. ê° ì‹¤í—˜ì˜ ê²°ê³¼ë¥¼ ë‹´ì€ ìŠ¤íŒŒí¬ ë°ì´í„°í”„ë ˆì„ì„ ë¦¬í„´í•˜ë„ë¡ í•œë‹¤. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 from pyspark.sql.functions import pandas_udf, PandasUDFType from sklearn.cluster import DBSCAN from sklearn.metrics import silhouette_score, calinski_harabasz_score, davies_bouldin_score from s_dbw import S_Dbw return_schema = T.StructType([ T.StructField('island', T.StringType()), T.StructField('eps', T.FloatType()), T.StructField('silhouette', T.FloatType()), T.StructField('calinski-harabasz', T.FloatType()), T.StructField('davies-bouldin', T.FloatType()), T.StructField('s-dbw', T.FloatType()), T.StructField('n_clusters', T.IntegerType()), T.StructField('n_clustered_records', T.IntegerType()), T.StructField('model_path', T.StringType()) ]) def clustering(pdf: pd.DataFrame) -\u003e pd.DataFrame: island = pdf['island'].iloc[0] run_id = pdf['run_id'].iloc[0] feature_list = ['bill_length_mm', 'bill_depth_mm','flipper_length_mm', 'body_mass_g'] X = pdf[feature_list].values scaler = StandardScaler() X_scaled = scaler.fit_transform(X) n_clusters_list = [] n_clustered_records_list = [] slh_list = [] island_list = [] model_path_list = [] for eps_val in eps_list: island_list.append(island) with mlflow.start_run(run_id=run_id): with mlflow.start_run(run_name=str(island)+'-eps'+str(eps_val), nested=True) as run: mlflow.log_param(\"eps\", eps_val) model = DBSCAN(eps=eps_val, min_samples=3) model.fit(X_scaled) labels = model.labels_ num_labels = len(set(labels[labels\u003e=0])) if num_labels -1 \u003e= 1 : clustered_label = labels[labels\u003e=0] clustered_data = X[np.where(labels\u003e=0)[0]] clustered_data_cnt = len(clustered_data) #scores slh = silhouette_score(clustered_data, clustered_label) ch = calinski_harabasz_score(clustered_data, clustered_label) db = davies_bouldin_score(clustered_data, clustered_label) s_dbw = S_Dbw(X_scaled, labels, alg_noise='filter') else: slh = -1 ch = -1 db = -1 s_dbw = -1 clustered_data_cnt = 0 mlflow.sklearn.log_model(model, str(island)+str('-')+str(eps_val)) mlflow.log_metric(\"silhouette\", slh) mlflow.log_metric(\"calinski-harabasz\", ch) mlflow.log_metric(\"davies-bouldin\", db) mlflow.log_metric(\"s-dbw\", s_dbw) mlflow.log_metric(\"n_clusters\", num_labels) mlflow.log_metric(\"n_clustered_records\", clustered_data_cnt) artifact_uri = f\"runs:/{run.info.run_id}/{island}\" + str(eps_val) model_path_list.append(artifact_uri) n_clustered_records_list.append(clustered_data_cnt) n_clusters_list.append(num_labels) slh_list.append(slh) ch_list.append(ch) db_list.append(db) sdbw_list.append(s_dbw) returnDF = pd.DataFrame({'island':island_list, 'eps':eps_list, 'silhouette': slh_list, 'calinski-harabasz':ch_list, 'davies-bouldin': db_list, 's-dbw':sdbw_list, 'n_clusters':n_clusters_list, 'n_clustered_records':n_clusters_list, 'model_path':model_path_list}) return returnDF ë©”ì¸ ë¶€ë¶„ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. ë¦¬í„´ëœ ë°ì´í„°í”„ë ˆì„ì„ í†µí•´ uië¡œ ë³´ì§€ ì•Šì•„ë„ ì‹¤í—˜ ê²°ê³¼ë“¤ê³¼ ëª¨ë¸ ê²½ë¡œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 1 2 3 4 5 6 7 8 9 with mlflow.start_run(run_name=\"ì„¬ ë³„ í´ëŸ¬ìŠ¤í„°ë§\") as run: run_id = run.info.run_uuid eps_list = [0.1, 0.2, 0.3, 0.5, 0.7, 0.9, 1.1, 1.3, 1.5] modelDF = (penguins_sdf .withColumn(\"run_id\", F.lit(run_id)) .groupby(\"island\").applyInPandas(clustering, schema = return_schema) ) display(modelDF) ë¬¼ë¡  Experiments íƒ­ì—ì„œë„ ì´ì „ê³¼ ë˜‘ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆê³ ìš”.\nì–´ë–¤ í‰ê°€ì§€í‘œë¥¼ ì‚¬ìš©í•˜ëŠëƒì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ, ë§Œì•½ s-dbwê°€ ë‚®ì€ ê±¸ ê³ ë¥´ê² ë‹¤ë©´ Biscoeì—ì„œì˜ epsê°’ê³¼ Dreamì—ì„œì˜ eps ê°’ì€ ë‹¤ë¥´ê²Œ ì„¤ì •ë˜ì–´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.\nê°™ì€ ì„¬ì—ì„œ íŒŒë¼ë¯¸í„° ê°’ì— ë”°ë¥¸ í‰ê°€ì§€í‘œ ê°’ì„ ë¹„êµí•´ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¸Œë¦­ìŠ¤ì˜ ê¸°ë³¸ì ì¸ í”Œë ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë´¤ìŠµë‹ˆë‹¤.\n1 display(modelDF.filter(F.col('island')=='Dream').orderBy('eps')) ì°¸ê³ í•œ ì±…ê³¼ ê¸€ MLFlowë¥¼ í™œìš©í•œ MLOps (ì‚¬ì¡±: ëª‡ë‹¬ì „ì— ì¶©ë™êµ¬ë§¤í•œ ì±…ì¸ë° ë¬µí˜€ë‘ê³  ìˆë‹¤ê°€ ì´ë²ˆì— ê¸‰í•˜ê²Œ ì°¸ê³ í•˜ê¸°ëŠ” ë‚˜ì˜ì§€ ì•Šì•˜ìœ¼ë‚˜ ë‘ê»˜ì— ë¹„í•´ ë‚´ìš©ì´ ì—„ì²­ í’ë¶€í•˜ì§„ ì•ŠìŒ. ê·¸ëƒ¥ êµ¬ê¸€ë§í•´ì„œ ë‚˜ì˜¤ëŠ” ë¬¸ì„œë“¤ì´ ë‚˜ì„ ìˆ˜ë„) Manage and Scale Machine Learning Models for IoT Devices ",
  "wordCount" : "1494",
  "inLanguage": "ko",
  "datePublished": "2022-07-10T17:04:47+09:00",
  "dateModified": "2022-07-10T17:04:47+09:00",
  "author":{
    "@type": "Person",
    "name": "pizzathief"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sliceofdata.app/posts/mlflow-tracking-tutorial/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sliceofdata",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sliceofdata.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sliceofdata.app/" accesskey="h" title="slice.of.data (Alt + H)">
                <img src="https://sliceofdata.app/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">slice.of.data</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://sliceofdata.app/en/" title="English"
                            aria-label="English">En</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sliceofdata.app/archives/" title="posts">
                    <span>posts</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/subscribe" title="subscribe">
                    <span>subscribe</span>
                </a>
            </li>
            <li>
                <a href="https://pizzathief.pages.dev/" title="notes">
                    <span>notes</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹
    </h1>
    <div class="post-meta"><span title='2022-07-10 17:04:47 +0900 KST'>2022-07-10</span>&nbsp;Â·&nbsp;8 min&nbsp;Â·&nbsp;pizzathief&nbsp;|&nbsp;<a href="https://github.com/pizzathiefz/sliceofdata/blob/main/content/posts/mlflow-tracking-tutorial/index.ko.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#ë“¤ì–´ê°€ê¸°-ì „ì—">ë“¤ì–´ê°€ê¸° ì „ì—</a></li>
    <li><a href="#mlflow-tracking-ê¸°ë³¸">MLflow Tracking ê¸°ë³¸</a>
      <ul>
        <li><a href="#ì €ì¥ëœ-ê±¸-í™•ì¸í•˜ê³ -ëª¨ë¸-ë¶ˆëŸ¬ì˜¤ê¸°">ì €ì¥ëœ ê±¸ í™•ì¸í•˜ê³  ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°</a></li>
      </ul>
    </li>
    <li><a href="#íŒŒë¼ë¯¸í„°-ì„œì¹˜">íŒŒë¼ë¯¸í„° ì„œì¹˜</a></li>
    <li><a href="#pyspark-ver">Pyspark ver.</a></li>
    <li><a href="#ê°™ì€-ì‹¤í—˜ì¸ë°-ê·¸ë£¹ë³„ë¡œ-ë‚˜ëˆ ì„œ-í• ë˜">ê°™ì€ ì‹¤í—˜ì¸ë° ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ ì„œ í• ë˜</a></li>
    <li><a href="#ì°¸ê³ í•œ-ì±…ê³¼-ê¸€">ì°¸ê³ í•œ ì±…ê³¼ ê¸€</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="ë“¤ì–´ê°€ê¸°-ì „ì—">ë“¤ì–´ê°€ê¸° ì „ì—<a hidden class="anchor" aria-hidden="true" href="#ë“¤ì–´ê°€ê¸°-ì „ì—">#</a></h2>
<p>ì´ ê¸€ì„ ë³´ê³  ì–»ì„ ìˆ˜ ìˆëŠ” ì •ë³´ëŠ”:</p>
<ul>
<li>MLflow ë¡œ ML ì‹¤í—˜ì„ ê¸°ë¡í•˜ê³  ì‹¶ì€ë° ì–´ë–»ê²Œ í•˜ëŠ”ì§€ ê°„ë‹¨í•˜ê²Œ ì•Œê³  ì‹¶ë‹¤/ë”°ë¼í•˜ê³  ì‹¶ë‹¤
<ul>
<li>Pysparkë¡œë„ ì“°ê³  ì‹¶ë‹¤ (+ Pandas UDF)</li>
<li>ê°™ì€ ì‹¤í—˜ì„ ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ ì„œ ì§„í–‰í•˜ê³  ì‹¶ë‹¤</li>
</ul>
</li>
</ul>
<p>ì´ ê¸€ì—ì„œ ì‚¬ìš©í•œ ê²ƒì€:</p>
<ul>
<li><strong>Databricks ì»¤ë®¤ë‹ˆí‹° ë²„ì „</strong>
<ul>
<li>ë¬´ë£Œì´ê³  ì‰½ê²Œ ì¨ë³¼ ìˆ˜ ìˆì–´ì„œì´ê³ , ë¹ ë¥´ê²Œ ë”°ë¼í•  ìˆ˜ ìˆëŠ” Tracking íŠœí† ë¦¬ì–¼ì´ ì´ ê¸€ì˜ ëª©í‘œì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì»¤ë®¤ë‹ˆí‹° ë²„ì „ì˜ ê²½ìš° ëª¨ë¸ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë‚˜ ë°°í¬ëŠ” ì•ˆ ë©ë‹ˆë‹¤(ëˆ ë‚´ì•¼ í•©ë‹ˆë‹¤).</li>
</ul>
</li>
<li><strong>seabornì— ë‚´ì¥ëœ í­ê·„ ë°ì´í„°ì…‹</strong>
<ul>
<li>ìš”ì¦˜ì€ Penguin is the new iris ë¼ê³  í•˜ë”êµ°ìš”. ì €ëŠ” í­ê·„ì„ ì¢‹ì•„í•˜ê¸° ë•Œë¬¸ì— ì•„ì£¼ ë°˜ê°‘ìŠµë‹ˆë‹¤. ì•„ë¬´ë˜ë„ ê½ƒë³´ë‹¨ í­ê·„ì´ì£  ğŸ§</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">seaborn</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">sns</span>
</span></span><span style="display:flex;"><span>penguins <span style="color:#81a1c1">=</span> sns<span style="color:#81a1c1">.</span>load_dataset<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;penguins&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#81a1c1">.</span>head<span style="color:#eceff4">(</span><span style="color:#b48ead">3</span><span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/1.png#center" width="600"/> 
</figure>

<ul>
<li>í­ê·„ì˜ ì„œì‹ì§€/ì¢…/ë¶€ë¦¬/ë‚ ê°œ/ëª¸ë¬´ê²Œ/ì„±ë³„ ì •ë³´ë¥¼ í¬í•¨í•˜ê³  ìˆìŒ</li>
<li>ë¶ˆëŸ¬ì˜¬ ê±° ë¶ˆëŸ¬ì˜¤ê³  ëŒ€ì• ì¶© ì²˜ë¦¬</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">matplotlib.pyplot</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">plt</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">pandas</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">pd</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">mlflow</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.linear_model</span> <span style="color:#81a1c1;font-weight:bold">import</span> LogisticRegression
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.model_selection</span> <span style="color:#81a1c1;font-weight:bold">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.preprocessing</span> <span style="color:#81a1c1;font-weight:bold">import</span> StandardScaler
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.preprocessing</span> <span style="color:#81a1c1;font-weight:bold">import</span> LabelEncoder
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.metrics</span> <span style="color:#81a1c1;font-weight:bold">import</span> roc_auc_score<span style="color:#eceff4">,</span> plot_roc_curve<span style="color:#eceff4">,</span> confusion_matrix
</span></span><span style="display:flex;"><span>penguins <span style="color:#81a1c1">=</span> penguins<span style="color:#81a1c1">.</span>dropna<span style="color:#eceff4">(</span>axis<span style="color:#81a1c1">=</span><span style="color:#b48ead">0</span><span style="color:#eceff4">,</span> how <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;any&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>le <span style="color:#81a1c1">=</span> LabelEncoder<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species_encoded&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island_encoded&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex_encoded&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex&#39;</span><span style="color:#eceff4">])</span>
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="mlflow-tracking-ê¸°ë³¸">MLflow Tracking ê¸°ë³¸<a hidden class="anchor" aria-hidden="true" href="#mlflow-tracking-ê¸°ë³¸">#</a></h2>
<blockquote>
<p>â›³ <strong>ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ìˆ˜ì»·ì¸ì§€ ì•”ì»·ì¸ì§€ ì˜ˆì¸¡</strong></p></blockquote>
<ul>
<li>í•™ìŠµ/í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ ìƒì„±</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>features<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;bill_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;bill_depth_mm&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;flipper_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;body_mass_g&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;island_encoded&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;species_encoded&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>X <span style="color:#81a1c1">=</span> penguins<span style="color:#eceff4">[</span>features<span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>y <span style="color:#81a1c1">=</span> penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex_encoded&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>x_train<span style="color:#eceff4">,</span> x_test<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">,</span> y_test <span style="color:#81a1c1">=</span> train_test_split<span style="color:#eceff4">(</span>X<span style="color:#eceff4">,</span> y<span style="color:#eceff4">,</span> test_size <span style="color:#81a1c1">=</span> <span style="color:#b48ead">0.2</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>sc <span style="color:#81a1c1">=</span> StandardScaler<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>scaled_x_train <span style="color:#81a1c1">=</span> sc<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>x_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>scaled_x_test <span style="color:#81a1c1">=</span> sc<span style="color:#81a1c1">.</span>transform<span style="color:#eceff4">(</span>x_test<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ì²«ë²ˆì§¸ë¡œ 3ê°€ì§€ë¥¼ ë¡œê¹…í•´ë³¼ ê²ë‹ˆë‹¤.
<ol>
<li>ëª¨ë¸ì˜ í‰ê°€ ì§€í‘œ â†’ <code>mlflow.log_metric</code>
<ul>
<li>í•™ìŠµ ì •í™•ë„, í‰ê°€ ì •í™•ë„, AUC</li>
</ul>
</li>
<li>í…ŒìŠ¤íŠ¸ ê²°ê³¼ì™€ ê´€ë ¨ëœ í”Œë(ì´ë¯¸ì§€) â†’ <code>mlflow.log_artifact</code>
<ul>
<li>ROC í”Œëê³¼ ì»¨í“¨ì „ ë§¤íŠ¸ë¦­ìŠ¤ íˆíŠ¸ë§µ</li>
</ul>
</li>
<li>ëª¨ë¸ ìì²´ â†’ <code>mlflow.log_artifact</code></li>
</ol>
</li>
<li>ë”°ë¼ì„œ ë‹¤ìŒê³¼ ê°™ì´ í•™ìŠµ ë° í‰ê°€ í•¨ìˆ˜ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> x_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>  model <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>x_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  train_acc <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>score<span style="color:#eceff4">(</span>x_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;train_acc&#34;</span><span style="color:#eceff4">,</span> train_acc<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#34;Train Accuracy: </span><span style="color:#a3be8c">{</span>train_acc<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.3%</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> x_test<span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>  eval_acc <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>score<span style="color:#eceff4">(</span>x_test<span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  preds <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>x_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  auc_score <span style="color:#81a1c1">=</span> roc_auc_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> preds<span style="color:#eceff4">,</span> multi_class<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;ovr&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;eval_acc&#34;</span><span style="color:#eceff4">,</span> eval_acc<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;auc_score&#34;</span><span style="color:#eceff4">,</span> auc_score<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#34;Auc Score: </span><span style="color:#a3be8c">{</span>auc_score<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.3%</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#34;Eval Accuracy: </span><span style="color:#a3be8c">{</span>eval_acc<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.3%</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  roc_plot <span style="color:#81a1c1">=</span> plot_roc_curve<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> x_test<span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> name <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;ROC Curve&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  plt<span style="color:#81a1c1">.</span>savefig<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;roc_plot.png&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  plt<span style="color:#81a1c1">.</span>show<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>  plt<span style="color:#81a1c1">.</span>clf<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  conf_matrix <span style="color:#81a1c1">=</span> confusion_matrix<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> preds<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  ax <span style="color:#81a1c1">=</span> sns<span style="color:#81a1c1">.</span>heatmap<span style="color:#eceff4">(</span>conf_matrix<span style="color:#eceff4">,</span> annot<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">,</span> fmt<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;g&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  plt<span style="color:#81a1c1">.</span>title<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;Confusion Matrix&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  plt<span style="color:#81a1c1">.</span>savefig<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;conf_matrix.png&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_artifact<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;roc_plot.png&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_artifact<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;conf_matrix.png&#34;</span><span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ì´ì œ ì‹¤ì œ ëª¨ë¸ì„ í›ˆë ¨/í‰ê°€í•´ë³´ëŠ”ë°, ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ Experiment ì•ˆì—ì„œ ì—¬ëŸ¬ ë²ˆ runì„ ëŒë¦´ ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¼ê³  ë³´ë©´ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ  <code>mlflow.set_experiment</code> ë¡œ í•˜ë‚˜ì˜ ì‹¤í—˜ì´ë‹¤ ë¼ê³  ì„¸íŒ…í•´ì¤€ ë‹¤ìŒ <code>mlflow.start_run</code> ìœ¼ë¡œ ì´ë²ˆ ì‹¤í–‰ì„ ì‹œì‘í•©ë‹ˆë‹¤. with ë¬¸ ì•ˆì—ì„œ í•™ìŠµê³¼ í‰ê°€ê°€ ì´ë£¨ì–´ì§€ë©´ ë©ë‹ˆë‹¤!</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>model <span style="color:#81a1c1">=</span> LogisticRegression<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>set_experiment<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;/Users/your_id/penguin_logistic_regression&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">():</span>
</span></span><span style="display:flex;"><span>  train<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> scaled_x_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  evaluate<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> scaled_x_test<span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>sklearn<span style="color:#81a1c1">.</span>log_model<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#34;logistic_regression&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Model run: &#34;</span><span style="color:#eceff4">,</span> mlflow<span style="color:#81a1c1">.</span>active_run<span style="color:#eceff4">()</span><span style="color:#81a1c1">.</span>info<span style="color:#81a1c1">.</span>run_uuid<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>end_run<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/2.png#center" width="450"/> 
</figure>

<br>
<h3 id="ì €ì¥ëœ-ê±¸-í™•ì¸í•˜ê³ -ëª¨ë¸-ë¶ˆëŸ¬ì˜¤ê¸°">ì €ì¥ëœ ê±¸ í™•ì¸í•˜ê³  ëª¨ë¸ ë¶ˆëŸ¬ì˜¤ê¸°<a hidden class="anchor" aria-hidden="true" href="#ì €ì¥ëœ-ê±¸-í™•ì¸í•˜ê³ -ëª¨ë¸-ë¶ˆëŸ¬ì˜¤ê¸°">#</a></h3>
<ul>
<li>
<p>ì ì €ì¥í•œ ê±´ ì–´ë””ì„œ ë³´ë‚˜ìš”? Databricksë¥¼ ì‚¬ìš©í•œë‹¤ë©´ 3ê°€ì§€ ë°©ë²•ìœ¼ë¡œ ì €ì¥ëœ ì‹¤í—˜ ê²°ê³¼ uiì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<ul>
<li>
<p>ë§¨ ì¢Œì¸¡ì— Experiments íƒ­</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/3.png#center" width="300"/> 
</figure>
</li>
</ul>
</li>
<li>
<p>ë‚´ê°€ ì‹¤í—˜ ì„¸íŒ… ë•Œ ì§€ì •í•œ ê²½ë¡œì˜ (ì½”ë“œìƒ <code>Users/your_id/</code> ~ ) ë””ë ‰í† ë¦¬ì—</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/4.png#center" width="300"/> 
</figure>
</li>
</ul>
</li>
<li>
<p>runì„ ì‹¤í–‰í•œ ë…¸íŠ¸ë¶ ì…€ í•˜ë‹¨ì— ë§í¬ë„ ìƒê²¨ ìˆìŒ (ì‚¬ì‹¤ ì´ê²Œ ì œì¼ ì‰¬ì›Œìš”.)</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/5.png#center" width="400"/> 
</figure>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ê·¸ëŸ¬ë©´ ìš°ë¦¬ëŠ” ì´ëŸ° í™”ë©´ë“¤ì„ ë§Œë‚˜ê²Œ ë©ë‹ˆë‹¤.</p>
<ul>
<li>
<p>ì‹¤í—˜ì˜ ì „ì²´ ì‹¤í–‰ë“¤ì„ ë³¼ ìˆ˜ ìˆê³ </p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/6.png#center" width="600"/> 
</figure>
</li>
</ul>
</li>
<li>
<p>íŠ¹ì • ì‹¤í–‰ì˜ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆê³ </p>
<ul>
<li>
<figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/7.png#center" width="500"/> 
</figure>

</li>
<li>
<p>ìš°ë¦¬ê°€ ì €ì¥í•œ Metrics 3ê°œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>Artifactsì—ëŠ” ëª¨ë¸ê³¼ í”Œëë„ ì˜ ì €ì¥ëœ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/8.png#center" width="600"/> 
</figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>ì €ì¥í•œ ëª¨ë¸ì€ ì–´ë–»ê²Œ ë¶ˆëŸ¬ì˜¬ê¹Œìš”?</p>
<ul>
<li><code>mlflow.sklearn.load_model()</code>ì„ ì“°ë©´ ê°„ë‹¨í•˜ê²Œ ì €ì¥ëœ ëª¨ë¸ì„ ë¶ˆëŸ¬ì™€ì„œ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°ìš”. ëª¨ë¸ ê²½ë¡œë¥¼ ë”°ë¡œ ì €ì¥í•´ë‘ì§€ ì•Šì•˜ë‹¤ë©´ ì € ìœ„ì˜ í™”ë©´ì—ì„œ  ëª¨ë¸ì„ ëˆ„ë¥¸ ë‹¤ìŒ Full Pathë¥¼ ë² ê»´ì˜¤ë©´ ë©ë‹ˆë‹¤. í”Œëì„ ë¶ˆëŸ¬ì˜¬ ë•Œë„  ë§ˆì°¬ê°€ì§€ê³ ìš”.</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>loaded_model <span style="color:#81a1c1">=</span> mlflow<span style="color:#81a1c1">.</span>sklearn<span style="color:#81a1c1">.</span>load_model<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;dbfs:/databricks/mlflow-tracking/3683903273715082/18e2bcc166cf4e259fb45944295208a3/artifacts/logistic_regression&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>loaded_model<span style="color:#81a1c1">.</span>score<span style="color:#eceff4">(</span>scaled_x_test<span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
     <img loading="lazy" src="/posts/mlflow-tracking-tutorial/9.png#center" width="220"/> 
 </figure>

<ul>
<li>ì ìˆ˜ë¥¼ ì¶œë ¥í•´ë³´ë©´, ì•„ê¹Œ ì‹¤í–‰í•  ë•Œì™€ ë™ì¼í•œ ì ìˆ˜ë¥¼ í™•ì¸í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<br>
<h2 id="íŒŒë¼ë¯¸í„°-ì„œì¹˜">íŒŒë¼ë¯¸í„° ì„œì¹˜<a hidden class="anchor" aria-hidden="true" href="#íŒŒë¼ë¯¸í„°-ì„œì¹˜">#</a></h2>
<blockquote>
<p>â›³ <strong>ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ëª¸ë¬´ê²Œ ì˜ˆì¸¡, ê·¼ë° íŒŒë¼ë¯¸í„°ë¥¼ ê·¸ë¦¬ë“œ ì„œì¹˜ í•´ì„œ ìµœì ì˜ ëª¨ë¸ì„ ì°¾ê³  ì‹¶ë‹¤.</strong></p></blockquote>
<ul>
<li>ë‹¤ì‹œ XY ë§Œë“¤ê¸°, í•„ìš”í•œ ê±° ë¶ˆëŸ¬ì˜¤ê¸°</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.linear_model</span> <span style="color:#81a1c1;font-weight:bold">import</span> LinearRegression<span style="color:#eceff4">,</span> Ridge<span style="color:#eceff4">,</span> Lasso
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.metrics</span> <span style="color:#81a1c1;font-weight:bold">import</span> mean_squared_error
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.model_selection</span> <span style="color:#81a1c1;font-weight:bold">import</span> GridSearchCV
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>features<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;bill_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;bill_depth_mm&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;flipper_length_mm&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;sex_encoded&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;species_encoded&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;island_encoded&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>X <span style="color:#81a1c1">=</span> penguins<span style="color:#eceff4">[</span>features<span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>values
</span></span><span style="display:flex;"><span>y <span style="color:#81a1c1">=</span> penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;body_mass_g&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>values
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>MLflowë¡œ metricsì™€ artifacts ë¿ ì•„ë‹ˆë¼ ëª¨ë¸ íŒŒë¼ë¯¸í„°ë„ ê¸°ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê°„ë‹¨í•˜ê²Œ íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œì„œì¹˜ë¥¼ í•´ë³´ê² ìŠµë‹ˆë‹¤. ëŒ€ìƒì€ ë¦¿ì§€ íšŒê·€ì˜ alpha ê°’ì…ë‹ˆë‹¤.
<ul>
<li>ì‚¬ì‹¤ ì•„ê¹Œì²˜ëŸ¼ ëª…ì‹œì ìœ¼ë¡œ  <code>mlflow.log_parameter()</code> í•´ì¤„ ìˆ˜ë„ ìˆëŠ”ë°ìš”. ì´ë²ˆì—” í•˜ë‚˜í•˜ë‚˜ ëª…ì‹œí•´ì£¼ì§€ ì•Šì•„ë„ ë³´ë‹¤ ê°„ë‹¨í•˜ê²Œ ë§ì€ ì •ë³´ë¥¼ ê¸°ë¡í•´ì£¼ëŠ” <code>sklearn.autolog()</code> ë¥¼ ì¨ë³´ê² ìŠµë‹ˆë‹¤.</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>sklearn<span style="color:#81a1c1">.</span>autolog<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>parameters <span style="color:#81a1c1">=</span> <span style="color:#eceff4">{</span><span style="color:#a3be8c">&#39;alpha&#39;</span><span style="color:#eceff4">:[</span><span style="color:#b48ead">0.05</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.1</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.5</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">1</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">2</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">5</span><span style="color:#eceff4">]}</span>
</span></span><span style="display:flex;"><span>model <span style="color:#81a1c1">=</span> Ridge<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>ridge_reg <span style="color:#81a1c1">=</span> GridSearchCV<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> parameters<span style="color:#eceff4">,</span> scoring<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;neg_mean_squared_error&#39;</span><span style="color:#eceff4">,</span>cv<span style="color:#81a1c1">=</span><span style="color:#b48ead">5</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>set_experiment<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;/Users/your_id/penguin_ridge_regression&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">()</span> <span style="color:#81a1c1;font-weight:bold">as</span> run<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>  ridge_reg<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X<span style="color:#eceff4">,</span> y<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>end_run<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ì´ë ‡ê²Œ í•œë²ˆì˜ ì‹¤í–‰ì— ì œê°€ ì§€ì •í•œ íŒŒë¼ë¯¸í„° ê·¸ë¦¬ë“œë§Œí¼ì˜ í•™ìŠµì´ ì´ë£¨ì–´ì§„ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<ul>
<li>
<figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/10.png#center" width="700"/> 
</figure>

</li>
<li>
<p>autolog ê¸°ëŠ¥ìœ¼ë¡œ ì €ì¥í•  ë©”íŠ¸ë¦­, íŒŒë¼ë¯¸í„°ë¥¼ ë”°ë¡œ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ì•Œì•„ì„œ ì´ë ‡ê²Œ ê¸°ë¡í•´ì¤ë‹ˆë‹¤.</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/11.png#center" width="300"/> 
</figure>
</li>
</ul>
</li>
<li>
<p>ìµœì¢…ì ìœ¼ë¡œëŠ” best estimator ëª¨ë¸ì´ ì €ì¥ë©ë‹ˆë‹¤. cv resultsë„ ë”°ë¡œ í™•ì¸í•  ìˆ˜ ìˆê³ ìš”.</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/12.png#center" width="700"/> 
</figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<br>
<h2 id="pyspark-ver">Pyspark ver.<a hidden class="anchor" aria-hidden="true" href="#pyspark-ver">#</a></h2>
<blockquote>
<p>â›³ <strong>ë‚˜ë¨¸ì§€ ì •ë³´ë“¤ë¡œ ì•„ë¸ë¦¬ì¸ì§€ ì  íˆ¬ì¸ì§€ í„±ëˆì¸ì§€ ì˜ˆì¸¡, ê·¼ë° pyspark ë¡œ í•˜ê³  ì‹¶ë‹¤.</strong></p></blockquote>
<ul>
<li>ìš°ì„  ìŠ¤íŒŒí¬ DFë¡œ ë³€ê²½í•˜ê³  í•„ìš”í•œ ê²ƒë“¤ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">pyspark.ml.feature</span> <span style="color:#81a1c1;font-weight:bold">import</span> VectorAssembler
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">pyspark.ml.classification</span> <span style="color:#81a1c1;font-weight:bold">import</span> LogisticRegression
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>penguins_sdf <span style="color:#81a1c1">=</span> spark<span style="color:#81a1c1">.</span>createDataFrame<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><code>VectorAssembler</code>ë¡œ í”¼ì³ë“¤ì„ ëª¨ì•„ì£¼ëŠ” ë¶€ë¶„ ë¹¼ê³  ë‚˜ë¨¸ì§€ëŠ” ì‚¬ì‹¤ ì´ì „ê³¼ ê±°ì˜ ë˜‘ê°™ìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>features <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;bill_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;bill_depth_mm&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;flipper_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;body_mass_g&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;island_encoded&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;sex_encoded&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>va <span style="color:#81a1c1">=</span> VectorAssembler<span style="color:#eceff4">(</span>inputCols <span style="color:#81a1c1">=</span> features<span style="color:#eceff4">,</span> outputCol <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;features&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>data <span style="color:#81a1c1">=</span> penguins_sdf<span style="color:#81a1c1">.</span>select<span style="color:#eceff4">(</span>F<span style="color:#81a1c1">.</span>col<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;species_encoded&#39;</span><span style="color:#eceff4">)</span><span style="color:#81a1c1">.</span>alias<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;label&#39;</span><span style="color:#eceff4">),</span> <span style="color:#81a1c1">*</span>feature_list<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>trainData<span style="color:#eceff4">,</span> testData <span style="color:#81a1c1">=</span> data<span style="color:#81a1c1">.</span>randomSplit<span style="color:#eceff4">([</span><span style="color:#b48ead">0.8</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.2</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>trainData <span style="color:#81a1c1">=</span> va<span style="color:#81a1c1">.</span>transform<span style="color:#eceff4">(</span>trainData<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>testData <span style="color:#81a1c1">=</span> va<span style="color:#81a1c1">.</span>transform<span style="color:#eceff4">(</span>testData<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> train_data<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>  model <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>train_data<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  trainingSummary <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>summary
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;train_acc&#34;</span><span style="color:#eceff4">,</span> trainingSummary<span style="color:#81a1c1">.</span>accuracy<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Training Accuracy: &#34;</span><span style="color:#eceff4">,</span> trainingSummary<span style="color:#81a1c1">.</span>accuracy<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1;font-weight:bold">return</span> model
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> test_data<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>  evaluationSummary <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>evaluate<span style="color:#eceff4">(</span>test_data<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;eval_acc&#34;</span><span style="color:#eceff4">,</span> evaluationSummary<span style="color:#81a1c1">.</span>accuracy<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Evaluation Accuracy: &#34;</span><span style="color:#eceff4">,</span> evaluationSummary<span style="color:#81a1c1">.</span>accuracy<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>lr <span style="color:#81a1c1">=</span> LogisticRegression<span style="color:#eceff4">(</span>featuresCol <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;features&#39;</span><span style="color:#eceff4">,</span> labelCol <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">&#39;label&#39;</span><span style="color:#eceff4">,</span> maxIter <span style="color:#81a1c1">=</span> <span style="color:#b48ead">10</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>set_experiment<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;/Users/your_id/penguin_logistic_regression_pyspark&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">():</span>
</span></span><span style="display:flex;"><span>  lr <span style="color:#81a1c1">=</span> train<span style="color:#eceff4">(</span>lr<span style="color:#eceff4">,</span> trainData<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  evaluate<span style="color:#eceff4">(</span>lr<span style="color:#eceff4">,</span> testData<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>  mlflow<span style="color:#81a1c1">.</span>spark<span style="color:#81a1c1">.</span>log_model<span style="color:#eceff4">(</span>lr<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#34;logistic_regression_pyspark&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>mlflow<span style="color:#81a1c1">.</span>end_run<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/13.png#center"
         alt="ì˜¬?" width="300"/> <figcaption>
            <p>ì˜¬?</p>
        </figcaption>
</figure>

<ul>
<li>ëª¨ë¸ ë¡œê¹… ê²°ê³¼ sparkml ëª¨ë¸ì´ ì˜ ì €ì¥ëœ ê±¸ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/14.png#center" width="300"/> 
</figure>
</li>
</ul>
</li>
</ul>
<br>
<h2 id="ê°™ì€-ì‹¤í—˜ì¸ë°-ê·¸ë£¹ë³„ë¡œ-ë‚˜ëˆ ì„œ-í• ë˜">ê°™ì€ ì‹¤í—˜ì¸ë° ê·¸ë£¹ë³„ë¡œ ë‚˜ëˆ ì„œ í• ë˜<a hidden class="anchor" aria-hidden="true" href="#ê°™ì€-ì‹¤í—˜ì¸ë°-ê·¸ë£¹ë³„ë¡œ-ë‚˜ëˆ ì„œ-í• ë˜">#</a></h2>
<blockquote>
<p><strong>â›³ ë¼ë²¨ì„ ì“°ì§€ ì•Šê³  í´ëŸ¬ìŠ¤í„°ë§ì„ í•  ê±´ë° íŒŒë¼ë¯¸í„°ë¥¼ ì‹¤í—˜í•´ë³´ê³  ì‹¶ë‹¤. ê·¼ë° ë°ì´í„°ì— ë‚˜ì˜¤ëŠ” ì„¬ì´ 3ê°œì¸ë° ì„¬ë§ˆë‹¤ ë”± ë§ëŠ” íŒŒë¼ë¯¸í„°ê°€ ë‹¤ë¥¼ ê²ƒ ê°™ì•„ì„œ ì„¬ ë³„ë¡œ ë‚˜ëˆ ì„œ í•˜ê³  ì‹¶ë‹¤.</strong></p></blockquote>
<ul>
<li>(TMI) ì‚¬ì‹¤ ì´ê²Œ ì œê°€ MLflowë¥¼ ì¨ì„œ í•´ë³´ê³  ì‹¶ì—ˆë˜ íƒœìŠ¤í¬ì™€ ì§ì ‘ì ìœ¼ë¡œ ì—°ê´€ì´ ìˆëŠ” ì° ì° ëª©ì ì…ë‹ˆë‹¤.</li>
<li>ì¼ë‹¨ ì–´ë–»ê²Œ í•  ê±´ì§€ ì„¤ëª…ì€ ì´ë ‡ìŠµë‹ˆë‹¤.
<ul>
<li><strong>í´ëŸ¬ìŠ¤í„°ë§ë„ í•´ë„ ë¼?</strong> : ì‚¬ì‹¤ ì²˜ìŒì— ë‚¨ì˜ ì½”ë“œë¥¼ ë³µë¶™í•˜ê³  ì‹¶ì€ ê°•ë ¬í•œ í¬ë§ì‚¬í•­ì´ ìˆì—ˆëŠ”ë° ì•ˆíƒ€ê¹ê²Œë„ í´ëŸ¬ìŠ¤í„°ë§ mlflow ì¹˜ë©´ ì•„ë¬´ê²ƒë„ ì•ˆ ë‚˜ì˜µë‹ˆë‹¤. í•˜ì§€ë§Œ ì•ˆ ë  ê±´ ë”±íˆ ì—†ëŠ” ê²Œ ì»¤ìŠ¤í…€ ë©”íŠ¸ë¦­ë„ ì–¼ë§ˆë“ ì§€ ë¡œê¹…í•  ìˆ˜ ìˆê³  í´ëŸ¬ìŠ¤í„°ë§ë„ í‰ê°€ì§€í‘œë“¤ì´ ë§ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.</li>
<li><strong>ë‚´ê°€ ì“°ê³  ì‹¶ì€ ì•Œê³ ë¦¬ì¦˜ì´ sparkmlì— ì—†ëŠ”ë° ì–´ë–¡í•´?</strong> : ê·¸ëŸ¼ ê·¸ëƒ¥ UDF ì“°ê³  ê·¸ ì•ˆì—ì„œ mlflow run í•˜ë©´ ë©ë‹ˆë‹¤.</li>
<li><strong>ê·¸ë£¹ë³„ë¡œ íŒŒë¼ë¯¸í„° ì‹¤í—˜ì€?</strong> : groupBy ë¡œ pandas UDFì„ ì“°ë©´ì„œ mlflow runì„ í•˜ëŠ”ë°, nested run ì„ í•˜ë©´ ë©ë‹ˆë‹¤. ì¦‰ í•˜ë‚˜ì˜ ì„¬ (ì˜ˆë¥¼ ë“¤ë©´ Biscoe ì„¬)ì—ì„œì˜ ì‹¤í–‰ì´ parent runì´ ë˜ê³ , íŒŒë¼ë¯¸í„°ê°’ì´ 0.1ì¼ë•Œì˜ runì´ child runì´ ë˜ë„ë¡ í•©ë‹ˆë‹¤.</li>
</ul>
</li>
<li>ë§ì´ ê¸¸ì—ˆìœ¼ë¯€ë¡œ ì½”ë“œë¡œ ë³´ì—¬ë“œë¦¬ë©´ (í•˜ì§€ë§Œ ì½”ë“œê°€ ë” ê¹€)
<ul>
<li>Pandas UDFë¥¼ ì‘ì„±í•œë‹¤.
<ul>
<li>ì´ ì•ˆì—ì„œëŠ” í­ê·„ì´ ì„œì‹í•˜ëŠ” ì„¬ ë³„ë¡œ í´ëŸ¬ìŠ¤í„°ë§(DBSCAN)ì„ ìˆ˜í–‰í•˜ëŠ”ë° ì´ë•Œ
<ul>
<li>MLflow run ì•ˆì—ì„œ
<ul>
<li>ì£¼ì–´ì§„ íŒŒë¼ë¯¸í„° (eps ê°’) ìˆœì„œëŒ€ë¡œ ìˆ˜í–‰í•˜ë©´ì„œ ë¡œê¹…í•œë‹¤.</li>
<li>ì—¬ëŸ¬ê°€ì§€ ì»¤ìŠ¤í…€ ì§€í‘œë¥¼ ë¡œê¹…í•œë‹¤.
<ul>
<li><a href="https://scikit-learn.org/stable/modules/clustering.html#clustering-evaluation">sklearnì´ ì œê³µí•˜ëŠ” í´ëŸ¬ìŠ¤í„°ë§ í‰ê°€ ì§€í‘œë“¤</a>ê³¼ <a href="https://pypi.org/project/s-dbw/">S-Dbw</a></li>
<li>í‰ê°€ì§€í‘œëŠ” ì•„ë‹ˆì§€ë§Œ ë§Œë“¤ì–´ì§„ í´ëŸ¬ìŠ¤í„°ì˜ ê°œìˆ˜ì™€ ë…¸ì´ì¦ˆê°€ ì•„ë‹Œ í´ëŸ¬ìŠ¤í„°ë¡œ ë¶„ë¥˜ëœ ë°ì´í„°ì˜ ê°œìˆ˜ë„ ê¶ê¸ˆí•˜ë‹ˆê¹Œ ë¡œê¹…í•œë‹¤.</li>
</ul>
</li>
</ul>
</li>
<li>ê° ì‹¤í—˜ì˜ ê²°ê³¼ë¥¼ ë‹´ì€ ìŠ¤íŒŒí¬ ë°ì´í„°í”„ë ˆì„ì„ ë¦¬í„´í•˜ë„ë¡ í•œë‹¤.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">83
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">pyspark.sql.functions</span> <span style="color:#81a1c1;font-weight:bold">import</span> pandas_udf<span style="color:#eceff4">,</span> PandasUDFType
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.cluster</span> <span style="color:#81a1c1;font-weight:bold">import</span> DBSCAN
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.metrics</span> <span style="color:#81a1c1;font-weight:bold">import</span> silhouette_score<span style="color:#eceff4">,</span> calinski_harabasz_score<span style="color:#eceff4">,</span> davies_bouldin_score
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">s_dbw</span> <span style="color:#81a1c1;font-weight:bold">import</span> S_Dbw
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>return_schema <span style="color:#81a1c1">=</span> T<span style="color:#81a1c1">.</span>StructType<span style="color:#eceff4">([</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>StringType<span style="color:#eceff4">()),</span> 
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;eps&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>FloatType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;silhouette&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>FloatType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;calinski-harabasz&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>FloatType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;davies-bouldin&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>FloatType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;s-dbw&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>FloatType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;n_clusters&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>IntegerType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;n_clustered_records&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>IntegerType<span style="color:#eceff4">()),</span>
</span></span><span style="display:flex;"><span>  T<span style="color:#81a1c1">.</span>StructField<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;model_path&#39;</span><span style="color:#eceff4">,</span> T<span style="color:#81a1c1">.</span>StringType<span style="color:#eceff4">())</span>
</span></span><span style="display:flex;"><span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">clustering</span><span style="color:#eceff4">(</span>pdf<span style="color:#eceff4">:</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>  island <span style="color:#81a1c1">=</span> pdf<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>iloc<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>  run_id <span style="color:#81a1c1">=</span> pdf<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;run_id&#39;</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>iloc<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span> 
</span></span><span style="display:flex;"><span>  feature_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;bill_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;bill_depth_mm&#39;</span><span style="color:#eceff4">,</span><span style="color:#a3be8c">&#39;flipper_length_mm&#39;</span><span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;body_mass_g&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>  X <span style="color:#81a1c1">=</span> pdf<span style="color:#eceff4">[</span>feature_list<span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>values
</span></span><span style="display:flex;"><span>  scaler <span style="color:#81a1c1">=</span> StandardScaler<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>  X_scaled <span style="color:#81a1c1">=</span> scaler<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>X<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>  n_clusters_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[]</span>
</span></span><span style="display:flex;"><span>  n_clustered_records_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[]</span>
</span></span><span style="display:flex;"><span>  slh_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[]</span>
</span></span><span style="display:flex;"><span>  island_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[]</span>
</span></span><span style="display:flex;"><span>  model_path_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[]</span>
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1;font-weight:bold">for</span> eps_val <span style="color:#81a1c1;font-weight:bold">in</span> eps_list<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	island_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>island<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">(</span>run_id<span style="color:#81a1c1">=</span>run_id<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>	  <span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">(</span>run_name<span style="color:#81a1c1">=</span><span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span>island<span style="color:#eceff4">)</span><span style="color:#81a1c1">+</span><span style="color:#a3be8c">&#39;-eps&#39;</span><span style="color:#81a1c1">+</span><span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span>eps_val<span style="color:#eceff4">),</span> nested<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1;font-weight:bold">as</span> run<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_param<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;eps&#34;</span><span style="color:#eceff4">,</span> eps_val<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		model <span style="color:#81a1c1">=</span> DBSCAN<span style="color:#eceff4">(</span>eps<span style="color:#81a1c1">=</span>eps_val<span style="color:#eceff4">,</span> min_samples<span style="color:#81a1c1">=</span><span style="color:#b48ead">3</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_scaled<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		labels <span style="color:#81a1c1">=</span> model<span style="color:#81a1c1">.</span>labels_
</span></span><span style="display:flex;"><span>		num_labels <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">set</span><span style="color:#eceff4">(</span>labels<span style="color:#eceff4">[</span>labels<span style="color:#81a1c1">&gt;=</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]))</span>
</span></span><span style="display:flex;"><span>	  
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">if</span> num_labels <span style="color:#81a1c1">-</span><span style="color:#b48ead">1</span> <span style="color:#81a1c1">&gt;=</span> <span style="color:#b48ead">1</span> <span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>		  clustered_label <span style="color:#81a1c1">=</span> labels<span style="color:#eceff4">[</span>labels<span style="color:#81a1c1">&gt;=</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>		  clustered_data <span style="color:#81a1c1">=</span> X<span style="color:#eceff4">[</span>np<span style="color:#81a1c1">.</span>where<span style="color:#eceff4">(</span>labels<span style="color:#81a1c1">&gt;=</span><span style="color:#b48ead">0</span><span style="color:#eceff4">)[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]]</span>
</span></span><span style="display:flex;"><span>		  clustered_data_cnt <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">len</span><span style="color:#eceff4">(</span>clustered_data<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		  
</span></span><span style="display:flex;"><span>		  <span style="color:#616e87;font-style:italic">#scores</span>
</span></span><span style="display:flex;"><span>		  slh <span style="color:#81a1c1">=</span> silhouette_score<span style="color:#eceff4">(</span>clustered_data<span style="color:#eceff4">,</span> clustered_label<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		  ch <span style="color:#81a1c1">=</span> calinski_harabasz_score<span style="color:#eceff4">(</span>clustered_data<span style="color:#eceff4">,</span> clustered_label<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		  db <span style="color:#81a1c1">=</span> davies_bouldin_score<span style="color:#eceff4">(</span>clustered_data<span style="color:#eceff4">,</span> clustered_label<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		  s_dbw <span style="color:#81a1c1">=</span> S_Dbw<span style="color:#eceff4">(</span>X_scaled<span style="color:#eceff4">,</span> labels<span style="color:#eceff4">,</span> alg_noise<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#39;filter&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		  
</span></span><span style="display:flex;"><span>		  
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">else</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>		  slh <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">-</span><span style="color:#b48ead">1</span>
</span></span><span style="display:flex;"><span>		  ch <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">-</span><span style="color:#b48ead">1</span>
</span></span><span style="display:flex;"><span>		  db <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">-</span><span style="color:#b48ead">1</span>
</span></span><span style="display:flex;"><span>		  s_dbw <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">-</span><span style="color:#b48ead">1</span>
</span></span><span style="display:flex;"><span>		  clustered_data_cnt <span style="color:#81a1c1">=</span> <span style="color:#b48ead">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>sklearn<span style="color:#81a1c1">.</span>log_model<span style="color:#eceff4">(</span>model<span style="color:#eceff4">,</span> <span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span>island<span style="color:#eceff4">)</span><span style="color:#81a1c1">+</span><span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;-&#39;</span><span style="color:#eceff4">)</span><span style="color:#81a1c1">+</span><span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span>eps_val<span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;silhouette&#34;</span><span style="color:#eceff4">,</span> slh<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;calinski-harabasz&#34;</span><span style="color:#eceff4">,</span> ch<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;davies-bouldin&#34;</span><span style="color:#eceff4">,</span> db<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;s-dbw&#34;</span><span style="color:#eceff4">,</span> s_dbw<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;n_clusters&#34;</span><span style="color:#eceff4">,</span> num_labels<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		mlflow<span style="color:#81a1c1">.</span>log_metric<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;n_clustered_records&#34;</span><span style="color:#eceff4">,</span> clustered_data_cnt<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		artifact_uri <span style="color:#81a1c1">=</span> <span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#34;runs:/</span><span style="color:#a3be8c">{</span>run<span style="color:#81a1c1">.</span>info<span style="color:#81a1c1">.</span>run_id<span style="color:#a3be8c">}</span><span style="color:#a3be8c">/</span><span style="color:#a3be8c">{</span>island<span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#34;</span> <span style="color:#81a1c1">+</span> <span style="color:#81a1c1">str</span><span style="color:#eceff4">(</span>eps_val<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		model_path_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>artifact_uri<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		n_clustered_records_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>clustered_data_cnt<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		n_clusters_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>num_labels<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>		slh_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>slh<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		ch_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>ch<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		db_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>db<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		sdbw_list<span style="color:#81a1c1">.</span>append<span style="color:#eceff4">(</span>s_dbw<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  returnDF <span style="color:#81a1c1">=</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">({</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">:</span>island_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;eps&#39;</span><span style="color:#eceff4">:</span>eps_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;silhouette&#39;</span><span style="color:#eceff4">:</span> slh_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;calinski-harabasz&#39;</span><span style="color:#eceff4">:</span>ch_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;davies-bouldin&#39;</span><span style="color:#eceff4">:</span> db_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;s-dbw&#39;</span><span style="color:#eceff4">:</span>sdbw_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;n_clusters&#39;</span><span style="color:#eceff4">:</span>n_clusters_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;n_clustered_records&#39;</span><span style="color:#eceff4">:</span>n_clusters_list<span style="color:#eceff4">,</span> <span style="color:#a3be8c">&#39;model_path&#39;</span><span style="color:#eceff4">:</span>model_path_list<span style="color:#eceff4">})</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#81a1c1;font-weight:bold">return</span> returnDF
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ë©”ì¸ ë¶€ë¶„ì€ ê°„ë‹¨í•©ë‹ˆë‹¤. ë¦¬í„´ëœ ë°ì´í„°í”„ë ˆì„ì„ í†µí•´  uië¡œ ë³´ì§€ ì•Šì•„ë„ ì‹¤í—˜ ê²°ê³¼ë“¤ê³¼ ëª¨ë¸ ê²½ë¡œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">with</span> mlflow<span style="color:#81a1c1">.</span>start_run<span style="color:#eceff4">(</span>run_name<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;ì„¬ ë³„ í´ëŸ¬ìŠ¤í„°ë§&#34;</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1;font-weight:bold">as</span> run<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>  run_id <span style="color:#81a1c1">=</span> run<span style="color:#81a1c1">.</span>info<span style="color:#81a1c1">.</span>run_uuid
</span></span><span style="display:flex;"><span>  eps_list <span style="color:#81a1c1">=</span> <span style="color:#eceff4">[</span><span style="color:#b48ead">0.1</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.2</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.3</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.5</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.7</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">0.9</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">1.1</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">1.3</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">1.5</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>  modelDF <span style="color:#81a1c1">=</span> <span style="color:#eceff4">(</span>penguins_sdf
</span></span><span style="display:flex;"><span>			 <span style="color:#81a1c1">.</span>withColumn<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;run_id&#34;</span><span style="color:#eceff4">,</span> F<span style="color:#81a1c1">.</span>lit<span style="color:#eceff4">(</span>run_id<span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>			 <span style="color:#81a1c1">.</span>groupby<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;island&#34;</span><span style="color:#eceff4">)</span><span style="color:#81a1c1">.</span>applyInPandas<span style="color:#eceff4">(</span>clustering<span style="color:#eceff4">,</span> schema <span style="color:#81a1c1">=</span> return_schema<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>			<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>display<span style="color:#eceff4">(</span>modelDF<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/15.png#center" width="700"/> 
</figure>

<ul>
<li>
<p>ë¬¼ë¡  Experiments íƒ­ì—ì„œë„ ì´ì „ê³¼ ë˜‘ê°™ì´ í™•ì¸í•  ìˆ˜ ìˆê³ ìš”.</p>
<ul>
<li><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/16.png#center" width="700"/> 
</figure>
</li>
</ul>
</li>
<li>
<p>ì–´ë–¤ í‰ê°€ì§€í‘œë¥¼ ì‚¬ìš©í•˜ëŠëƒì— ë”°ë¼ ë‹¤ë¥´ì§€ë§Œ, ë§Œì•½ s-dbwê°€ ë‚®ì€ ê±¸ ê³ ë¥´ê² ë‹¤ë©´ Biscoeì—ì„œì˜ epsê°’ê³¼ Dreamì—ì„œì˜ eps ê°’ì€ ë‹¤ë¥´ê²Œ ì„¤ì •ë˜ì–´ì•¼ í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>
</li>
<li>
<p>ê°™ì€ ì„¬ì—ì„œ íŒŒë¼ë¯¸í„° ê°’ì— ë”°ë¥¸ í‰ê°€ì§€í‘œ ê°’ì„ ë¹„êµí•´ë³¼ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ë°ì´í„°ë¸Œë¦­ìŠ¤ì˜ ê¸°ë³¸ì ì¸ í”Œë ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë´¤ìŠµë‹ˆë‹¤.</p>
</li>
</ul>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>display<span style="color:#eceff4">(</span>modelDF<span style="color:#81a1c1">.</span>filter<span style="color:#eceff4">(</span>F<span style="color:#81a1c1">.</span>col<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">)</span><span style="color:#81a1c1">==</span><span style="color:#a3be8c">&#39;Dream&#39;</span><span style="color:#eceff4">)</span><span style="color:#81a1c1">.</span>orderBy<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#39;eps&#39;</span><span style="color:#eceff4">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><figure class="align-center ">
    <img loading="lazy" src="/posts/mlflow-tracking-tutorial/17.png#center" width="500"/> 
</figure>

<br></p>
<br>
<h2 id="ì°¸ê³ í•œ-ì±…ê³¼-ê¸€">ì°¸ê³ í•œ ì±…ê³¼ ê¸€<a hidden class="anchor" aria-hidden="true" href="#ì°¸ê³ í•œ-ì±…ê³¼-ê¸€">#</a></h2>
<ul>
<li><a href="https://www.acornpub.co.kr/book/mlops-mlflow">MLFlowë¥¼ í™œìš©í•œ MLOps</a>
<ul>
<li>(ì‚¬ì¡±: ëª‡ë‹¬ì „ì— ì¶©ë™êµ¬ë§¤í•œ ì±…ì¸ë° ë¬µí˜€ë‘ê³  ìˆë‹¤ê°€ ì´ë²ˆì— ê¸‰í•˜ê²Œ ì°¸ê³ í•˜ê¸°ëŠ” ë‚˜ì˜ì§€ ì•Šì•˜ìœ¼ë‚˜ ë‘ê»˜ì— ë¹„í•´ ë‚´ìš©ì´ ì—„ì²­ í’ë¶€í•˜ì§„ ì•ŠìŒ. ê·¸ëƒ¥ êµ¬ê¸€ë§í•´ì„œ ë‚˜ì˜¤ëŠ” ë¬¸ì„œë“¤ì´ ë‚˜ì„ ìˆ˜ë„)</li>
</ul>
</li>
<li><a href="https://databricks.com/blog/2020/05/19/manage-and-scale-machine-learning-models-for-iot-devices.html">Manage and Scale Machine Learning Models for IoT Devices</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sliceofdata.app/tags/mlflow/">Mlflow</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹ on x"
            href="https://x.com/intent/tweet/?text=MLFlow%eb%a1%9c%20%eb%aa%a8%eb%8d%b8%20%ec%8b%a4%ed%97%98%20%ed%8a%b8%eb%9e%98%ed%82%b9&amp;url=https%3a%2f%2fsliceofdata.app%2fposts%2fmlflow-tracking-tutorial%2f&amp;hashtags=mlflow">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share MLFlowë¡œ ëª¨ë¸ ì‹¤í—˜ íŠ¸ë˜í‚¹ on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsliceofdata.app%2fposts%2fmlflow-tracking-tutorial%2f&amp;title=MLFlow%eb%a1%9c%20%eb%aa%a8%eb%8d%b8%20%ec%8b%a4%ed%97%98%20%ed%8a%b8%eb%9e%98%ed%82%b9&amp;summary=MLFlow%eb%a1%9c%20%eb%aa%a8%eb%8d%b8%20%ec%8b%a4%ed%97%98%20%ed%8a%b8%eb%9e%98%ed%82%b9&amp;source=https%3a%2f%2fsliceofdata.app%2fposts%2fmlflow-tracking-tutorial%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
<div class="container_disqus">
    <script src="https://giscus.app/client.js"
        data-repo="pizzathiefz/sliceofdata"
        data-repo-id="R_kgDOPsr6oQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOPsr6oc4CvOfW"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme=""
        data-lang="en"
        crossorigin="anonymous"
        async>
    </script>
</div>
<script>
    
    function getCurrentTheme() {
        
        let storedTheme = localStorage.getItem('pref-theme');
        if (storedTheme) {
            return storedTheme;
        }
        
        
        if (document.body.classList.contains('dark')) {
            return 'dark';
        }
        
        
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
        }
        
        return 'light';
    }
    
    
    function setGiscusTheme() {
        let currentTheme = getCurrentTheme();
        let giscusTheme = currentTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
        
        
        let giscusScript = document.querySelector("div.container_disqus > script");
        if (giscusScript) {
            giscusScript.setAttribute('data-theme', giscusTheme);
        }
        
        return giscusTheme;
    }
    
    
    setGiscusTheme();
    
    
    document.addEventListener('DOMContentLoaded', function() {
        let themeToggle = document.querySelector('#theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                setTimeout(() => {
                    let newTheme = getCurrentTheme();
                    let newGiscusTheme = newTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
                    
                    let giscusFrame = document.querySelector('iframe.giscus-frame');
                    if (giscusFrame) {
                        giscusFrame.contentWindow.postMessage({
                            giscus: {
                                setConfig: {
                                    theme: newGiscusTheme
                                }
                            }
                        }, 'https://giscus.app');
                    }
                }, 100);
            });
        }
    });
</script>

</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://sliceofdata.app/">sliceofdata</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
