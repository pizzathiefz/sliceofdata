<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>SOLID Principles Explained with ML Code | sliceofdata</title>
<meta name="keywords" content="solid, Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç, oop">
<meta name="description" content="OOP made less scary (and more useful) for data practitioners">
<meta name="author" content="pizzathief">
<link rel="canonical" href="https://sliceofdata.app/en/posts/solid-principles-for-ml/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.27cad2a1c5348b9448235a32de472a54bfb4b517f58e15427dc5a1a01bf486da.css" integrity="sha256-J8rSocU0i5RII1oy3kcqVL&#43;0tRf1jhVCfcWhoBv0hto=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://sliceofdata.app/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://sliceofdata.app/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://sliceofdata.app/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<link rel="mask-icon" href="https://sliceofdata.app/%3Clink%20/%20abs%20url%3E">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="ko" href="https://sliceofdata.app/posts/solid-principles-for-ml/">
<link rel="alternate" hreflang="en" href="https://sliceofdata.app/en/posts/solid-principles-for-ml/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body, {
  delimiters: [
    {left: '$$', right: '$$', display: true},
    {left: '$', right: '$', display: false},
    {left: '\\(', right: '\\)', display: false},
    {left: '\\[', right: '\\]', display: true}
  ],
  throwOnError: false
});"></script>
<meta property="og:url" content="https://sliceofdata.app/en/posts/solid-principles-for-ml/">
  <meta property="og:site_name" content="sliceofdata">
  <meta property="og:title" content="SOLID Principles Explained with ML Code">
  <meta property="og:description" content="OOP made less scary (and more useful) for data practitioners">
  <meta property="og:locale" content="en-US">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-02-14T17:24:18+09:00">
    <meta property="article:modified_time" content="2025-02-14T17:24:18+09:00">
    <meta property="article:tag" content="AI-ML">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SOLID Principles Explained with ML Code">
<meta name="twitter:description" content="OOP made less scary (and more useful) for data practitioners">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://sliceofdata.app/en/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "SOLID Principles Explained with ML Code",
      "item": "https://sliceofdata.app/en/posts/solid-principles-for-ml/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SOLID Principles Explained with ML Code",
  "name": "SOLID Principles Explained with ML Code",
  "description": "OOP made less scary (and more useful) for data practitioners",
  "keywords": [
    "solid", "Í∞ùÏ≤¥ ÏßÄÌñ• ÌîÑÎ°úÍ∑∏ÎûòÎ∞ç", "oop"
  ],
  "articleBody": "You Love Jupyter, But It Won‚Äôt Love You Back in Production Jupyter Notebook is an incredibly handy tool for anyone doing data analysis or building ML models. Unlike regular software development, a huge chunk of the work here revolves around experiments. So when we write code, we‚Äôre often not that concerned with the overall architecture or design‚Äîwhat we really want is to just run it quickly and check: what does this distribution look like? or how‚Äôs the accuracy shaping up? That‚Äôs pretty much the mindset we all share. And that‚Äôs exactly why Jupyter, with its cell-based execution and instant feedback, feels like such a perfect fit‚Äîit almost doesn‚Äôt need explaining. Of course, no one reading this is probably ‚Äúscared‚Äù of functions, but the truth is we often end up writing everything in one long, unstructured flow. Not because ‚Äúfunctions scare us‚Äù, but simply because‚Ä¶ well, it‚Äôs just more convenient that way.\nBut once you get past quick ad-hoc analysis or early-stage prototyping and actually need to ship something to production, Jupyter Notebooks can quickly turn into a real headache. A single notebook stuffed with everything‚Äîdata preprocessing, model training, inference, even data loading‚Äîends up as this big monolithic blob of code that‚Äôs almost impossible to deal with. And honestly, it‚Äôs always a bit funny to see developers from other teams trying (and failing) to hide the look of shock when they stumble across one of these notebooks.\nThe problems with this kind of setup are too many to list, but the big ones are:\nDebugging and maintenance are a nightmare (Have you ever opened a notebook with 89 cells? Be real‚Äîeven if it‚Äôs your own code from a few months back, there‚Äôs no way you‚Äôll remember what‚Äôs where.) Version control and collaboration are painful (Comparing changes is clunky, and since outputs are saved in the file, the whole thing looks different even when the logic hasn‚Äôt really changed.) Reuse and extension are nearly impossible (There‚Äôs no clear separation of functionality, logic gets copy-pasted everywhere, and if you want to tweak one specific feature, you‚Äôre basically out of luck.) So even if you do all your experimentation in Jupyter, once it‚Äôs time to move toward production you really need a reasonable level of modularization and proper scripts. A useful reference at that point is the set of design guidelines from object-oriented programming (OOP) known as the SOLID principles.\nThere are five of them, and the name ‚ÄúSOLID‚Äù is just an acronym made from their initials. These principles have been around forever, so you‚Äôll find no shortage of resources if you search for them‚Äîbut the explanations can feel a bit abstract, and the examples don‚Äôt always click. That‚Äôs why today I want to walk through them using some simple, more relatable examples that made sense to me.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 import seaborn as sns import pandas as pd import numpy as np import matplotlib.pyplot as plt from sklearn.model_selection import train_test_split from sklearn.preprocessing import LabelEncoder from sklearn.ensemble import RandomForestClassifier from sklearn.metrics import accuracy_score # load data penguins = sns.load_dataset(\"penguins\") # preprocess penguins.dropna(inplace=True) le = LabelEncoder() penguins['species'] = le.fit_transform(penguins['species']) penguins['sex'] = le.fit_transform(penguins['sex']) penguins['island'] = le.fit_transform(penguins['island']) X = penguins.drop(columns=['species']) y = penguins['species'] # split data X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42) # model train and evaluation clf = RandomForestClassifier(n_estimators=100, random_state=42) clf.fit(X_train, y_train) y_pred = clf.predict(X_test) accuracy = accuracy_score(y_test, y_pred) print(f'Accuracy: {accuracy:.2f}') # visualization plt.figure(figsize=(8, 6)) sns.scatterplot(data=penguins, x=\"bill_length_mm\", y=\"bill_depth_mm\", hue=\"species\") plt.title(\"Penguin Species based on Bill Length and Depth\") plt.show() The code above loads the penguin dataset and does a simple species classification‚Äîbasically the ABCs of machine learning, nothing you need to study too closely. It‚Äôs also a textbook example of what I called ‚ÄúJupyter-style‚Äù code earlier. Now, let‚Äôs try refactoring it with the SOLID principles in mind.\nQuick disclaimer before we dive in üìç The refactored versions are not meant to say ‚Äúthis is the only right way to write code.‚Äù They‚Äôre not super polished, and in a real project I‚Äôd probably take a different approach. Think of them more as examples to help explain SOLID principles in a language that feels familiar to folks doing data analysis and modeling. Also, it‚Äôs not that every single SOLID rule must always be followed in an ML project. Rather, see them as a general direction you can aim for when writing production-ready code. Single Responsibility Principle A class should have only one responsibility.\n‚ÄúResponsibility‚Äù might sound vague, but you can think of it simply as a function or role. In other words, each class should focus on doing one thing well. That also means whenever you change the class, it should only be because there‚Äôs a change related to that one specific responsibility‚Äîone reason, one change.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 class DataLoader: def load_data(): return sns.load_dataset(\"penguins\") class DataPreprocessor: def preprocess_data(df): df.dropna(inplace=True) le = LabelEncoder() df['species'] = le.fit_transform(df['species']) df['sex'] = le.fit_transform(df['sex']) df['island'] = le.fit_transform(df['island']) X = df.drop(columns=['species']) y = df['species'] return X, y class ModelTrainer: def __init__(self, model): self.model = model def train(self, X_train, y_train): self.model.fit(X_train, y_train) def predict(self, X_test): return self.model.predict(X_test) def evaluate(self, y_test, y_pred): return accuracy_score(y_test, y_pred) class DataVisualizer: def visualize(df): plt.figure(figsize=(8, 6)) sns.scatterplot(data=df, x=\"bill_length_mm\", y=\"bill_depth_mm\", hue=\"species\") plt.title(\"Penguin Species based on Bill Length and Depth\") plt.show() if __name__ == \"__main__\": data = DataLoader.load_data() X, y = DataPreprocessor.preprocess_data(data) X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42) model = RandomForestClassifier(n_estimators=100, random_state=42) trainer = ModelTrainer(model) trainer.train(X_train, y_train) y_pred = trainer.predict(X_test) accuracy = trainer.evaluate(y_test, y_pred) print(f'Accuracy: {accuracy:.2f}') DataVisualizer.visualize(data) In our original code, we didn‚Äôt even have any classes to begin with. So the first step was to break things down into separate classes, each responsible for exactly one piece of functionality:\nDataLoader ‚Äì loads the dataset DataPreprocessor ‚Äì handles preprocessing ModelTrainer ‚Äì takes care of training, prediction, and evaluation DataVisualizer ‚Äì deals with visualization Now each class has one clear role. Which means if you ever want to tweak how the plots look, you only need to touch DataVisualizer‚Äîand nothing else.\nOpen-Closed Principle Software components (classes, modules, functions, etc.) should be open for extension, but closed for modification.\nAt first glance, you might think, ‚ÄúWait‚Äîopen in one place and closed in another? Isn‚Äôt that a contradiction?‚Äù But what it really means is that your code should be designed so you don‚Äôt have to rewrite existing logic when adding new functionality. Instead, you should be able to extend it. The key to achieving this is through abstraction and inheritance‚Äîdefine an abstract interface, and then build new features by implementing or subclassing it, rather than tinkering with the original code.\n\bimage source\nLet‚Äôs pause for a second to cover a core idea in object-oriented programming (OOP). Imagine a game with different characters‚Äîsay, a mage and a warrior. A mage attacks with a staff, while a warrior swings a sword. The details differ, but the common point is that they both need to be able to attack. So what we do is define an abstract Character interface with the basic abilities like move, attack, and defend. Then the Mage and Warrior classes inherit from this interface and implement their own versions of those actions. This is what we call polymorphism‚Äîand the beauty of it is that you can treat all these classes through the same interface, while still being able to extend them flexibly. For example, if you need a new dragon character, you don‚Äôt have to tear down the Character interface or start over. You just inherit from it and implement a new ‚Äúfire-breath‚Äù attack. That‚Äôs the essence of the Open-Closed Principle: leverage polymorphism so you can extend your system without rewriting the foundations.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 from abc import ABC, abstractmethod class BaseModel(ABC): @abstractmethod def train(self, X_train, y_train): pass @abstractmethod def predict(self, X_test): pass @abstractmethod def evaluate(self, y_test, y_pred): pass class RandomForestTrainer(BaseModel): def __init__(self, n_estimators=100, random_state=42): self.model = RandomForestClassifier(n_estimators=n_estimators, random_state=random_state) def train(self, X_train, y_train): self.model.fit(X_train, y_train) def predict(self, X_test): return self.model.predict(X_test) def evaluate(self, y_test, y_pred): return accuracy_score(y_test, y_pred) class GradientBoostingTrainer(BaseModel): def __init__(self, learning_rate=0.1, n_estimators=100, random_state=42): self.model = GradientBoostingClassifier(learning_rate=learning_rate, n_estimators=n_estimators, random_state=random_state) def train(self, X_train, y_train): self.model.fit(X_train, y_train) def predict(self, X_test): return self.model.predict(X_test) def evaluate(self, y_test, y_pred): return accuracy_score(y_test, y_pred) Now, coming back to our example‚Ä¶ First off, ABC is a Python library you use to define abstract classes and methods. An abstract class isn‚Äôt meant to be instantiated directly‚Äîinstead, it serves as an interface that tells any subclasses, ‚ÄúHere are the methods and properties you need to implement.‚Äù It‚Äôs basically the same idea as the Character class from the earlier example.\nThe @abstractmethod decorator enforces this rule: if a class inherits from the abstract base, it must implement that method. In our case, we created a BaseModel abstract class. Any actual model we want to use will inherit from this class. The contract is that subclasses have to implement train, predict, and evaluate as core functionalities. That way, if at some point you decide to swap out RandomForest for, say, a Gradient Boosted Tree (GBT), you don‚Äôt rewrite or modify BaseModel‚Äîyou just inherit from it and provide the new implementation. That‚Äôs how you achieve extension without modification.\nLiskov Substitution Principle Subclasses should be substitutable for their base classes.\nI‚Äôll admit, this one didn‚Äôt click for me at first. When I first read it, I thought: ‚ÄúWhy would a subclass need to replace its parent? Didn‚Äôt we create subclasses to override and specialize behavior?‚Äù But the principle isn‚Äôt telling you to actually replace things‚Äîit‚Äôs saying you should design your inheritance so that replacement is always possible without breaking anything. If you trace it back to its original definition, it goes something like: ‚ÄúIf a property holds true for objects of type T, it must also hold true for objects of type S, where S is a subtype of T.‚Äù In other words, everything that works for the base class should also work for its subclass. So the key takeaway is: if swapping out a base class with one of its subclasses causes errors or weird behavior, then your inheritance hierarchy isn‚Äôt designed correctly.\nimage source\nIf you build a toy duck that looks and quacks like a real duck, there‚Äôs a catch: the real duck waddles on its own when you set it down, but the toy duck won‚Äôt move without batteries. Drop the toy duck into the same situation as the real duck (i.e., code written against the base class), and it misbehaves‚Äîthat‚Äôs a violation of LSP. What do you do? If you can make it move without batteries (i.e., rewrite the subclass to meet the base class‚Äôs guarantees), great. Usually you can‚Äôt, so the fix is to reclassify: make the toy duck a subtype of Toy, not of Duck, so it no longer promises behaviors it can‚Äôt deliver. Back to our running example‚Äîthis time, let‚Äôs tweak the data preprocessing side rather than the model.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 class DataPreprocessor(ABC): def __init__(self, df: pd.DataFrame): self.df = df @abstractmethod def preprocess(self) -\u003e pd.DataFrame: \"\"\"Ï†ÑÏ≤òÎ¶¨ Ïã§Ìñâ\"\"\" pass class NumericPreprocessor(DataPreprocessor): def preprocess(self) -\u003e pd.DataFrame: scaler = StandardScaler() numeric_columns = self.df.select_dtypes(include=[\"number\"]).columns self.df[numeric_columns] = scaler.fit_transform(self.df[numeric_columns]) return self.df class CategoryPreprocessor(DataPreprocessor): def preprocess(self) -\u003e pd.DataFrame: encoder = OneHotEncoder(sparse=False) categorical_columns = self.df.select_dtypes(include=[\"object\"]).columns if categorical_columns.empty: return self.df transformed = encoder.fit_transform(self.df[categorical_columns]) column_names = encoder.get_feature_names_out(categorical_columns) encoded_df = pd.DataFrame(transformed, columns=column_names, index=self.df.index) self.df = self.df.drop(columns=categorical_columns).reset_index(drop=True) encoded_df = encoded_df.reset_index(drop=True) return pd.concat([self.df, encoded_df], axis=1) class TrainTestSplitter(DataPreprocessor): def preprocess(self) -\u003e tuple[pd.DataFrame, pd.DataFrame]: train_df, test_df = train_test_split(self.df, test_size=0.2, random_state=42) return train_df, test_df From the original class with hard-coded column names, I introduced a top-level DataPreprocessor interface with SRP and OCP in mind, then subclassed it to handle preprocessing for numeric and categorical columns separately. The final step of preprocessing is splitting the data into train and test. Now, if we make the class that performs this split inherit from DataPreprocessor, we‚Äôd be violating LSP. Why? Because instead of returning a preprocessed pandas DataFrame like DataPreprocessor promises, it returns a tuple of split datasets. It might still ‚Äúrun,‚Äù but the subclass can‚Äôt substitute the base class‚Äîso the inheritance design is off.\nInterface Segregation Principle Clients should not be forced to depend on interfaces they don‚Äôt use.\nWhat this means in practice is that interfaces should be kept as small and specific as possible, exposing only the methods that are truly needed. In other words, don‚Äôt cram a bunch of ‚Äújust in case‚Äù methods into a single interface‚Äîdesign it so that each client only deals with the functionality it actually uses.\nA base class interface defines two features, but from the subclass‚Äôs perspective, one of them isn‚Äôt actually needed. (image source)\nThis principle is pretty straightforward, so let‚Äôs skip the theory and jump into an example. Back in the OCP section, we created a BaseModel class that bundled together training, prediction, and evaluation. But if you think about it, not every case really needs all three. For instance, you might want to load a pre-trained model and only run predictions. Or maybe you‚Äôre using it as a feature extractor‚Äîtrain it, then just grab the learned vectors without doing any predictions. And in an online learning scenario, the evaluation step might not even be relevant.\nWith that in mind, let‚Äôs break those three capabilities into separate interfaces.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 class Trainable(ABC): @abstractmethod def train(self, X_train, y_train): pass class Predictable(ABC): @abstractmethod def predict(self, X_test): pass class Evaluable(ABC): @abstractmethod def evaluate(self, y_test, y_pred): pass Once the three interfaces are split out, you can mix and match‚Äîimplementing only the pieces you actually need for each use case.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 class RandomForestTrainer(Trainable, Predictable, Evaluable): def __init__(self, n_estimators=100, random_state=42): self.model = RandomForestClassifier(n_estimators=n_estimators, random_state=random_state) def train(self, X_train, y_train): self.model.fit(X_train, y_train) def predict(self, X_test): return self.model.predict(X_test) def evaluate(self, y_test, y_pred): return accuracy_score(y_test, y_pred) class PretrainedModel(Predictable): def __init__(self, model_path): self.model = joblib.load(model_path) def predict(self, X_test): return self.model.predict(X_test) class FeatureExtractor(Trainable): def __init__(self, n_components=1): self.model = PCA(n_components=n_components) def train(self, X_train): self.model.fit(X_train) def extract_features(self, X): return self.model.transform(X) Dependency Inversion Principle High-level modules should not depend on low-level modules. Both should depend on abstractions.\nimage source\nSo what exactly are ‚Äúhigh-level‚Äù and ‚Äúlow-level‚Äù modules? A high-level module (A) is the class that runs the core business logic, while a low-level module (B) handles more detailed, concrete tasks that A calls and uses. The Dependency Inversion Principle says A shouldn‚Äôt depend directly on B. Instead, there should be an abstract interface (C) sitting in between. The term inversion comes from the idea that the high-level module doesn‚Äôt go looking for a specific low-level implementation‚Äîinstead, the low-level piece gets injected from the outside through that abstraction.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 class MargheritaPizza: def prepare(self): print(\"üçÖüåøüßÄ\") def bake(self): print(\"üî•\") def serve(self): print(\"üçï\") class PizzaSell: def __init__(self): self.pizza = MargheritaPizza() def order_pizza(self): self.pizza.prepare() self.pizza.bake() self.pizza.serve() In this example, each individual pizza is a low-level module, while the pizza sales logic is the high-level module. If the high-level module depends directly on specific pizza classes, then every time you add a new pizza to the menu, you‚Äôre forced to modify that class(It also breaks the Open-Closed Principle).\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 class Pizza(ABC): @abstractmethod def prepare(self): pass @abstractmethod def bake(self): pass @abstractmethod def serve(self): pass class HawaiianPizza(Pizza): def prepare(self): print(\"üççüçñüßÄ\") def bake(self): print(\"üî•\") def serve(self): print(\"üçï\") class PizzaSell: def __init__(self, pizza: Pizza): self.pizza = pizza def order_pizza(self): self.pizza.prepare() self.pizza.bake() self.pizza.serve() margherita_sell = PizzaSell(MargheritaPizza()) pepperoni_sell = PizzaSell(HawaiianPizza()) In the code above, the high-level module doesn‚Äôt depend on individual pizza types; it depends on an abstract Pizza interface. That gives you extensibility and easier maintenance‚Äîyou can add a new pizza without touching the high-level logic.\nBack to our original example and the data preprocessing part: so far we only introduced an abstract DataPreprocessor interface. We‚Äôll keep the existing DataPreprocessor, NumericPreprocessor, and CategoricalPreprocessor as they are, and then add a high-level module on top that orchestrates them, like this.\n1 2 3 4 5 6 7 8 9 10 11 12 13 class PreprocessingPipeline: def __init__(self, preprocessors: list[DataPreprocessor]): self.preprocessors = preprocessors def run(self) -\u003e pd.DataFrame: processed_df = self.preprocessors[0].df for preprocessor in self.preprocessors: processed_df = preprocessor.preprocess() return processed_df pipeline = PreprocessingPipeline([NumericPreprocessor(df), CategoryPreprocessor(df)]) processed_df = pipeline.run() The pipeline acts as a high-level module that takes in a series of low-level modules, all of type DataPreprocessor. This way, even if you later introduce a new preprocessing class‚Äîbeyond the numeric scaler or categorical encoder you already have‚Äîit can plug right in without touching the existing code. In other words, the system stays flexible and extensible.\nReferences Í∞ùÏ≤¥ ÏßÄÌñ• ÏÑ§Í≥ÑÏùò 5Í∞ÄÏßÄ ÏõêÏπô - S.O.L.I.D ",
  "wordCount" : "2920",
  "inLanguage": "en",
  "datePublished": "2025-02-14T17:24:18+09:00",
  "dateModified": "2025-02-14T17:24:18+09:00",
  "author":{
    "@type": "Person",
    "name": "pizzathief"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://sliceofdata.app/en/posts/solid-principles-for-ml/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "sliceofdata",
    "logo": {
      "@type": "ImageObject",
      "url": "https://sliceofdata.app/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://sliceofdata.app/en/" accesskey="h" title="slice.of.data (Alt + H)">
                <img src="https://sliceofdata.app/apple-touch-icon.png" alt="" aria-label="logo"
                    height="35">slice.of.data</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
                <ul class="lang-switch"><li>|</li>
                    <li>
                        <a href="https://sliceofdata.app/" title="ÌïúÍµ≠Ïñ¥"
                            aria-label="ÌïúÍµ≠Ïñ¥">Ko</a>
                    </li>
                </ul>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://sliceofdata.app/en/archives/" title="posts">
                    <span>posts</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/en/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/en/about/" title="about">
                    <span>about</span>
                </a>
            </li>
            <li>
                <a href="https://sliceofdata.app/en/subscribe" title="subscribe">
                    <span>subscribe</span>
                </a>
            </li>
            <li>
                <a href="https://pizzathief.pages.dev/" title="notes">
                    <span>notes</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      SOLID Principles Explained with ML Code
    </h1>
    <div class="post-meta"><span title='2025-02-14 17:24:18 +0900 KST'>2025-02-14</span>&nbsp;¬∑&nbsp;14 min&nbsp;¬∑&nbsp;pizzathief&nbsp;|&nbsp;Translations:
<ul class="i18n_list">
    <li>
        <a href="https://sliceofdata.app/posts/solid-principles-for-ml/">Ko</a>
    </li>
</ul>&nbsp;|&nbsp;<a href="https://github.com/pizzathiefz/sliceofdata/blob/main/content/posts/solid-principles-for-ml/index.en.md" rel="noopener noreferrer edit" target="_blank">Suggest Changes</a>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#you-love-jupyter-but-it-wont-love-you-back-in-production">You Love Jupyter, But It Won‚Äôt Love You Back in Production</a></li>
    <li><a href="#single-responsibility-principle">Single Responsibility Principle</a></li>
    <li><a href="#open-closed-principle">Open-Closed Principle</a></li>
    <li><a href="#liskov-substitution-principle">Liskov Substitution Principle</a></li>
    <li><a href="#interface-segregation-principle">Interface Segregation Principle</a></li>
    <li><a href="#dependency-inversion-principle">Dependency Inversion Principle</a></li>
    <li><a href="#references">References</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="you-love-jupyter-but-it-wont-love-you-back-in-production">You Love Jupyter, But It Won‚Äôt Love You Back in Production<a hidden class="anchor" aria-hidden="true" href="#you-love-jupyter-but-it-wont-love-you-back-in-production">#</a></h2>
<figure class="align-center ">
    <img loading="lazy" src="/posts/solid-principles-for-ml/stop-it-patrick.png#center" width="300"/> 
</figure>

<p>Jupyter Notebook is an incredibly handy tool for anyone doing data analysis or building ML models. Unlike regular software development, a huge chunk of the work here revolves around experiments. So when we write code, we‚Äôre often not that concerned with the overall architecture or design‚Äîwhat we really want is to just run it quickly and check: <em>what does this distribution look like?</em> or <em>how‚Äôs the accuracy shaping up?</em> That‚Äôs pretty much the mindset we all share. And that‚Äôs exactly why Jupyter, with its cell-based execution and instant feedback, feels like such a perfect fit‚Äîit almost doesn‚Äôt need explaining. Of course, no one reading this is probably ‚Äúscared‚Äù of functions, but the truth is we often end up writing everything in one long, unstructured flow. Not because &ldquo;functions scare us&rdquo;, but simply because‚Ä¶ well, it‚Äôs just more convenient that way.</p>
<p>But once you get past quick ad-hoc analysis or early-stage prototyping and actually need to ship something to production, Jupyter Notebooks can quickly turn into a real headache. A single notebook stuffed with everything‚Äîdata preprocessing, model training, inference, even data loading‚Äîends up as this big monolithic blob of code that‚Äôs almost impossible to deal with. And honestly, it‚Äôs always a bit funny to see developers from other teams trying (and failing) to hide the look of shock when they stumble across one of these notebooks.</p>
<p>The problems with this kind of setup are too many to list, but the big ones are:</p>
<ul>
<li><strong>Debugging and maintenance are a nightmare</strong> (Have you ever opened a notebook with 89 cells? Be real‚Äîeven if it‚Äôs your <em>own</em> code from a few months back, there‚Äôs no way you‚Äôll remember what‚Äôs where.)</li>
<li><strong>Version control and collaboration are painful</strong> (Comparing changes is clunky, and since outputs are saved in the file, the whole thing looks different even when the logic hasn‚Äôt really changed.)</li>
<li><strong>Reuse and extension are nearly impossible</strong> (There‚Äôs no clear separation of functionality, logic gets copy-pasted everywhere, and if you want to tweak one specific feature, you‚Äôre basically out of luck.)</li>
</ul>
<p>So even if you do all your experimentation in Jupyter, once it‚Äôs time to move toward production you really need a reasonable level of modularization and proper scripts. A useful reference at that point is the set of design guidelines from object-oriented programming (OOP) known as the <strong>SOLID principles</strong>.</p>
<p>There are five of them, and the name ‚ÄúSOLID‚Äù is just an acronym made from their initials. These principles have been around forever, so you‚Äôll find no shortage of resources if you search for them‚Äîbut the explanations can feel a bit abstract, and the examples don‚Äôt always click. That‚Äôs why today I want to walk through them using some simple, more relatable examples that made sense to me.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">seaborn</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">sns</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">pandas</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">pd</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">numpy</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">np</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">import</span> <span style="color:#8fbcbb">matplotlib.pyplot</span> <span style="color:#81a1c1;font-weight:bold">as</span> <span style="color:#8fbcbb">plt</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.model_selection</span> <span style="color:#81a1c1;font-weight:bold">import</span> train_test_split
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.preprocessing</span> <span style="color:#81a1c1;font-weight:bold">import</span> LabelEncoder
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.ensemble</span> <span style="color:#81a1c1;font-weight:bold">import</span> RandomForestClassifier
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">sklearn.metrics</span> <span style="color:#81a1c1;font-weight:bold">import</span> accuracy_score
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># load data</span>
</span></span><span style="display:flex;"><span>penguins <span style="color:#81a1c1">=</span> sns<span style="color:#81a1c1">.</span>load_dataset<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;penguins&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># preprocess</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#81a1c1">.</span>dropna<span style="color:#eceff4">(</span>inplace<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>le <span style="color:#81a1c1">=</span> LabelEncoder<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>X <span style="color:#81a1c1">=</span> penguins<span style="color:#81a1c1">.</span>drop<span style="color:#eceff4">(</span>columns<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>y <span style="color:#81a1c1">=</span> penguins<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># split data</span>
</span></span><span style="display:flex;"><span>X_train<span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">,</span> y_test <span style="color:#81a1c1">=</span> train_test_split<span style="color:#eceff4">(</span>X<span style="color:#eceff4">,</span> y<span style="color:#eceff4">,</span> test_size<span style="color:#81a1c1">=</span><span style="color:#b48ead">0.2</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># model train and evaluation</span>
</span></span><span style="display:flex;"><span>clf <span style="color:#81a1c1">=</span> RandomForestClassifier<span style="color:#eceff4">(</span>n_estimators<span style="color:#81a1c1">=</span><span style="color:#b48ead">100</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>clf<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>y_pred <span style="color:#81a1c1">=</span> clf<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>accuracy <span style="color:#81a1c1">=</span> accuracy_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Accuracy: </span><span style="color:#a3be8c">{</span>accuracy<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#616e87;font-style:italic"># visualization</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>figure<span style="color:#eceff4">(</span>figsize<span style="color:#81a1c1">=</span><span style="color:#eceff4">(</span><span style="color:#b48ead">8</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">6</span><span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>sns<span style="color:#81a1c1">.</span>scatterplot<span style="color:#eceff4">(</span>data<span style="color:#81a1c1">=</span>penguins<span style="color:#eceff4">,</span> x<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;bill_length_mm&#34;</span><span style="color:#eceff4">,</span> y<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;bill_depth_mm&#34;</span><span style="color:#eceff4">,</span> hue<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;species&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>title<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Penguin Species based on Bill Length and Depth&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>plt<span style="color:#81a1c1">.</span>show<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The code above loads the penguin dataset and does a simple species classification‚Äîbasically the ABCs of machine learning, nothing you need to study too closely. It‚Äôs also a textbook example of what I called ‚ÄúJupyter-style‚Äù code earlier. Now, let‚Äôs try refactoring it with the SOLID principles in mind.</p>
<ul>
<li><strong>Quick disclaimer before we dive in üìç</strong>
<ul>
<li>The refactored versions are <em>not</em> meant to say ‚Äúthis is the only right way to write code.‚Äù They‚Äôre not super polished, and in a real project I‚Äôd probably take a different approach. Think of them more as <strong>examples to help explain SOLID principles in a language that feels familiar to folks doing data analysis and modeling.</strong></li>
<li>Also, it‚Äôs not that every single SOLID rule must always be followed in an ML project. Rather, see them as a general direction you can aim for when writing production-ready code.</li>
</ul>
</li>
</ul>
<br>
<h2 id="single-responsibility-principle">Single Responsibility Principle<a hidden class="anchor" aria-hidden="true" href="#single-responsibility-principle">#</a></h2>
<blockquote>
<p><strong>A class should have only one responsibility.</strong></p></blockquote>
<p>‚ÄúResponsibility‚Äù might sound vague, but you can think of it simply as a <em>function</em> or <em>role</em>. In other words, each class should focus on doing one thing well. That also means whenever you change the class, it should only be because there‚Äôs a change related to that one specific responsibility‚Äîone reason, one change.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">45
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">DataLoader</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">load_data</span><span style="color:#eceff4">():</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> sns<span style="color:#81a1c1">.</span>load_dataset<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;penguins&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">DataPreprocessor</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">preprocess_data</span><span style="color:#eceff4">(</span>df<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		df<span style="color:#81a1c1">.</span>dropna<span style="color:#eceff4">(</span>inplace<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		le <span style="color:#81a1c1">=</span> LabelEncoder<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>		df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>		df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;sex&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>		df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> le<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span>df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;island&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>		X <span style="color:#81a1c1">=</span> df<span style="color:#81a1c1">.</span>drop<span style="color:#eceff4">(</span>columns<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>		y <span style="color:#81a1c1">=</span> df<span style="color:#eceff4">[</span><span style="color:#a3be8c">&#39;species&#39;</span><span style="color:#eceff4">]</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> X<span style="color:#eceff4">,</span> y
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">ModelTrainer</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> model<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> model
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> accuracy_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">DataVisualizer</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">visualize</span><span style="color:#eceff4">(</span>df<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		plt<span style="color:#81a1c1">.</span>figure<span style="color:#eceff4">(</span>figsize<span style="color:#81a1c1">=</span><span style="color:#eceff4">(</span><span style="color:#b48ead">8</span><span style="color:#eceff4">,</span> <span style="color:#b48ead">6</span><span style="color:#eceff4">))</span>
</span></span><span style="display:flex;"><span>		sns<span style="color:#81a1c1">.</span>scatterplot<span style="color:#eceff4">(</span>data<span style="color:#81a1c1">=</span>df<span style="color:#eceff4">,</span> x<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;bill_length_mm&#34;</span><span style="color:#eceff4">,</span> y<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;bill_depth_mm&#34;</span><span style="color:#eceff4">,</span> hue<span style="color:#81a1c1">=</span><span style="color:#a3be8c">&#34;species&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		plt<span style="color:#81a1c1">.</span>title<span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;Penguin Species based on Bill Length and Depth&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		plt<span style="color:#81a1c1">.</span>show<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">if</span> __name__ <span style="color:#81a1c1">==</span> <span style="color:#a3be8c">&#34;__main__&#34;</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>	data <span style="color:#81a1c1">=</span> DataLoader<span style="color:#81a1c1">.</span>load_data<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>	X<span style="color:#eceff4">,</span> y <span style="color:#81a1c1">=</span> DataPreprocessor<span style="color:#81a1c1">.</span>preprocess_data<span style="color:#eceff4">(</span>data<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	X_train<span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">,</span> y_test <span style="color:#81a1c1">=</span> train_test_split<span style="color:#eceff4">(</span>X<span style="color:#eceff4">,</span> y<span style="color:#eceff4">,</span> test_size<span style="color:#81a1c1">=</span><span style="color:#b48ead">0.2</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	model <span style="color:#81a1c1">=</span> RandomForestClassifier<span style="color:#eceff4">(</span>n_estimators<span style="color:#81a1c1">=</span><span style="color:#b48ead">100</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	trainer <span style="color:#81a1c1">=</span> ModelTrainer<span style="color:#eceff4">(</span>model<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	trainer<span style="color:#81a1c1">.</span>train<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	y_pred <span style="color:#81a1c1">=</span> trainer<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	accuracy <span style="color:#81a1c1">=</span> trainer<span style="color:#81a1c1">.</span>evaluate<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">f</span><span style="color:#a3be8c">&#39;Accuracy: </span><span style="color:#a3be8c">{</span>accuracy<span style="color:#a3be8c">:</span><span style="color:#a3be8c">.2f</span><span style="color:#a3be8c">}</span><span style="color:#a3be8c">&#39;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	DataVisualizer<span style="color:#81a1c1">.</span>visualize<span style="color:#eceff4">(</span>data<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In our original code, we didn‚Äôt even have any classes to begin with. So the first step was to break things down into separate classes, each responsible for exactly one piece of functionality:</p>
<ul>
<li><strong>DataLoader</strong> ‚Äì loads the dataset</li>
<li><strong>DataPreprocessor</strong> ‚Äì handles preprocessing</li>
<li><strong>ModelTrainer</strong> ‚Äì takes care of training, prediction, and evaluation</li>
<li><strong>DataVisualizer</strong> ‚Äì deals with visualization</li>
</ul>
<p>Now each class has <strong>one clear role</strong>. Which means if you ever want to tweak how the plots look, you only need to touch DataVisualizer‚Äîand nothing else.</p>
<br>
<h2 id="open-closed-principle">Open-Closed Principle<a hidden class="anchor" aria-hidden="true" href="#open-closed-principle">#</a></h2>
<blockquote>
<p><strong>Software components (classes, modules, functions, etc.) should be open for extension, but closed for modification.</strong></p></blockquote>
<p>At first glance, you might think, <em>‚ÄúWait‚Äîopen in one place and closed in another? Isn‚Äôt that a contradiction?‚Äù</em> But what it really means is that your code should be designed so you <strong>don‚Äôt have to rewrite existing logic</strong> when adding new functionality. Instead, you should be able to <em>extend</em> it.
The key to achieving this is through <strong>abstraction and inheritance</strong>‚Äîdefine an abstract interface, and then build new features by implementing or subclassing it, rather than tinkering with the original code.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/solid-principles-for-ml/oop.jpg#center"
         alt="image source" width="400"/> <figcaption>
            <p><a href="https://www.cs.sjsu.edu/~pearce/modules/lectures/ood/principles/ocp.htm">image source</a></p>
        </figcaption>
</figure>

<p>Let‚Äôs pause for a second to cover a core idea in object-oriented programming (OOP). Imagine a game with different characters‚Äîsay, a mage and a warrior. A mage attacks with a staff, while a warrior swings a sword. The details differ, but the common point is that <strong>they both need to be able to attack</strong>.
So what we do is define an abstract <strong>Character</strong> interface with the basic abilities like move, attack, and defend. Then the Mage and Warrior classes <strong>inherit</strong> from this interface and implement their own versions of those actions. This is what we call <strong>polymorphism</strong>‚Äîand the beauty of it is that you can treat all these classes through the same interface, while still being able to extend them flexibly.
For example, if you need a new dragon character, you don‚Äôt have to tear down the Character interface or start over. You just inherit from it and implement a new ‚Äúfire-breath‚Äù attack. That‚Äôs the essence of the Open-Closed Principle: leverage polymorphism so you can extend your system without rewriting the foundations.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">from</span> <span style="color:#8fbcbb">abc</span> <span style="color:#81a1c1;font-weight:bold">import</span> ABC<span style="color:#eceff4">,</span> abstractmethod
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">BaseModel</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>	<span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>	<span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>	<span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">RandomForestTrainer</span><span style="color:#eceff4">(</span>BaseModel<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> n_estimators<span style="color:#81a1c1">=</span><span style="color:#b48ead">100</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> RandomForestClassifier<span style="color:#eceff4">(</span>n_estimators<span style="color:#81a1c1">=</span>n_estimators<span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span>random_state<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> accuracy_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">GradientBoostingTrainer</span><span style="color:#eceff4">(</span>BaseModel<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> learning_rate<span style="color:#81a1c1">=</span><span style="color:#b48ead">0.1</span><span style="color:#eceff4">,</span> n_estimators<span style="color:#81a1c1">=</span><span style="color:#b48ead">100</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> GradientBoostingClassifier<span style="color:#eceff4">(</span>learning_rate<span style="color:#81a1c1">=</span>learning_rate<span style="color:#eceff4">,</span> n_estimators<span style="color:#81a1c1">=</span>n_estimators<span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span>random_state<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> accuracy_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now, coming back to our example‚Ä¶ First off, <strong>ABC</strong> is a Python library you use to define abstract classes and methods. An abstract class isn‚Äôt meant to be instantiated directly‚Äîinstead, it serves as an interface that tells any subclasses, <em>‚ÄúHere are the methods and properties you need to implement.‚Äù</em> It‚Äôs basically the same idea as the <strong>Character</strong> class from the earlier example.<br>
The <code>@abstractmethod</code> decorator enforces this rule: if a class inherits from the abstract base, it <strong>must</strong> implement that method.
In our case, we created a BaseModel abstract class. Any actual model we want to use will inherit from this class. The contract is that subclasses have to implement train, predict, and evaluate as core functionalities. That way, if at some point you decide to swap out RandomForest for, say, a Gradient Boosted Tree (GBT), you don‚Äôt rewrite or modify BaseModel‚Äîyou just inherit from it and provide the new implementation. That‚Äôs how you achieve <em>extension without modification</em>.</p>
<br>
<h2 id="liskov-substitution-principle">Liskov Substitution Principle<a hidden class="anchor" aria-hidden="true" href="#liskov-substitution-principle">#</a></h2>
<blockquote>
<p><strong>Subclasses should be substitutable for their base classes.</strong></p></blockquote>
<p>I‚Äôll admit, this one didn‚Äôt click for me at first. When I first read it, I thought: <em>‚ÄúWhy would a subclass need to replace its parent? Didn‚Äôt we create subclasses to override and specialize behavior?‚Äù</em> But the principle isn‚Äôt telling you to actually <strong>replace</strong> things‚Äîit‚Äôs saying you should <strong>design your inheritance so that replacement is always possible without breaking anything</strong>.
If you trace it back to its original definition, it goes something like: <em>‚ÄúIf a property holds true for objects of type T, it must also hold true for objects of type S, where S is a subtype of T.‚Äù</em> In other words, everything that works for the base class should also work for its subclass. So the key takeaway is: <strong>if swapping out a base class with one of its subclasses causes errors or weird behavior, then your inheritance hierarchy isn‚Äôt designed correctly.</strong></p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/solid-principles-for-ml/lsp.jpg#center"
         alt="image source" width="420"/> <figcaption>
            <p><a href="https://scientificprogrammer.net/2019/11/04/liskov-substitution-principle-in-c/">image source</a></p>
        </figcaption>
</figure>

<p>If you build a toy duck that looks and quacks like a real duck, there‚Äôs a catch: the real duck waddles on its own when you set it down, but the toy duck won‚Äôt move without batteries. Drop the toy duck into the same situation as the real duck (i.e., code written against the base class), and it misbehaves‚Äîthat‚Äôs a violation of LSP. What do you do? If you can make it move without batteries (i.e., rewrite the subclass to meet the base class‚Äôs guarantees), great. Usually you can‚Äôt, so the fix is to <strong>reclassify</strong>: make the toy duck a subtype of <strong>Toy</strong>, not of <strong>Duck</strong>, so it no longer promises behaviors it can‚Äôt deliver.
Back to our running example‚Äîthis time, let‚Äôs tweak the <strong>data preprocessing</strong> side rather than the model.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">DataPreprocessor</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> df<span style="color:#eceff4">:</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df <span style="color:#81a1c1">=</span> df
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">preprocess</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a3be8c">&#34;&#34;&#34;Ï†ÑÏ≤òÎ¶¨ Ïã§Ìñâ&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">NumericPreprocessor</span><span style="color:#eceff4">(</span>DataPreprocessor<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">preprocess</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>        scaler <span style="color:#81a1c1">=</span> StandardScaler<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>        numeric_columns <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#81a1c1">.</span>select_dtypes<span style="color:#eceff4">(</span>include<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#34;number&#34;</span><span style="color:#eceff4">])</span><span style="color:#81a1c1">.</span>columns
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#eceff4">[</span>numeric_columns<span style="color:#eceff4">]</span> <span style="color:#81a1c1">=</span> scaler<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#eceff4">[</span>numeric_columns<span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">CategoryPreprocessor</span><span style="color:#eceff4">(</span>DataPreprocessor<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">preprocess</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>        encoder <span style="color:#81a1c1">=</span> OneHotEncoder<span style="color:#eceff4">(</span>sparse<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">False</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        categorical_columns <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#81a1c1">.</span>select_dtypes<span style="color:#eceff4">(</span>include<span style="color:#81a1c1">=</span><span style="color:#eceff4">[</span><span style="color:#a3be8c">&#34;object&#34;</span><span style="color:#eceff4">])</span><span style="color:#81a1c1">.</span>columns
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">if</span> categorical_columns<span style="color:#81a1c1">.</span>empty<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>            <span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df
</span></span><span style="display:flex;"><span>        transformed <span style="color:#81a1c1">=</span> encoder<span style="color:#81a1c1">.</span>fit_transform<span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#eceff4">[</span>categorical_columns<span style="color:#eceff4">])</span>
</span></span><span style="display:flex;"><span>        column_names <span style="color:#81a1c1">=</span> encoder<span style="color:#81a1c1">.</span>get_feature_names_out<span style="color:#eceff4">(</span>categorical_columns<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        encoded_df <span style="color:#81a1c1">=</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">(</span>transformed<span style="color:#eceff4">,</span> columns<span style="color:#81a1c1">=</span>column_names<span style="color:#eceff4">,</span> index<span style="color:#81a1c1">=</span><span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#81a1c1">.</span>index<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#81a1c1">.</span>drop<span style="color:#eceff4">(</span>columns<span style="color:#81a1c1">=</span>categorical_columns<span style="color:#eceff4">)</span><span style="color:#81a1c1">.</span>reset_index<span style="color:#eceff4">(</span>drop<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        encoded_df <span style="color:#81a1c1">=</span> encoded_df<span style="color:#81a1c1">.</span>reset_index<span style="color:#eceff4">(</span>drop<span style="color:#81a1c1">=</span><span style="color:#81a1c1;font-weight:bold">True</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> pd<span style="color:#81a1c1">.</span>concat<span style="color:#eceff4">([</span><span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#eceff4">,</span> encoded_df<span style="color:#eceff4">],</span> axis<span style="color:#81a1c1">=</span><span style="color:#b48ead">1</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">TrainTestSplitter</span><span style="color:#eceff4">(</span>DataPreprocessor<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">preprocess</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> <span style="color:#81a1c1">tuple</span><span style="color:#eceff4">[</span>pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">,</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">]:</span>
</span></span><span style="display:flex;"><span>        train_df<span style="color:#eceff4">,</span> test_df <span style="color:#81a1c1">=</span> train_test_split<span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>df<span style="color:#eceff4">,</span> test_size<span style="color:#81a1c1">=</span><span style="color:#b48ead">0.2</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> train_df<span style="color:#eceff4">,</span> test_df 
</span></span></code></pre></td></tr></table>
</div>
</div><p>From the original class with hard-coded column names, I introduced a top-level DataPreprocessor interface with SRP and OCP in mind, then subclassed it to handle preprocessing for <strong>numeric</strong> and <strong>categorical</strong> columns separately. The final step of preprocessing is splitting the data into train and test. Now, if we make the class that performs this split inherit from DataPreprocessor, we‚Äôd be violating LSP. Why? Because instead of returning a <strong>preprocessed pandas DataFrame</strong> like DataPreprocessor promises, it returns a <strong>tuple of split datasets</strong>. It might still ‚Äúrun,‚Äù but the subclass can‚Äôt substitute the base class‚Äîso the inheritance design is off.</p>
<br>
<h2 id="interface-segregation-principle">Interface Segregation Principle<a hidden class="anchor" aria-hidden="true" href="#interface-segregation-principle">#</a></h2>
<blockquote>
<p><strong>Clients should not be forced to depend on interfaces they don‚Äôt use.</strong></p></blockquote>
<p>What this means in practice is that interfaces should be kept as small and specific as possible, exposing only the methods that are truly needed. In other words, don‚Äôt cram a bunch of ‚Äújust in case‚Äù methods into a single interface‚Äîdesign it so that each client only deals with the functionality it actually uses.</p>
<figure class="align-center ">
    <img loading="lazy" src="/posts/solid-principles-for-ml/isp.png#center"
         alt="A base class interface defines two features, but from the subclass‚Äôs perspective, one of them isn‚Äôt actually needed. (image source)" width="450"/> <figcaption>
            <p>A base class interface defines two features, but from the subclass‚Äôs perspective, one of them isn‚Äôt actually needed. (<a href="https://www.linkedin.com/pulse/interface-segregation-principle-typescript-dhananjay-kumar/">image source</a>)</p>
        </figcaption>
</figure>

<p>This principle is pretty straightforward, so let‚Äôs skip the theory and jump into an example. Back in the OCP section, we created a BaseModel class that bundled together training, prediction, and evaluation. But if you think about it, not every case really needs all three.
For instance, you might want to load a pre-trained model and only run predictions. Or maybe you‚Äôre using it as a feature extractor‚Äîtrain it, then just grab the learned vectors without doing any predictions. And in an online learning scenario, the evaluation step might not even be relevant.</p>
<p>With that in mind, let‚Äôs break those three capabilities into separate interfaces.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">Trainable</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">Predictable</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">Evaluable</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Once the three interfaces are split out, you can mix and match‚Äîimplementing only the pieces you actually need for each use case.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">RandomForestTrainer</span><span style="color:#eceff4">(</span>Trainable<span style="color:#eceff4">,</span> Predictable<span style="color:#eceff4">,</span> Evaluable<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> n_estimators<span style="color:#81a1c1">=</span><span style="color:#b48ead">100</span><span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span><span style="color:#b48ead">42</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> RandomForestClassifier<span style="color:#eceff4">(</span>n_estimators<span style="color:#81a1c1">=</span>n_estimators<span style="color:#eceff4">,</span> random_state<span style="color:#81a1c1">=</span>random_state<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>		
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">,</span> y_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">evaluate</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> accuracy_score<span style="color:#eceff4">(</span>y_test<span style="color:#eceff4">,</span> y_pred<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">PretrainedModel</span><span style="color:#eceff4">(</span>Predictable<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> model_path<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> joblib<span style="color:#81a1c1">.</span>load<span style="color:#eceff4">(</span>model_path<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">predict</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_test<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>		<span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>predict<span style="color:#eceff4">(</span>X_test<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">FeatureExtractor</span><span style="color:#eceff4">(</span>Trainable<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> n_components<span style="color:#81a1c1">=</span><span style="color:#b48ead">1</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model <span style="color:#81a1c1">=</span> PCA<span style="color:#eceff4">(</span>n_components<span style="color:#81a1c1">=</span>n_components<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">train</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X_train<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>fit<span style="color:#eceff4">(</span>X_train<span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">extract_features</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> X<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>model<span style="color:#81a1c1">.</span>transform<span style="color:#eceff4">(</span>X<span style="color:#eceff4">)</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><br>
<h2 id="dependency-inversion-principle">Dependency Inversion Principle<a hidden class="anchor" aria-hidden="true" href="#dependency-inversion-principle">#</a></h2>
<blockquote>
<p><strong>High-level modules should not depend on low-level modules. Both should depend on abstractions.</strong></p></blockquote>
<figure class="align-center ">
    <img loading="lazy" src="/posts/solid-principles-for-ml/dip.png#center"
         alt="image source" width="400"/> <figcaption>
            <p><a href="https://levelup.gitconnected.com/solid-programming-for-arduino-the-dependency-inversion-principle-4ce3bdb787d1">image source</a></p>
        </figcaption>
</figure>

<p>So what exactly are ‚Äúhigh-level‚Äù and ‚Äúlow-level‚Äù modules? A high-level module (A) is the class that runs the core business logic, while a low-level module (B) handles more detailed, concrete tasks that A calls and uses.
The Dependency Inversion Principle says A shouldn‚Äôt depend directly on B. Instead, there should be an abstract interface (C) sitting in between. The term <em>inversion</em> comes from the idea that the high-level module doesn‚Äôt go looking for a specific low-level implementation‚Äîinstead, the low-level piece gets <strong>injected from the outside</strong> through that abstraction.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">MargheritaPizza</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">prepare</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üçÖüåøüßÄ&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">bake</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üî•&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">serve</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üçï&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">PizzaSell</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza <span style="color:#81a1c1">=</span> MargheritaPizza<span style="color:#eceff4">()</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">order_pizza</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>prepare<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>bake<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>serve<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In this example, each individual pizza is a low-level module, while the pizza sales logic is the high-level module. If the high-level module depends directly on specific pizza classes, then every time you add a new pizza to the menu, you‚Äôre forced to modify that class(It also breaks the Open-Closed Principle).</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">Pizza</span><span style="color:#eceff4">(</span>ABC<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">prepare</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">bake</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#d08770">@abstractmethod</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">serve</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">pass</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">HawaiianPizza</span><span style="color:#eceff4">(</span>Pizza<span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">prepare</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üççüçñüßÄ&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">bake</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üî•&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">serve</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">print</span><span style="color:#eceff4">(</span><span style="color:#a3be8c">&#34;üçï&#34;</span><span style="color:#eceff4">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">PizzaSell</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> pizza<span style="color:#eceff4">:</span> Pizza<span style="color:#eceff4">):</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza <span style="color:#81a1c1">=</span> pizza 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">order_pizza</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>prepare<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>bake<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>pizza<span style="color:#81a1c1">.</span>serve<span style="color:#eceff4">()</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>margherita_sell <span style="color:#81a1c1">=</span> PizzaSell<span style="color:#eceff4">(</span>MargheritaPizza<span style="color:#eceff4">())</span>
</span></span><span style="display:flex;"><span>pepperoni_sell <span style="color:#81a1c1">=</span> PizzaSell<span style="color:#eceff4">(</span>HawaiianPizza<span style="color:#eceff4">())</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>In the code above, the high-level module doesn‚Äôt depend on individual pizza types; it depends on an abstract Pizza interface. That gives you extensibility and easier maintenance‚Äîyou can add a new pizza without touching the high-level logic.</p>
<p>Back to our original example and the <strong>data preprocessing</strong> part: so far we only introduced an abstract DataPreprocessor interface. We‚Äôll keep the existing DataPreprocessor, NumericPreprocessor, and CategoricalPreprocessor as they are, and then add a <strong>high-level module</strong> on top that orchestrates them, like this.</p>
<div class="highlight"><div style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#6c6f74">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#d8dee9;background-color:#2e3440;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#81a1c1;font-weight:bold">class</span> <span style="color:#8fbcbb">PreprocessingPipeline</span><span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">__init__</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">,</span> preprocessors<span style="color:#eceff4">:</span> <span style="color:#81a1c1">list</span><span style="color:#eceff4">[</span>DataPreprocessor<span style="color:#eceff4">]):</span>
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>preprocessors <span style="color:#81a1c1">=</span> preprocessors
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#81a1c1;font-weight:bold">def</span> <span style="color:#88c0d0">run</span><span style="color:#eceff4">(</span><span style="color:#81a1c1">self</span><span style="color:#eceff4">)</span> <span style="color:#81a1c1">-&gt;</span> pd<span style="color:#81a1c1">.</span>DataFrame<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>        processed_df <span style="color:#81a1c1">=</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>preprocessors<span style="color:#eceff4">[</span><span style="color:#b48ead">0</span><span style="color:#eceff4">]</span><span style="color:#81a1c1">.</span>df  
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">for</span> preprocessor <span style="color:#81a1c1;font-weight:bold">in</span> <span style="color:#81a1c1">self</span><span style="color:#81a1c1">.</span>preprocessors<span style="color:#eceff4">:</span>
</span></span><span style="display:flex;"><span>            processed_df <span style="color:#81a1c1">=</span> preprocessor<span style="color:#81a1c1">.</span>preprocess<span style="color:#eceff4">()</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#81a1c1;font-weight:bold">return</span> processed_df
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>pipeline <span style="color:#81a1c1">=</span> PreprocessingPipeline<span style="color:#eceff4">([</span>NumericPreprocessor<span style="color:#eceff4">(</span>df<span style="color:#eceff4">),</span> CategoryPreprocessor<span style="color:#eceff4">(</span>df<span style="color:#eceff4">)])</span>
</span></span><span style="display:flex;"><span>processed_df <span style="color:#81a1c1">=</span> pipeline<span style="color:#81a1c1">.</span>run<span style="color:#eceff4">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The <code>pipeline</code> acts as a high-level module that takes in a series of low-level modules, all of type DataPreprocessor. This way, even if you later introduce a new preprocessing class‚Äîbeyond the numeric scaler or categorical encoder you already have‚Äîit can plug right in without touching the existing code. In other words, the system stays flexible and extensible.</p>
<br>
<h2 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h2>
<ul>
<li><a href="https://inpa.tistory.com/entry/OOP-%F0%9F%92%A0-%EA%B0%9D%EC%B2%B4-%EC%A7%80%ED%96%A5-%EC%84%A4%EA%B3%84%EC%9D%98-5%EA%B0%80%EC%A7%80-%EC%9B%90%EC%B9%99-SOLID">Í∞ùÏ≤¥ ÏßÄÌñ• ÏÑ§Í≥ÑÏùò 5Í∞ÄÏßÄ ÏõêÏπô - S.O.L.I.D</a></li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://sliceofdata.app/en/tags/ai-ml/">AI-ML</a></li>
    </ul>

<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SOLID Principles Explained with ML Code on x"
            href="https://x.com/intent/tweet/?text=SOLID%20Principles%20Explained%20with%20ML%20Code&amp;url=https%3a%2f%2fsliceofdata.app%2fen%2fposts%2fsolid-principles-for-ml%2f&amp;hashtags=AI-ML">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share SOLID Principles Explained with ML Code on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsliceofdata.app%2fen%2fposts%2fsolid-principles-for-ml%2f&amp;title=SOLID%20Principles%20Explained%20with%20ML%20Code&amp;summary=SOLID%20Principles%20Explained%20with%20ML%20Code&amp;source=https%3a%2f%2fsliceofdata.app%2fen%2fposts%2fsolid-principles-for-ml%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
<div class="container_disqus">
    <script src="https://giscus.app/client.js"
        data-repo="pizzathiefz/sliceofdata"
        data-repo-id="R_kgDOPsr6oQ"
        data-category="Announcements"
        data-category-id="DIC_kwDOPsr6oc4CvOfW"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme=""
        data-lang="en"
        crossorigin="anonymous"
        async>
    </script>
</div>
<script>
    
    function getCurrentTheme() {
        
        let storedTheme = localStorage.getItem('pref-theme');
        if (storedTheme) {
            return storedTheme;
        }
        
        
        if (document.body.classList.contains('dark')) {
            return 'dark';
        }
        
        
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            return 'dark';
        }
        
        return 'light';
    }
    
    
    function setGiscusTheme() {
        let currentTheme = getCurrentTheme();
        let giscusTheme = currentTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
        
        
        let giscusScript = document.querySelector("div.container_disqus > script");
        if (giscusScript) {
            giscusScript.setAttribute('data-theme', giscusTheme);
        }
        
        return giscusTheme;
    }
    
    
    setGiscusTheme();
    
    
    document.addEventListener('DOMContentLoaded', function() {
        let themeToggle = document.querySelector('#theme-toggle');
        if (themeToggle) {
            themeToggle.addEventListener('click', () => {
                setTimeout(() => {
                    let newTheme = getCurrentTheme();
                    let newGiscusTheme = newTheme === 'dark' ? 'noborder_dark' : 'noborder_light';
                    
                    let giscusFrame = document.querySelector('iframe.giscus-frame');
                    if (giscusFrame) {
                        giscusFrame.contentWindow.postMessage({
                            giscus: {
                                setConfig: {
                                    theme: newGiscusTheme
                                }
                            }
                        }, 'https://giscus.app');
                    }
                }, 100);
            });
        }
    });
</script>

</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2026 <a href="https://sliceofdata.app/en/">sliceofdata</a></span> ¬∑ 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
